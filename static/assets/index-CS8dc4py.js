import{r as x,j as e,R as cs}from"./react-rwnEJDga.js";import{c as ii}from"./react-dom-Dbbm2O2S.js";import{c as li,O as Ks,a as ce,u as _e,L as qe,b as T,d as oi,e as $,q as Ha,r as Oe,f as O,g as Fr,h as aa,i as Rr,j as ci,k as di,l as ui,m as qs,n as mi,Q as xi,N as hi,o as ji,p as pi,R as fi}from"./@tanstack-jGGrKhPc.js";import{S as Ga,c as Mr,d as Tr,e as gi,f as yi,g as bi,h as $r,V as vi,i as Ni,j as zr,k as wi,l as Or,m as Ci,n as Si,o as _r,I as Lr,F as Vr,L as Kr,p as Hr,q as Gr,r as Pi,O as Br,C as Ur,a as Qr,s as Ai,b as Yr,D as Wr,R as Ei,T as qi,P as ki,t as oa,u as Ba,v as Jr,w as Zr,x as Di,y as gs,z as Xr,A as Ii,B as Ua,E as en,G as Fi,H as sn,J as Je,K as Ri,M as an,N as Mi,Q as rn,U as nn,W as Ti,X as $i,Y as tn,Z as zi,_ as Oi,$ as _i,a0 as Be,a1 as ln,a2 as Li,a3 as on,a4 as Vi,a5 as Ki,a6 as Hi,a7 as Qa,a8 as Ya,a9 as Da,aa as cn,ab as Gi,ac as Bi,ad as Ui,ae as Qi,af as Yi,ag as dn,ah as un,ai as Wi,aj as mn,ak as Ji,al as Zi,am as Xi,an as el,ao as xn,ap as hn,aq as Os}from"./@radix-ui-DS4jIJFW.js";import{c as ca}from"./class-variance-authority-Bb4qSo10.js";import{c as sl}from"./clsx-B-dksMZM.js";import{t as al}from"./tailwind-merge-BOZU2X2x.js";import{h as rl}from"./hono-BIDhS5tk.js";import{z as h,o as ks,s as Ae,e as nl,a as jn,n as ra}from"./zod-Chtm6rUr.js";import{J as P,T as tl}from"./sonner-Ge4zVXbs.js";import{t as W}from"./@hookform-CjSgjK1w.js";import{F as Wa,C as il,u as da,b as J}from"./react-hook-form-Ce32mUIr.js";import{M as ll,S as ol,C as cl,a as dl,G as ul,b as ml,I as xl,c as hl,T as yr,d as pn,E as bs,e as vs,L as jl,f as pl,g as fl,h as fn,i as xs,j as ua,P as ma,k as Ja,Q as gl,l as yl,m as bl,n as vl,F as Nl,o as Js,p as Zs,q as wl,r as br,s as Za,A as gn,t as Cl,u as Sl,v as Xa,w as Pl,W as Al,x as El,y as ql,z as kl,B as Dl,D as Il,H as Hs,J as Fl,U as Rl,K as Ml,N as Tl,R as $l,O as qa,V as zl,X as Ol,Y as _l,Z as Ll,_ as Vl,$ as Kl,a0 as Ia}from"./lucide-react-vi3AQeh9.js";import{D as Xe}from"./vaul-CAGOgFgm.js";import{M as Hl}from"./react-markdown-Cap6nssc.js";import{r as Gl}from"./remark-gfm-BWWMSFNx.js";import{A as Ue,m as ue}from"./framer-motion-PjX6mArn.js";import{u as Bl}from"./react-dropzone-em93Jh8j.js";import{l as Ul}from"./socket.io-client-DFi9RC7o.js";import{L as ke}from"./cmdk-CmMXgEkc.js";import{E as es}from"./jspdf-DBnRl0nv.js";import{a as re}from"./jspdf-autotable-DlezuRLd.js";import{C as Y,F as _s,G as ze,s as xa,o as Fa,H as Ql,I as fs,J as na,K as ta,L as yn,M as bn,N as vn,O as Nn,f as wn,n as Cn,a as Sn}from"./date-fns-Ex_qEdHr.js";import{u as Yl}from"./embla-carousel-react-5Giqj1UC.js";import{R as Pn,T as Wl,B as An,C as En,Y as qn,X as kn,a as Dn,L as Ra}from"./recharts-DJmTjrmg.js";import{D as In}from"./react-day-picker-CR85fGIO.js";import{m as Jl}from"./react-autosave-B27Y6kVk.js";import{j as Zl,x as Xl,F as eo}from"./input-otp-JMlFxlXd.js";import{d as Fn,C as Rn}from"./react-big-calendar-Bz96ngMf.js";/* empty css                    */import"./attr-accept-BWI1aNlo.js";import"./tiny-invariant-CopsF_GD.js";import"./tiny-warning-Dirz_SfZ.js";import"./use-sync-external-store-DfD1veAr.js";import"./react-remove-scroll-Bqck3yjW.js";import"./tslib-DAXutpDz.js";import"./react-remove-scroll-bar-DQ8XJXyV.js";import"./react-style-singleton-n2vQJk_c.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-DzybkEV4.js";import"./use-callback-ref-BIptjQbT.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@floating-ui-CimDeLXL.js";import"./devlop-Cl3hj7Sz.js";import"./unified-Bkj7ugP5.js";import"./bail-FqpXQuLt.js";import"./extend-4XqtyIco.js";import"./is-plain-obj-C1gvLhAf.js";import"./trough-B_b8ryxu.js";import"./vfile-tbz-BywF.js";import"./vfile-message-Bq256rVA.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./remark-parse-PFb__MD6.js";import"./mdast-util-from-markdown-BvD3T9Wt.js";import"./micromark-util-decode-numeric-character-reference-CNs1qBpV.js";import"./micromark-util-decode-string-strjl-tx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-Cp9IgYwT.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-Bzki161k.js";import"./micromark-util-character-Cn8n62xE.js";import"./micromark-core-commonmark-D5SA4aCp.js";import"./micromark-util-classify-character-72LGz2mN.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./micromark-util-subtokenize-BcSgYDy4.js";import"./micromark-factory-destination-Dhx6mInV.js";import"./micromark-factory-label-Dm2aTycn.js";import"./micromark-factory-title-B-Q3zsGF.js";import"./micromark-factory-whitespace-DxqLJ6OX.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./mdast-util-to-string-C_aolqmU.js";import"./remark-rehype-DNC-thMq.js";import"./mdast-util-to-hast-DWFPJkWc.js";import"./@ungap-DDJC10qW.js";import"./micromark-util-sanitize-uri-B1mpwOqX.js";import"./unist-util-position-60F3QETU.js";import"./trim-lines-D8znQY54.js";import"./unist-util-visit-BEqpjG-T.js";import"./unist-util-visit-parents-BzuIhZFT.js";import"./unist-util-is-D9KQvrmg.js";import"./hast-util-to-jsx-runtime-DtDZpwF3.js";import"./comma-separated-tokens-xMQ5YY98.js";import"./property-information-C2mYTYrW.js";import"./space-separated-tokens-DD3iYX1K.js";import"./style-to-object-CpdHXQmu.js";import"./inline-style-parser-D--Rb2MU.js";import"./hast-util-whitespace-D4Wp6AEg.js";import"./estree-util-is-identifier-name-BgBfM8ME.js";import"./html-url-attributes-D46m5wfe.js";import"./micromark-extension-gfm-DKDoHsnq.js";import"./micromark-extension-gfm-autolink-literal-DLPcB62U.js";import"./micromark-extension-gfm-footnote-CfuxHbgG.js";import"./micromark-extension-gfm-strikethrough-DRvqaQ9w.js";import"./micromark-extension-gfm-table-DL38QGqH.js";import"./micromark-extension-gfm-task-list-item-CQ-9H0He.js";import"./mdast-util-gfm-Dvfr80Bz.js";import"./mdast-util-gfm-autolink-literal-BmijSaoZ.js";import"./ccount-c2V3InAJ.js";import"./mdast-util-find-and-replace-Cmrefh_I.js";import"./mdast-util-gfm-footnote-DDcgsGKB.js";import"./mdast-util-gfm-strikethrough-Cj9qKt6Q.js";import"./mdast-util-gfm-table-D2quw1JG.js";import"./markdown-table-De3aUdCo.js";import"./mdast-util-to-markdown-axH5eqwW.js";import"./longest-streak-CtXnX3Xp.js";import"./mdast-util-phrasing-C4Vf_nAi.js";import"./mdast-util-gfm-task-list-item-CbpHDP9z.js";import"./prop-types-psm7UO16.js";import"./file-selector-BpkdEYdu.js";import"./engine.io-client-DBBxzneW.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./@babel-MHgsYJok.js";import"./command-score-B9goVl0v.js";import"./fflate-EnPhvkmS.js";import"./embla-carousel-reactive-utils-DkegjUUZ.js";import"./embla-carousel-CFQXY_2V.js";import"./lodash-BlMyNRDO.js";import"./react-is-8JwjhRSi.js";import"./react-smooth-JCRvq8PH.js";import"./fast-equals-C7I1S-bJ.js";import"./d3-shape-DjFPhhqo.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-6_AdwBXU.js";import"./d3-scale-BYIooUZQ.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-BKO53YJi.js";import"./d3-time-QpEiTrED.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-DiOBu8nk.js";import"./decimal.js-light-B5-9uEc-.js";import"./eventemitter3-uBs0I_fj.js";import"./invariant-E159xfwu.js";import"./uncontrollable-b5NhKKBE.js";import"./react-lifecycles-compat-AfN2QaV3.js";import"./date-arithmetic-DrY26MJF.js";import"./dom-helpers-DHmbUhey.js";import"./react-overlays-Dnc5hYX-.js";import"./@restart-B87X8XEB.js";import"./@popperjs-DMGSESOy.js";import"./warning-DuV_-2-c.js";import"./memoize-one-BdPwpGay.js";import"./dayjs-B0slcDhr.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const so={theme:"system",setTheme:()=>null},Mn=x.createContext(so);function ao({children:s,defaultTheme:a="system",storageKey:r="vite-ui-theme",...t}){const[n,i]=x.useState(()=>localStorage.getItem(r)||a);x.useEffect(()=>{const o=window.document.documentElement;if(o.classList.remove("light","dark"),n==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";o.classList.add(c);return}o.classList.add(n)},[n]);const l={theme:n,setTheme:o=>{localStorage.setItem(r,o),i(o)}};return e.jsx(Mn.Provider,{...t,value:l,children:s})}const er=()=>{const s=x.useContext(Mn);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},Le=li()({component:ro});function ro(){return e.jsx(e.Fragment,{children:e.jsx(Ks,{})})}function F(...s){return al(sl(s))}const Ps=ca("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-accent text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=x.forwardRef(({className:s,variant:a,size:r,asChild:t=!1,...n},i)=>{const l=t?Ga:"button";return e.jsx(l,{className:F(Ps({variant:a,size:r,className:s})),ref:i,...n})});E.displayName="Button";const no=rl("/"),D=no.api,Ns="https://custom.famed.us.kg",to=h.object({password:h.string({required_error:"Este campo es requerido"}).min(6,{message:"La clave debe contener al menos 6 caracteres"}).max(12,{message:"La clave debe tener 12 caracteres como máximo"}),email:h.string({required_error:"Este campo es requerido"}).email({message:"Ingrese un email válido"})}),io=h.object({email:h.string().email({message:"Ingrese un email válido"}),token:h.string().length(64,{message:"Token de verificación incorrecto"})}),lo=h.object({email:h.string({required_error:"Este campo es requerido"}).email({message:"Ingrese un email válido"})}),oo=h.object({email:h.string().email({message:"Ingrese un email válido"}),token:h.string().length(64,{message:"Token de verificación incorrecto"}),newPassword:h.string({required_error:"Este campo es requerido"}).min(6,{message:"La clave debe contener al menos 6 caracteres"}).max(12,{message:"La clave debe tener 12 caracteres como máximo"}),confirmPass:h.string({required_error:"Este campo es requerido"}).min(6,{message:"La clave debe contener al menos 6 caracteres"}).max(12,{message:"La clave debe tener 12 caracteres como máximo"})}).refine(s=>s.newPassword===s.confirmPass,{message:"Las claves no coinciden",path:["confirmPass"]}),ia=({className:s})=>e.jsxs("svg",{"aria-hidden":"true",role:"status",className:F("inline",s),viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}),vr=ca("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),_=x.forwardRef(({className:s,variant:a,size:r,asChild:t=!1,loading:n,children:i,...l},o)=>t?e.jsx(Ga,{ref:o,...l,children:e.jsx(e.Fragment,{children:x.Children.map(i,c=>x.cloneElement(c,{className:F(vr({variant:a,size:r}),s),children:e.jsxs(e.Fragment,{children:[n&&e.jsx(ia,{className:F("h-4 w-4 animate-spin",i&&"mr-2")}),c.props.children]})}))})}):e.jsx("button",{className:F(vr({variant:a,size:r,className:s})),disabled:n,ref:o,...l,children:e.jsxs(e.Fragment,{children:[n&&e.jsx(ia,{className:F("h-4 w-4 animate-spin",i&&"mr-2")}),i]})}));_.displayName="LoadingButton";const Tn=ce("/verify")({async validateSearch({email:s,token:a}){return s&&a},component:co});function co(){const s=_e(),{email:a,token:r}=Tn.useSearch(),[t,n]=x.useState(!1),[i,l]=x.useState(""),o=async()=>{(!a||!r)&&s({to:"/login"}),n(!0);const c=io.safeParse({email:a,token:r});if(!c.success){P.error("Ocurrió un error");return}const u=await(await D.auth.verifyEmail.$post({json:c.data})).json();u.success||P.error(u.error),P.success("Tu correo ha sido verificado"),l(""),n(!1),s({to:"/login"})};return e.jsx("section",{className:"flex flex-col items-center justify-center h-screen",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 rounded-lg shadow-md",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Verifica tu Email"}),e.jsx("img",{width:300,height:300,src:"/sub.svg",alt:"logo"}),e.jsx(_,{loading:t,disabled:t,type:"submit",onClick:o,className:"my-3  w-full inline-flex items-center",children:"Verificar mi Email"}),i&&e.jsx("p",{className:"text-red-500",children:i}),e.jsx(E,{disabled:t,variant:"outline",className:"w-full",children:e.jsx(qe,{to:"/login",children:"Regresar al Login"})})]})})}const uo=ce("/restricted")({component:mo});function mo(){return e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("img",{alt:"Unauthorized",className:"mt-20",src:"/acces.svg",width:"200"}),e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tighter sm:text-4xl",children:"No autorizado ..."}),e.jsx("p",{className:"text-center max-w-[600px] text-sm/relaxed dark:text-gray-400",children:"Parece que no tienes permiso para acceder a esta página."}),e.jsx(E,{children:e.jsx(qe,{to:"/login",children:"Login"})})]})]})}const I=x.forwardRef(({className:s,type:a,...r},t)=>e.jsx("input",{type:a,className:F("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r}));I.displayName="Input";const xo=ca("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),de=x.forwardRef(({className:s,...a},r)=>e.jsx(Mr,{ref:r,className:F(xo(),s),...a}));de.displayName=Mr.displayName;const ee=Wa,$n=x.createContext({}),w=({...s})=>e.jsx($n.Provider,{value:{name:s.name},children:e.jsx(il,{...s})}),ha=()=>{const s=x.useContext($n),a=x.useContext(zn),{getFieldState:r,formState:t}=da(),n=r(s.name,t);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:i}=a;return{id:i,name:s.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},zn=x.createContext({}),b=x.forwardRef(({className:s,...a},r)=>{const t=x.useId();return e.jsx(zn.Provider,{value:{id:t},children:e.jsx("div",{ref:r,className:F("space-y-2",s),...a})})});b.displayName="FormItem";const y=x.forwardRef(({className:s,...a},r)=>{const{error:t,formItemId:n}=ha();return e.jsx(de,{ref:r,className:F(t&&"text-destructive",s),htmlFor:n,...a})});y.displayName="FormLabel";const v=x.forwardRef(({...s},a)=>{const{error:r,formItemId:t,formDescriptionId:n,formMessageId:i}=ha();return e.jsx(Ga,{ref:a,id:t,"aria-describedby":r?`${n} ${i}`:`${n}`,"aria-invalid":!!r,...s})});v.displayName="FormControl";const sr=x.forwardRef(({className:s,...a},r)=>{const{formDescriptionId:t}=ha();return e.jsx("p",{ref:r,id:t,className:F("text-[0.8rem] text-muted-foreground",s),...a})});sr.displayName="FormDescription";const C=x.forwardRef(({className:s,children:a,...r},t)=>{const{error:n,formMessageId:i}=ha(),l=n?String(n==null?void 0:n.message):a;return l?e.jsx("p",{ref:t,id:i,className:F("text-[0.8rem] font-medium text-destructive",s),...r,children:l}):null});C.displayName="FormMessage";const B=gi,K=yi,H=bi,V=x.forwardRef(({className:s,sideOffset:a=4,...r},t)=>e.jsx(Tr,{ref:t,sideOffset:a,className:F("z-50 overflow-hidden rounded-md dark:bg-green-700 bg-green-400 font-semibold px-3 py-2 text-sm text-foreground animate-in fade-in-0 zoom-in-10 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));V.displayName=Tr.displayName;function ja(){const{theme:s,setTheme:a}=er(),r=()=>{a(s==="light"?"dark":"light")};return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{children:e.jsx(E,{variant:"ghost",size:"icon",onClick:r,children:s==="light"?e.jsx(ll,{className:"w-5 h-5"}):e.jsx(ol,{className:"w-5 h-5"})})}),e.jsx(V,{children:s==="light"?"Modo oscuro":"Modo claro"})]})})}const Ve=({shouldScaleBackground:s=!0,...a})=>e.jsx(Xe.Root,{shouldScaleBackground:s,...a});Ve.displayName="Drawer";const is=Xe.Trigger,ho=Xe.Portal,On=x.forwardRef(({className:s,...a},r)=>e.jsx(Xe.Overlay,{ref:r,className:F("fixed inset-0 z-50 bg-black/80",s),...a}));On.displayName=Xe.Overlay.displayName;const Ke=x.forwardRef(({className:s,children:a,...r},t)=>e.jsxs(ho,{children:[e.jsx(On,{}),e.jsxs(Xe.Content,{ref:t,className:F("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s),...r,children:[e.jsx("div",{className:"mx-auto my-2 h-2 w-[100px] rounded-full bg-customborder"}),a]})]}));Ke.displayName="DrawerContent";const jo=x.forwardRef(({className:s,...a},r)=>e.jsx(Xe.Title,{ref:r,className:F("text-lg font-semibold leading-none tracking-tight",s),...a}));jo.displayName=Xe.Title.displayName;const po=x.forwardRef(({className:s,...a},r)=>e.jsx(Xe.Description,{ref:r,className:F("text-sm text-muted-foreground",s),...a}));po.displayName=Xe.Description.displayName;const As=x.forwardRef(({className:s,children:a,...r},t)=>e.jsxs($r,{ref:t,className:F("relative overflow-hidden",s),...r,children:[e.jsx(vi,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(_n,{}),e.jsx(Ni,{})]}));As.displayName=$r.displayName;const _n=x.forwardRef(({className:s,orientation:a="vertical",...r},t)=>e.jsx(zr,{ref:t,orientation:a,className:F("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...r,children:e.jsx(wi,{className:"relative flex-1 rounded-full bg-border"})}));_n.displayName=zr.displayName;function se({className:s,...a}){return e.jsx("div",{className:F("animate-pulse rounded-md bg-primary/10",s),...a})}function je(){return e.jsx("div",{className:"flex flex-col sm:m-2 m-1",children:e.jsxs("div",{className:"space-y-1 justify-center",children:[e.jsx(se,{className:"h-2 w-full mx-auto"}),e.jsx(se,{className:"h-2 w-11/12 mx-auto"}),e.jsx(se,{className:"h-2 w-full mx-auto"}),e.jsx(se,{className:"h-2 w-11/12 mx-auto"})]})})}const fo=Ci,go=Si,Ln=x.forwardRef(({className:s,align:a="center",sideOffset:r=4,...t},n)=>e.jsx(Or,{ref:n,align:a,sideOffset:r,className:F("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));Ln.displayName=Or.displayName;const Es=x.forwardRef(({className:s,...a},r)=>e.jsx(_r,{ref:r,className:F("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));Es.displayName=_r.displayName;const pa=x.forwardRef(({className:s,...a},r)=>e.jsx(Lr,{ref:r,className:F("aspect-square h-full w-full",s),...a}));pa.displayName=Lr.displayName;const Gs=x.forwardRef(({className:s,...a},r)=>e.jsx(Vr,{ref:r,className:F("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Gs.displayName=Vr.displayName;const Vn={"/doctor/queries":"queries","/doctor/dates":"dates","/doctor/drugs":"drugs","/doctor/services":"services","/doctor/pediatric":"pediatric","/doctor/view":"view","/doctor/general":"general","/doctor/upcoming":"upcoming","/doctor/patients":"patients","/assistant/patients":"patients","/admin/users":"users","/admin/settings":"settings","/profile/me":"profile","/forgot":"forgot","/login":"login","/reset":"reset"};function yo(s){return s in Vn}function bo({children:s}){return e.jsxs("div",{className:"h-full w-full dark:bg-black bg-white dark:bg-grid-small-white/[0.2] bg-grid-small-black/[0.2] relative",children:[e.jsx("div",{className:"absolute pointer-events-none inset-0 flex items-center justify-center dark:bg-black bg-white [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black)]"}),s]})}const vo={blockquote:({children:s})=>{const r=cs.Children.toArray(s).map(o=>typeof o=="string"?o:o.props.children).join(" "),t=o=>r.replace(o,"").trim(),n="w-5 h-5 shrink-0",i=(o,c,d,u,m)=>r.includes(c)?e.jsxs("div",{className:`border-l-4 ${d} ${u} p-4 my-4 rounded-md flex items-center space-x-2`,children:[cs.cloneElement(o,{className:`${m} ${n}`}),e.jsx("span",{children:t(c)})]}):null,l=[{key:"[!NOTE]",icon:e.jsx(xl,{}),borderColor:"border-blue-500",bgColor:"bg-blue-100 dark:bg-blue-900/20",textColor:"text-blue-500"},{key:"[!TIP]",icon:e.jsx(hl,{}),borderColor:"border-green-500",bgColor:"bg-green-100 dark:bg-green-900/20",textColor:"text-green-500"},{key:"[!IMPORTANT]",icon:e.jsx(yr,{}),borderColor:"border-yellow-500",bgColor:"bg-yellow-100 dark:bg-yellow-900/20",textColor:"text-yellow-500"},{key:"[!WARNING]",icon:e.jsx(pn,{}),borderColor:"border-red-500",bgColor:"bg-red-100 dark:bg-red-900/20",textColor:"text-red-500"},{key:"[!CAUTION]",icon:e.jsx(yr,{}),borderColor:"border-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/20",textColor:"text-orange-500"}];for(const o of l){const c=i(o.icon,o.key,o.borderColor,o.bgColor,o.textColor);if(c)return c}return e.jsx("blockquote",{className:"border-l-4 border-gray-500 bg-gray-100 dark:bg-gray-900/20 p-4 rounded-md",children:s})},hr:()=>e.jsx("hr",{className:"border-customborder my-4 sm:my-6"}),p:({children:s})=>e.jsx("p",{className:"my-4",children:s}),a:({href:s,children:a})=>e.jsx("a",{href:s,className:"text-blue-500 hover:underline",target:"_blank",rel:"noopener noreferrer",children:a}),h1:({children:s})=>e.jsx("h1",{className:"text-2xl font-bold my-4",children:s}),h2:({children:s})=>e.jsx("h2",{className:"text-xl font-bold my-3",children:s}),h3:({children:s})=>e.jsx("h2",{className:"text-lg font-semibold my-3",children:s}),code:({children:s})=>e.jsx("span",{className:"font-bold bg-yellow-300 dark:bg-gray-800 p-1 rounded",children:s}),strong:({children:s})=>e.jsx("strong",{className:"font-semibold",children:s}),ul:({children:s})=>{const a=cs.Children.toArray(s).filter(r=>cs.isValidElement(r)||typeof r=="string");return e.jsx("ul",{className:"list-disc list-inside space-y-1",children:a.map((r,t)=>e.jsx("li",{className:"flex items-center space-x-1",children:typeof r=="string"?r:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ml,{className:"text-blue-500 w-5 h-5 "}),e.jsx("span",{children:r.props.children})]})},t))})}};function Kn({param:s}){return e.jsx(Hn,{param:s})}function Hn({param:s}){const{data:a,isPending:r,error:t}=T({queryKey:["info",s],queryFn:async()=>await(await D.helps[":name"].$get({param:{name:s}})).text()});return e.jsxs(Ve,{children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsx(E,{variant:"ghost",size:"icon","aria-label":"Open help",children:e.jsx(cl,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Guía de Usuario"})]})}),e.jsx(Ke,{className:"h-11/12",children:e.jsx(bo,{children:e.jsx("div",{className:"h-auto my-4 sm:my-8 mx-auto w-full max-w-3xl",children:e.jsxs(As,{className:"h-[85vh] px-4 sm:px-8",children:[e.jsxs("div",{className:"space-y-6 pb-6",children:[r&&e.jsx(je,{}),t&&e.jsx("div",{children:"Ocurrió un error"}),a&&e.jsx(Hl,{remarkPlugins:[Gl],className:"prose dark:prose-invert max-w-none",components:vo,children:a})]}),e.jsx("footer",{className:"mt-20",children:e.jsx(No,{})})]})})})})]})}function fa(){const a=oi().state.location.pathname,r=yo(a)?Vn[a]:"any";return e.jsx(Hn,{param:r})}function No(){return e.jsxs(fo,{children:[e.jsx(go,{asChild:!0,children:e.jsx(E,{variant:"link",children:"Acerca del autor"})}),e.jsx(Ln,{className:"w-80",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Es,{children:[e.jsx(pa,{src:"https://github.com/gabrielwilliamson.png",alt:"Gabriel Duarte"}),e.jsx(Gs,{children:"GD"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Gabriel Williamson"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Desarrollador Full Stack"}),e.jsxs("div",{className:"flex items-center pt-1",children:[e.jsx(dl,{className:"mr-2 h-4 w-4 opacity-70"}),e.jsx("a",{href:"mailto:gabrielwilliamson92@gmail.com",className:"text-xs text-muted-foreground hover:underline hover:text-foreground",children:"gabrielwilliamson92@gmail.com"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ul,{className:"mr-2 h-4 w-4 opacity-70"}),e.jsx("a",{href:"https://github.com/gabrielwilliamson",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-muted-foreground hover:underline hover:text-foreground",children:"GitHub profile"})]})]})]})})]})}const wo=h.object({email:h.string().email({message:"Ingrese un email válido"}),token:h.string().length(64,{message:"Token de verificación incorrecto"})}),Gn=ce("/reset")({async validateSearch({email:s,token:a}){return s&&a},component:Co});function Co(){const s=Gn.useSearch(),a=wo.safeParse(s);if(!a.success)return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center ",children:e.jsx("p",{className:"text-destructive-foreground font-semibold bg-destructive p-4 rounded-sm ",children:"Datos erroneos, favor busque el enlace correcto en su correo"})});const{email:r,token:t}=a.data,n=_e(),i=J({resolver:W(oo),defaultValues:{email:r,token:t,newPassword:"",confirmPass:""}}),[l,o]=x.useState(!1),[c,d]=x.useState(!1),u=()=>o(!l),m=()=>d(!c),j=$({mutationFn:async f=>{const q=await(await D.auth.reset.$patch({json:f})).json();q.success?(P.success("Tu clave ha sido actualizada correctamente"),n({to:"/login",from:"/reset"})):P.error(q.error)}}),p=f=>{j.mutate(f)};return e.jsxs("div",{className:"relative min-h-screen isolate overflow-hidden border-b border-gray-200 flex items-center justify-center",children:[e.jsxs("svg",{className:"absolute inset-0 -z-10 h-full w-full stroke-gray-200 [mask-image:radial-gradient(100%_100%_at_top_right,white,transparent)]","aria-hidden":"true",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"0787a7c5-978c-4f66-83c7-11c213f99cb7",width:200,height:200,x:"50%",y:-1,patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M.5 200V.5H200",fill:"none"})})}),e.jsx("rect",{width:"100%",height:"100%",strokeWidth:0,fill:"url(#0787a7c5-978c-4f66-83c7-11c213f99cb7)"})]}),e.jsxs("div",{className:"bg-background border rounded-xl   w-full max-w-sm mx-auto p-6",children:[e.jsx("h1",{className:"text-center text-ring tracking-tight text-2xl sm:text-3xl font-bold mb-6",children:"Reestablecer tu Clave"}),e.jsx("div",{children:e.jsx(ee,{...i,children:e.jsxs("form",{className:"space-y-6",onSubmit:i.handleSubmit(p),children:[e.jsx(w,{control:i.control,name:"newPassword",render:({field:f})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nueva Clave"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{onChange:f.onChange,value:f.value,disabled:j.isPending,type:l?"text":"password",placeholder:"******",className:"w-full px-4 py-2 bg-background"}),e.jsx("button",{type:"button",disabled:j.isPending,onClick:u,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:l?e.jsx(bs,{}):e.jsx(vs,{})})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"confirmPass",render:({field:f})=>e.jsxs(b,{children:[e.jsx(y,{children:"Confirmar Clave"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{onChange:f.onChange,value:f.value,disabled:j.isPending,type:c?"text":"password",placeholder:"******",className:"w-full px-4 py-2 bg-background"}),e.jsx("button",{type:"button",disabled:j.isPending,onClick:m,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:c?e.jsx(bs,{}):e.jsx(vs,{})})]})}),e.jsx(C,{})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(_,{loading:j.isPending,type:"submit",disabled:j.isPending,className:"w-full",children:"Actualizar contraseña"})})]})})}),e.jsxs("div",{className:"w-full justify-between flex items-center mt-4 sm:mt-10",children:[e.jsx("p",{className:"text-xs",children:"Clinica de especialidades FAMED Matagalpa"}),e.jsx(ja,{}),e.jsx(fa,{})]})]})]})}const So=ce("/login")({component:Po});function Po(){const s=_e(),[a,r]=x.useState(!1),t=J({resolver:W(to)}),n=()=>{r(!a)},i=$({mutationFn:async o=>{const d=await(await D.auth.$post({json:o})).json();if(!d.success){P.error(d.error);return}d.role==="DOCTOR"&&s({to:"/doctor/upcoming",from:"/login"}),d.role==="ADMIN"&&s({to:"/admin/users",from:"/login"}),d.role==="ASSISTANT"&&s({to:"/assistant/dates",from:"/login"})}}),l=async o=>i.mutate(o);return e.jsxs("div",{className:"relative min-h-screen isolate overflow-hidden border-b border-gray-200 flex items-center justify-center",children:[e.jsxs("svg",{className:"absolute inset-0 -z-10 h-full w-full stroke-gray-200 [mask-image:radial-gradient(100%_100%_at_top_right,white,transparent)]","aria-hidden":"true",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"0787a7c5-978c-4f66-83c7-11c213f99cb7",width:200,height:200,x:"50%",y:-1,patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M.5 200V.5H200",fill:"none"})})}),e.jsx("rect",{width:"100%",height:"100%",strokeWidth:0,fill:"url(#0787a7c5-978c-4f66-83c7-11c213f99cb7)"})]}),e.jsxs("div",{className:"bg-background border rounded-xl   w-full max-w-sm mx-auto p-6",children:[e.jsx("h1",{className:"text-center text-ring tracking-tight text-2xl sm:text-3xl font-bold mb-6",children:"Iniciar Sesión"}),e.jsx("div",{children:e.jsx(ee,{...t,children:e.jsxs("form",{className:"space-y-6",onSubmit:t.handleSubmit(l),children:[e.jsx(w,{control:t.control,name:"email",disabled:i.isPending,render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Email"}),e.jsx(v,{children:e.jsx(I,{...o,className:"w-full bg-background",placeholder:"john@gmail.com",type:"email"})}),e.jsx(C,{})]})}),e.jsx(w,{control:t.control,name:"password",disabled:i.isPending,render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Clave"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{...o,type:a?"text":"password",placeholder:"******",className:"w-full px-4 py-2 bg-background"}),e.jsx("button",{type:"button",onClick:n,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:a?e.jsx(bs,{}):e.jsx(vs,{})})]})}),e.jsx(C,{})]})}),e.jsx(E,{disabled:i.isPending,size:"sm",variant:"link",asChild:!0,className:"font-normal mt-2",children:e.jsx(qe,{to:"/forgot",children:"¿Olvidaste tu clave?"})}),e.jsx(_,{loading:i.isPending,disabled:i.isPending,className:"mt-4 w-full inline-flex items-center justify-center",type:"submit",children:"Iniciar Sesión"})]})})}),e.jsxs("div",{className:"w-full justify-between flex items-center mt-4 sm:mt-10",children:[e.jsx("p",{className:"text-xs",children:"Clínica de especialidades FAMED Matagalpa"}),e.jsx(ja,{}),e.jsx(fa,{})]})]})]})}const Ao=ce("/forgot")({component:Eo});function Eo(){var i;const[s,a]=x.useState(!1),r=J({resolver:W(lo)}),t=l=>{n.mutate(l)},n=$({mutationFn:async l=>{const c=await(await D.auth.sendEmailForgot.$post({json:l})).json();console.log(c),c.success?a(!0):r.setError("email",{type:"manual",message:c.error||"Failed to send email."})}});return e.jsx("section",{className:"flex flex-col items-center justify-center h-screen",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 ",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-4",children:["Recuperar clave ",e.jsx(fa,{})," "]}),e.jsx("img",{width:300,height:300,src:"/sub.svg",alt:"logo"}),s?e.jsx("div",{className:" my-4 text-center font-semibold text-green-600",children:"Correo de recuperación enviado. Por favor, revisa tu bandeja de entrada."}):e.jsxs("div",{className:"my-4 w-full",children:[e.jsx(ee,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(t),children:[e.jsx(w,{control:r.control,name:"email",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(v,{children:e.jsx(I,{...l,id:"email",disabled:n.isPending,type:"text",placeholder:"Ingresa tu correo"})}),e.jsx(C,{})]})}),e.jsx("div",{className:"flex justify-center w-full",children:e.jsx(_,{className:"my-3  w-full",loading:n.isPending,type:"submit",children:"Recuperar"})})]})}),n.isError&&e.jsx("div",{className:"text-red-600 mt-2 text-center font-semibold","aria-live":"polite",children:((i=n.error)==null?void 0:i.message)||"Ocurrió un error al enviar el correo."})]}),e.jsx(_,{disabled:n.isPending,variant:"outline",className:"w-full",children:e.jsx(qe,{to:"/login",children:"Regresar al Login"})})]})})}const qo=ce("/")({component:ko});function ko(){const s=new Date().getFullYear();return e.jsxs("div",{className:"min-h-screen w-full dark:bg-black bg-white dark:bg-grid-small-white/[0.2] bg-grid-small-black/[0.2] relative flex flex-col",children:[e.jsx("div",{className:"absolute pointer-events-none inset-0 flex items-center justify-center dark:bg-black bg-white [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black)]"}),e.jsx("main",{className:"flex-grow flex items-center justify-center px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-8 sm:space-y-0 sm:space-x-12 sm:flex-row",children:[e.jsx("img",{src:"/hero.svg",alt:"Hero",className:"w-40 h-auto sm:w-48 sm:h-48 md:w-56 md:h-56 lg:w-64 lg:h-64"}),e.jsxs("div",{className:"text-center sm:text-left max-w-md",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold relative z-20 bg-clip-text text-transparent bg-gradient-to-b from-neutral-200 to-neutral-500 py-4 sm:py-8",children:"Clínica de Especialidades FAMED"}),e.jsx(E,{asChild:!0,className:"mt-3 sm:mt-2",children:e.jsxs(qe,{to:"/login",className:"flex items-center justify-center",children:[e.jsx(jl,{className:"mr-2 h-4 w-4"})," Iniciar sesión"]})})]})]})}),e.jsx("footer",{className:"relative z-20 w-full py-2 px-4 sm:px-6 lg:px-8 mt-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0",children:[e.jsxs("p",{className:"text-sm text-center sm:text-left ",children:["© ",s," Clínica FAMED. Todos los derechos reservados."]}),e.jsx(ja,{})]})})]})}async function Do(){const s=await D.auth.verify.$get();if(!s.ok)throw console.error("Error al obtener el usuario"),Oe({to:"/login"});return(await s.json()).data}const js=Ha({queryKey:["currentUser"],queryFn:Do,staleTime:1/0}),Io=ce("/profile/_profile")({beforeLoad:async({context:s})=>{try{if(!await s.queryClient.fetchQuery(js))throw Oe({to:"/login"})}catch{throw Oe({to:"/login"})}},component:Fo});function Fo(){return e.jsx(e.Fragment,{children:e.jsx(Ks,{})})}function Ro(){const s=_e(),a=O(),r=$({mutationFn:async()=>P.promise(D.auth.logout.$get().then(n=>n.json()),{loading:"Cerrando sesión...",success:n=>{if(!n.success)throw new Error("Ocurrió un error al cerrar la sesión");return"Sesión cerrada con éxito"},error:"Error al cerrar la sesión"}),onSuccess:()=>{a.clear(),s({to:"/login"})},onError:()=>{P.error("Ocurrió un error inesperado al cerrar la sesión"),a.clear(),s({to:"/login"})}}),t=()=>{P.custom(n=>e.jsxs("div",{className:"p-4 bg-destructive border rounded-sm  ",children:[e.jsx("div",{className:"w-full",children:"¿Estás seguro de que quieres cerrar la sesión?"}),e.jsxs("div",{className:"flex gap-2 justify-end mt-2",children:[e.jsx(E,{variant:"secondary",onClick:()=>P.dismiss(n),children:"No"}),e.jsx(E,{onClick:()=>{P.dismiss(n),r.mutate()},children:"Si"})]})]}),{duration:1/0})};return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{onClick:t,size:"icon",variant:"ghost",children:e.jsx(pl,{className:"h-5 w-5"})})}),e.jsx(V,{children:"Cerrar sesión"})]})})}function ga({role:s}){const{data:a,isPending:r}=T(js),[t,n]=x.useState(!1),[i,l]=x.useState(!1),o=x.useRef(null),c=_e();x.useEffect(()=>{const m=()=>{l(window.innerWidth<768),window.innerWidth>=768&&n(!1)};return m(),window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}},[]),x.useEffect(()=>{const m=j=>{o.current&&!o.current.contains(j.target)&&n(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const d=m=>{n(!1),c({to:m})},u={DOCTOR:[{to:"/doctor/upcoming",label:"Hoy"},{to:"/doctor/dates",label:"Citas"},{to:"/doctor/patients",label:"Pacientes"},{to:"/doctor/drugs",label:"Fármacos"},{to:"/doctor/services",label:"Servicios"}],ADMIN:[{to:"/admin/users",label:"Usuarios"},{to:"/admin/settings",label:"Mantenimiento"}],ASSISTANT:[{to:"/assistant/dates",label:"Citas"},{to:"/assistant/patients",label:"Pacientes"},{to:"/assistant/services",label:"Servicios"}]};return e.jsx("header",{className:"sticky top-0 z-50 mb-5 border-b bg-background/80 backdrop-blur-sm",children:e.jsx("section",{className:"mx-auto max-w-5xl px-4",children:e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsx("p",{className:"text-xl font-semibold",children:"FAMED"})}),i&&e.jsx("div",{onClick:()=>n(!t),className:"cursor-pointer md:hidden",children:e.jsx(E,{variant:"outline",size:"icon",children:t?e.jsx(fl,{}):e.jsx(fn,{})})}),e.jsx(Ue,{children:(!i||t)&&e.jsx(ue.nav,{ref:o,initial:i?{opacity:0,y:-20}:!1,animate:i?{opacity:1,y:0}:{},exit:i?{opacity:0,y:-20}:{},transition:{duration:.2},className:`${i?"absolute left-0 top-16 w-full bg-background/95 pb-4 text-center backdrop-blur-md":"static flex w-auto items-center"}`,children:e.jsxs("ul",{className:"flex flex-col gap-2 md:flex-row md:items-center md:gap-3",children:[u[s].map(m=>e.jsx(Nr,{to:m.to,label:m.label,onClick:()=>d(m.to)},m.to)),e.jsx(Nr,{to:"/profile/me",label:r?"Cargando...":a.name,onClick:()=>d("/profile/me")}),e.jsxs("li",{className:"flex justify-center my-2 md:my-0",children:[e.jsx(Ro,{}),e.jsx(ja,{}),e.jsx(fa,{})]})]})})})]})})})}function Nr({to:s,label:a,onClick:r}){return e.jsx(ue.li,{className:"my-2 md:my-0",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(qe,{to:s,onClick:r,className:"rounded-md p-2 font-semibold transition-all duration-200 ease-in-out [&.active]:bg-accent [&.active]:font-bold [&.active]:shadow-md hover:bg-accent/50",children:a})})}function Mo(){return e.jsxs(e.Fragment,{children:[e.jsx(ga,{role:"DOCTOR"}),e.jsx(Ks,{})]})}const To=ce("/doctor/_doctor")({beforeLoad:async({context:s})=>{try{const a=await s.queryClient.fetchQuery(js);if(!a)throw Oe({to:"/login"});if(a.role!=="DOCTOR")throw Oe({to:"/restricted"});return{data:a}}catch{throw Oe({to:"/restricted"})}},component:Mo});function $o(){return e.jsxs(e.Fragment,{children:[e.jsx(ga,{role:"ASSISTANT"}),e.jsx(Ks,{})]})}const zo=ce("/assistant/_assistant")({beforeLoad:async({context:s})=>{const a=s.queryClient;try{const r=await a.fetchQuery(js);if(!r)throw Oe({to:"/login"});if(r.role!=="ASSISTANT")throw Oe({to:"/restricted"});return{data:r}}catch{throw Oe({to:"/restricted"})}},component:$o}),Oo=ce("/admin/_admin")({beforeLoad:async({context:s})=>{const a=s.queryClient;try{const r=await a.fetchQuery(js);if(!r)throw Oe({to:"/login"});if(r.role!=="ADMIN")throw Oe({to:"/restricted"});return{data:r}}catch{throw Oe({to:"/login"})}},component:_o});function _o(){return e.jsxs(e.Fragment,{children:[e.jsx(ga,{role:"ADMIN"}),e.jsx(Ks,{})]})}const Bn=Pi,ar=x.forwardRef(({className:s,...a},r)=>e.jsx(Kr,{ref:r,className:F("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));ar.displayName=Kr.displayName;const Ye=x.forwardRef(({className:s,...a},r)=>e.jsx(Hr,{ref:r,className:F("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));Ye.displayName=Hr.displayName;const We=x.forwardRef(({className:s,...a},r)=>e.jsx(Gr,{ref:r,className:F("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));We.displayName=Gr.displayName;const Z=Ei,U=qi,Lo=ki,Vo=Qr,Bs=x.forwardRef(({className:s,...a},r)=>e.jsx(Br,{ref:r,className:F("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));Bs.displayName=Br.displayName;const Q=x.forwardRef(({className:s,children:a,...r},t)=>e.jsxs(Lo,{children:[e.jsx(Bs,{}),e.jsxs(Ur,{ref:t,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[a,e.jsxs(Qr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ai,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Q.displayName=Ur.displayName;const ie=({className:s,...a})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});ie.displayName="DialogHeader";const oe=({className:s,...a})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});oe.displayName="DialogFooter";const X=x.forwardRef(({className:s,...a},r)=>e.jsx(Yr,{ref:r,className:F("text-lg font-semibold leading-none tracking-tight",s),...a}));X.displayName=Yr.displayName;const Ce=x.forwardRef(({className:s,...a},r)=>e.jsx(Wr,{ref:r,className:F("text-sm text-muted-foreground",s),...a}));Ce.displayName=Wr.displayName;const ws=h.object({name:h.string({required_error:"Este campo es requerido"}).min(10,{message:"Ingrese un nombre valido"}).max(130,{message:"Nombre incorrecto"}),password:h.string({required_error:"Este campo es requerido"}).min(6,{message:"La clave debe de contener al menos 6 caracteres"}).max(12,{message:"La clave debe de tener 12 caracteres como máximo"}).regex(/[A-Za-z]/,{message:"La clave debe contener al menos una letra"}).regex(/[0-9]/,{message:"La clave debe contener al menos un número"}).regex(/[@$!%*?&+#-]/,{message:"La clave debe contener al menos un carácter especial, como @, $, !, %, *, ?, &, +, o #"}),email:h.string({required_error:"Este campo es requerido"}).email({message:"Ingrese un Email valido"}),rol:h.enum(["ASSISTANT","DOCTOR"],{errorMap:()=>({message:"Seleccione un rol"})})});h.object({id:h.string(),status:h.boolean()});function Ko({userName:s}){const a=O(),[r,t]=x.useState(!1),n=h.object({name:ws.shape.name}),i=J({resolver:W(n),defaultValues:{name:s}}),l=$({mutationFn:async c=>{const u=await(await D.users.name.$patch({json:c})).json();if(!u.success)throw new Error;return P.success("Tu nombre ha sido actualizado correctamente"),a.invalidateQueries({queryKey:["currentUser"]}),t(!1),u},onError:()=>{P.error('"Error al actualizar el nombre"')}}),o=c=>{l.mutate(c)};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(oa,{})})})}),e.jsx(V,{children:"Cambiar tu nombre"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"¿Quieres cambiar tu nombre?"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),children:[e.jsx(w,{control:i.control,name:"name",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre"}),e.jsx(v,{children:e.jsx(I,{...c,disabled:l.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:l.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function Ho({userEmail:s}){const a=O(),[r,t]=x.useState(!1),n=h.object({email:ws.shape.email}),i=J({resolver:W(n),defaultValues:{email:s}}),l=$({mutationFn:async c=>{const u=await(await D.users.email.$patch({json:c})).json();return u.success||P.error("Error al actualizar el email"),P.success("Tu email ha sido actualizado correctamente, verifica tu bandeja de entrada"),a.invalidateQueries({queryKey:["currentUser"]}),t(!1),u}}),o=c=>{l.mutate(c)};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(oa,{})})})}),e.jsx(V,{children:"Cambiar tu email"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"¿Estás seguro de cambiar tu email?"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),children:[e.jsx(w,{control:i.control,name:"email",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Email"}),e.jsx(v,{children:e.jsx(I,{...c,disabled:l.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:l.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function Go(){const s=h.object({old:ws.shape.password,new:ws.shape.password,confirmPass:ws.shape.password}).refine(p=>p.new===p.confirmPass,{message:"Las claves no coinciden",path:["confirmPass"]}).refine(p=>p.old!=p.new,{message:"La clave nueva no puede ser igual a la actual",path:["new"]}),a=J({resolver:W(s),defaultValues:{old:"",new:"",confirmPass:""}}),r=$({mutationFn:async p=>{const N=await(await D.users.pass.$patch({json:p})).json();return N.success?P.success("Tu clave ha sido actualizada correctamente"):(N.error==="old error"&&a.setError("old",{message:"La clave actual es incorrecta"}),P.error("Error al actualizar la clave")),N}}),t=p=>{r.mutate(p)},[n,i]=x.useState(!1),[l,o]=x.useState(!1),[c,d]=x.useState(!1),u=()=>i(!n),m=()=>o(!l),j=()=>d(!c);return e.jsx(ee,{...a,children:e.jsx("form",{className:"flex justify-center",onSubmit:a.handleSubmit(t),children:e.jsxs("div",{className:"space-y-4 sm:w-1/2",children:[e.jsx("div",{children:e.jsx(w,{control:a.control,name:"old",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Clave Actual"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{onChange:p.onChange,value:p.value,disabled:r.isPending,type:n?"text":"password",placeholder:"******",className:"w-full px-4 py-2 bg-background"}),e.jsx("button",{type:"button",disabled:r.isPending,onClick:u,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:n?e.jsx(bs,{}):e.jsx(vs,{})})]})}),e.jsx(C,{})]})})}),e.jsx("div",{children:e.jsx(w,{control:a.control,name:"new",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nueva Clave"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{onChange:p.onChange,value:p.value,disabled:r.isPending,type:l?"text":"password",placeholder:"******",className:"w-full px-4 py-2 bg-background"}),e.jsx("button",{type:"button",disabled:r.isPending,onClick:m,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:l?e.jsx(bs,{}):e.jsx(vs,{})})]})}),e.jsx(C,{})]})})}),e.jsx("div",{children:e.jsx(w,{control:a.control,name:"confirmPass",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Confirmar Clave"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{onChange:p.onChange,value:p.value,disabled:r.isPending,type:c?"text":"password",placeholder:"******",className:"w-full px-4 py-2 bg-background"}),e.jsx("button",{type:"button",disabled:r.isPending,onClick:j,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:c?e.jsx(bs,{}):e.jsx(vs,{})})]})}),e.jsx(C,{})]})})}),e.jsx(_,{type:"submit",loading:r.isPending,className:"w-full",children:"Actualizar"})]})})})}const ls=s=>{const r=(""+s).replace(/\D/g,"").match(/^(\d{1,3})(\d{4})(\d{4})$/);return r?`+ (${r[1]}) ${r[2]}-${r[3]}`:s};function Un(s){try{if(s.length===0)return null;const a=s.split(" ");if(a.length<2)return a[0].charAt(0).toUpperCase();const r=a[0].charAt(0).toUpperCase(),t=a[1].charAt(0).toUpperCase();return r+t}catch(a){return console.error(a),null}}function Bo(s){const a=s.getFullYear(),r=s.getMonth(),t=s.getDate(),n=new Date,i=n.getFullYear(),l=n.getMonth(),o=n.getDate();let c=i-a,d=l-r,u=o-t;if((d<0||d===0&&u<0)&&(c--,d+=12),u<0){const m=new Date(i,l,0).getDate();d--,u+=m}return c>=5?`${c} años`:c>=1?`${c} años ${d} meses ${u} días`:`${d} meses ${u} días`}const Qn=x.createContext(null),rr=()=>{const s=x.useContext(Qn);if(!s)throw new Error("useFileUpload must be used within a FileUploaderProvider");return s},Ds=x.forwardRef(({className:s,dropzoneOptions:a,value:r,onValueChange:t,reSelect:n,orientation:i="vertical",children:l,dir:o,...c},d)=>{const[u,m]=x.useState(!1),[j,p]=x.useState(!1),[f,N]=x.useState(-1),{maxFiles:q=1,maxSize:A=4*1024*1024,multiple:R=!0}=a,k=q===1?!0:n,g=o==="rtl"?"rtl":"ltr",S=x.useCallback(Pe=>{if(!r)return;const rs=r.filter((ys,ns)=>ns!==Pe);t(rs)},[r,t]),M=x.useCallback(Pe=>{var zs;if(Pe.preventDefault(),Pe.stopPropagation(),!r)return;const rs=()=>{const De=f+1;N(De>r.length-1?0:De)},ys=()=>{const De=f-1;N(De<0?r.length-1:De)},ns=i==="horizontal"?g==="ltr"?"ArrowLeft":"ArrowRight":"ArrowUp",Ws=i==="horizontal"?g==="ltr"?"ArrowRight":"ArrowLeft":"ArrowDown";if(Pe.key===Ws)rs();else if(Pe.key===ns)ys();else if(Pe.key==="Enter"||Pe.key==="Space")f===-1&&((zs=$e.inputRef.current)==null||zs.click());else if(Pe.key==="Delete"||Pe.key==="Backspace"){if(f!==-1){if(S(f),r.length-1===0){N(-1);return}ys()}}else Pe.key==="Escape"&&N(-1)},[r,f,S]),ne=x.useCallback((Pe,rs)=>{var Ws,zs;const ys=Pe;if(!ys){P.error("Error con los archivos");return}const ns=r?[...r]:[];if(k&&ns.splice(0,ns.length),ys.forEach(De=>{ns.length<q&&ns.push(De)}),t(ns),rs.length>0)for(let De=0;De<rs.length;De++){if(((Ws=rs[De].errors[0])==null?void 0:Ws.code)==="file-too-large"){P.error(`El actual archivo es demasiado grande. El tamaño maximo es ${A/1024/1024}MB`);break}if(((zs=rs[De].errors[0])==null?void 0:zs.code)==="Too many files"){P.error("Se superaron los archivos permitidos");break}else{P.error(rs[De].errors[0].message);break}}},[k,r]);x.useEffect(()=>{if(r){if(r.length===q){p(!0);return}p(!1)}},[r,q]);const $e=Bl({...a||{maxFiles:q,maxSize:A,multiple:R},onDrop:ne,onDropRejected:()=>m(!0),onDropAccepted:()=>m(!1)});return e.jsx(Qn.Provider,{value:{dropzoneState:$e,isLOF:j,isFileTooBig:u,removeFileFromSet:S,activeIndex:f,setActiveIndex:N,orientation:i,direction:g},children:e.jsx("div",{ref:d,tabIndex:0,onKeyDownCapture:M,className:F("grid w-full focus:outline-none overflow-hidden ",s,{"gap-2":r&&r.length>0}),dir:o,...c,children:l})})});Ds.displayName="FileUploader";const Is=x.forwardRef(({children:s,className:a,...r},t)=>{const{orientation:n}=rr(),i=x.useRef(null);return e.jsx("div",{className:F("w-full px-1"),ref:i,"aria-description":"content file holder",children:e.jsx("div",{...r,ref:t,className:F("flex rounded-xl gap-1",n==="horizontal"?"flex-raw flex-wrap":"flex-col",a),children:s})})});Is.displayName="FileUploaderContent";const Fs=x.forwardRef(({className:s,index:a,children:r,...t},n)=>{const{removeFileFromSet:i,activeIndex:l,direction:o}=rr(),c=a===l;return e.jsxs("div",{ref:n,className:F(Ps({variant:"ghost"}),"h-6 p-1 justify-between cursor-pointer relative",s,c?"bg-muted":""),...t,children:[e.jsxs("button",{type:"button",className:F("absolute",o==="rtl"?"top-1 left-1":"top-1 right-1"),onClick:()=>i(a),children:[e.jsxs("span",{className:"sr-only",children:["Borrar archivo ",a]}),e.jsx(Ba,{className:"w-4 h-4 hover:stroke-destructive duration-200 ease-in-out"})]}),e.jsx("div",{className:"font-medium leading-none tracking-tight flex items-center gap-1.5 h-full w-full",children:r})]})});Fs.displayName="FileUploaderItem";const Rs=x.forwardRef(({className:s,children:a,...r},t)=>{const{dropzoneState:n,isFileTooBig:i,isLOF:l}=rr(),o=l?{}:n.getRootProps();return e.jsxs("div",{ref:t,...r,className:`relative w-full ${l?"opacity-50 cursor-not-allowed ":"cursor-pointer "}`,children:[e.jsx("div",{className:F(`w-full rounded-lg duration-300 ease-in-out
         ${n.isDragAccept?"border-green-500":n.isDragReject||i?"border-red-500":"border-gray-300"}`,s),...o,children:a}),e.jsx(I,{ref:n.inputRef,disabled:l,...n.getInputProps(),className:`${l?"cursor-not-allowed":""}`})]})});Rs.displayName="FileInput";function Uo(){const s=O(),[a,r]=x.useState(!1),t={maxFiles:1,maxSize:1024*1024*3,multiple:!1},n=["image/jpeg","image/png","image/webp"],[i,l]=x.useState(null),o=$({mutationFn:async()=>{const c=new FormData;if(i===null||i.length===0)return;if(!i.every(j=>n.includes(j.type))){P.error("Tipo de archivo no admitido");return}c.append("file",i[0]);const m=await(await fetch("/api/users/picture",{method:"POST",body:c})).json();m.success||P.error(m.error),s.invalidateQueries({queryKey:["picture"]}),P.success("La foto ha sido actualizada correctamente"),r(!1)}});return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:"outline",className:"w-8 h-8 p-0.5  ",children:e.jsx(xs,{className:"w-6 h-6"})})})}),e.jsx(V,{children:"Actualizar foto"})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Actualizar mi foto de perfil"})}),e.jsxs(Ds,{value:i,onValueChange:l,dropzoneOptions:t,className:"w-full",children:[e.jsx(Rs,{className:"h-[200px] w-full rounded-lg border-2 border-dashed border-muted-foreground/25 hover:border-muted-foreground/50 transition-colors",children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center space-y-2 text-center",children:[e.jsx(ue.div,{className:" p-4",animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:e.jsx(xs,{className:"h-8 w-8 text-customborder"})}),e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-primary",children:"Haz clic para subir"})," o arrastra y suelta"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"PNG, JPG o Webp (max. 3MB)"})]})}),e.jsx(Ue,{children:i&&i.length>0&&e.jsx(ue.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4",children:e.jsx(Is,{children:i.map((c,d)=>e.jsx(ue.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{delay:d*.1},children:e.jsx(Fs,{index:d,className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xs,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-sm p-2 w-56 truncate text-muted-foreground",children:c.name})]})})},d))})})})]}),e.jsx(_,{loading:o.isPending,className:"w-full mt-4",onClick:()=>o.mutate(),children:"Guardar"})]})]})}function Qo({name:s}){const{data:a,isLoading:r,isError:t}=T({queryKey:["picture"],queryFn:async()=>{const n=await fetch("/api/users/pictures",{method:"GET"});if(!n.ok){const l=await n.json();throw new Error(l.error||"Failed to fetch image")}const i=await n.blob();return URL.createObjectURL(i)},retry:!1});return e.jsxs("div",{className:"w-full h-full flex justify-center items-center",children:[e.jsxs(Es,{className:"h-36 w-36",children:[!r&&!t&&a&&e.jsx(pa,{alt:`${s}'s avatar`,src:a}),e.jsx(Gs,{className:"bg-accent",children:r?"Loading...":t?"Error":Un(s)})]}),e.jsx(Uo,{})]})}const Yo=h.object({credential:h.number({required_error:"Ingrese un número de credencial"}).max(99999999,{message:"Ingrese una credencial válida"}).min(1e3,{message:"Ingrese una credencial válida"})}),wr=h.object({specialite:h.enum(["GENERAL","PEDIATRIA"],{errorMap:()=>({message:"Seleccione un especialidad"})})}),Wo=h.object({assistantId:h.string({required_error:"Seleccione un asistente"})});h.object({skills:h.string()});const Yn=h.object({name:h.string().min(2,"Completa el nombre").max(20,"Error")}),Fe=x.forwardRef(({className:s,...a},r)=>e.jsx(Jr,{className:F("grid gap-2",s),...a,ref:r}));Fe.displayName=Jr.displayName;const ye=x.forwardRef(({className:s,...a},r)=>e.jsx(Zr,{ref:r,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:e.jsx(Di,{className:"flex items-center justify-center",children:e.jsx(gs,{className:"h-3.5 w-3.5 fill-primary"})})}));ye.displayName=Zr.displayName;function Jo({esp:s}){const a=O(),[r,t]=x.useState(!1),n=wr.parse({specialite:s}),i=J({resolver:W(wr),defaultValues:{specialite:n.specialite||"GENERAL"}}),l=$({mutationFn:async c=>{const u=await(await D.doctors.type.$patch({json:c})).json();if(!u.success)throw new Error;return P.success("Tipo de expediente actualizado correctamente"),a.invalidateQueries({queryKey:["currentUser"]}),t(!1),u},onError:()=>{P.error('"Error al actualizar el tipo de expediente"')}}),o=c=>{l.mutate(c)};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(ua,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Cambiar el tipo de expediente"})]})}),e.jsxs(Q,{children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Quieres cambiar el tipo de expediente"}),e.jsx(Ce,{children:"Esto afectara el como manejas los expedientes de tus pacientes."})]}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),children:[e.jsx(w,{control:i.control,name:"specialite",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Tipo de Expediente"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:c.onChange,defaultValue:c.value,disabled:l.isPending,className:"flex gap-5",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"GENERAL"}),e.jsx(y,{children:"General"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"PEDIATRIA"}),e.jsx(y,{children:"Pediatría"})]})]})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:l.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function Zo(){const s=O(),[a,r]=x.useState(!1),t=J({resolver:W(Yo)}),n=$({mutationFn:async l=>{const c=await(await D.doctors.credential.$patch({json:l})).json();if(!c.success)throw new Error;return P.success("Credencial guardada correctamente"),s.invalidateQueries({queryKey:["doctorInfo"]}),r(!1),c},onError:()=>{P.error('"Error al actualizar la credencial"')}}),i=l=>{n.mutate(l)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(ua,{className:"w-5 h-5"})})})}),e.jsx(V,{children:"Agregar Credencial MINSA"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Guardar tu credencial del MINSA"})}),e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(i),children:[e.jsx(w,{control:t.control,name:"credential",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Credencial MINSA"}),e.jsx(v,{children:e.jsx(I,{onChange:o=>{const c=o.target.value;/^\d+$/.test(c)||(o.target.value=c.replace(/[^0-9]/g,"")),l.onChange(parseInt(o.target.value))},disabled:n.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:n.isPending,type:"submit",children:"Guardar"})})]})})]})]})}const pe=zi,Cr=Oi,fe=_i,me=x.forwardRef(({className:s,children:a,...r},t)=>e.jsxs(Xr,{ref:t,className:F("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[a,e.jsx(Ii,{asChild:!0,children:e.jsx(Ua,{className:"h-4 w-4 opacity-50"})})]}));me.displayName=Xr.displayName;const Wn=x.forwardRef(({className:s,...a},r)=>e.jsx(en,{ref:r,className:F("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Fi,{})}));Wn.displayName=en.displayName;const Jn=x.forwardRef(({className:s,...a},r)=>e.jsx(sn,{ref:r,className:F("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Je,{})}));Jn.displayName=sn.displayName;const xe=x.forwardRef(({className:s,children:a,position:r="popper",...t},n)=>e.jsx(Ri,{children:e.jsxs(an,{ref:n,className:F("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...t,children:[e.jsx(Wn,{}),e.jsx(Mi,{className:F("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(Jn,{})]})}));xe.displayName=an.displayName;const Ma=x.forwardRef(({className:s,...a},r)=>e.jsx(rn,{ref:r,className:F("px-2 py-1.5 text-sm font-semibold",s),...a}));Ma.displayName=rn.displayName;const te=x.forwardRef(({className:s,children:a,...r},t)=>e.jsxs(nn,{ref:t,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ti,{children:e.jsx(gs,{className:"h-4 w-4"})})}),e.jsx($i,{children:a})]}));te.displayName=nn.displayName;const Xo=x.forwardRef(({className:s,...a},r)=>e.jsx(tn,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",s),...a}));Xo.displayName=tn.displayName;function ec(){const s=O(),[a,r]=x.useState(!1),t=J({resolver:W(Wo)}),{data:n,isPending:i}=T({queryKey:["assistants"],queryFn:async()=>(await(await D.doctors.list.$get()).json()).data}),l=$({mutationFn:async c=>{const u=await(await D.doctors.assistant.$patch({json:c})).json();if(!u.success)throw new Error;return P.success("Asistente asignado correctamente"),s.invalidateQueries({queryKey:["doctorInfo"]}),r(!1),u},onError:()=>{P.error("Error al actualizar tu asistente")}}),o=c=>{l.mutate(c)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(oa,{})})})}),e.jsx(V,{children:"Seleccionar un asistente"})]})}),e.jsxs(Q,{children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Puedes seleccionar un asistente"}),e.jsx(Ce,{children:"Elige un asistente de la lista para que te ayude a coordinar tu agenda."})]}),e.jsx(e.Fragment,{children:e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(o),children:[e.jsx(w,{control:t.control,name:"assistantId",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Seleccionar"}),n&&e.jsxs(pe,{onValueChange:c.onChange,defaultValue:c.value,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{placeholder:"Selecciona un asistente"})})}),i?e.jsx("div",{children:"Cargando..."}):e.jsx(xe,{children:n.map(d=>e.jsx(te,{value:d.assistantId,children:d.assistantName},d.assistantId))})]}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:l.isPending,type:"submit",children:"Guardar"})})]})})})]})]})}function Ee(){return e.jsx("div",{className:"flex flex-col space-y-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-4 w-[250px]"}),e.jsx(se,{className:"h-4 w-[250px]"}),e.jsx(se,{className:"h-4 w-[200px]"})]})})}const ge=x.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:F("rounded-xl border bg-card text-card-foreground shadow",s),...a}));ge.displayName="Card";const ve=x.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:F("flex flex-col space-y-1.5 p-6",s),...a}));ve.displayName="CardHeader";const we=x.forwardRef(({className:s,...a},r)=>e.jsx("h3",{ref:r,className:F("font-semibold leading-none tracking-tight",s),...a}));we.displayName="CardTitle";const sc=x.forwardRef(({className:s,...a},r)=>e.jsx("p",{ref:r,className:F("text-sm text-muted-foreground",s),...a}));sc.displayName="CardDescription";const be=x.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:F("p-6 pt-0",s),...a}));be.displayName="CardContent";const Zn=x.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:F("flex items-center p-6 pt-0",s),...a}));Zn.displayName="CardFooter";const ac=h.object({name:h.string().min(3,"El nombre debe tener al menos 3 caracteres").max(100,"El nombre no puede exceder los 100 caracteres"),currency:h.enum(["cor","dol"],{errorMap:()=>({message:"Debes seleccionar una moneda válida"})}),color:h.string().regex(/^#([0-9A-F]{3}){1,2}$/i,"El color debe ser un valor hexadecimal válido")});function rc(){const s=O(),[a,r]=x.useState(!1),t=J({resolver:W(ac),defaultValues:{name:"",currency:"cor",color:"#000000"}}),n=$({mutationFn:async l=>{const c=await(await D.flows.bankaccounts.$post({json:l})).json();if(!c.success)throw new Error("Error al crear la cuenta bancaria");return c},onSuccess:()=>{P.success("Cuenta bancaria creada correctamente"),s.invalidateQueries({queryKey:["bankAccounts"]}),r(!1),t.reset()},onError:()=>{P.error("Error al crear la cuenta bancaria")}}),i=l=>{n.mutate(l)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(ma,{className:"h-4 w-4"})})})}),e.jsx(V,{children:"Nueva cuenta bancaria"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Agregar una nueva cuenta bancaria"})}),e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(i),className:"space-y-4",children:[e.jsx(w,{control:t.control,name:"name",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre"}),e.jsx(v,{children:e.jsx(I,{...l,disabled:n.isPending,placeholder:"Nombre de la cuenta"})}),e.jsx(C,{})]})}),e.jsx(w,{control:t.control,name:"currency",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Moneda"}),e.jsxs(pe,{onValueChange:l.onChange,defaultValue:l.value,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{placeholder:"Selecciona una moneda"})})}),e.jsxs(xe,{children:[e.jsx(te,{value:"cor",children:"Córdobas"}),e.jsx(te,{value:"dol",children:"Dólares"})]})]}),e.jsx(C,{})]})}),e.jsx(w,{control:t.control,name:"color",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Color"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{...l,type:"color",disabled:n.isPending,className:"w-12 h-12 p-1 rounded-md"}),e.jsx(I,{...l,disabled:n.isPending,placeholder:"#000000",className:"flex-grow"})]})}),e.jsx(C,{})]})}),e.jsx(oe,{children:e.jsx(_,{loading:n.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function nc(){const{data:s,isLoading:a,error:r}=T({queryKey:["bankAccounts"],queryFn:async()=>{const t=await D.flows.bankaccounts.$get(),n=await t.json();if(!t.ok)throw new Error("Error al cargar las cuentas bancarias");return n.data}});return a?e.jsx(ic,{}):r?e.jsx("div",{className:"text-red-500",children:"Error al cargar las cuentas bancarias"}):e.jsxs("div",{className:"space-y-4 my-4 ",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Cuentas Bancarias"}),e.jsx(rc,{})]}),s&&s.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(t=>e.jsx(tc,{account:t},t.id))}):e.jsx("p",{className:"text-muted-foreground mb-4",children:"No hay cuentas bancarias registradas."})]})}function tc({account:s}){return e.jsxs(ge,{className:"overflow-hidden",children:[e.jsx("div",{className:"h-2",style:{backgroundColor:s.color}}),e.jsxs(ve,{className:"flex flex-row items-center bg-background justify-between space-y-0 pb-2",children:[e.jsx(we,{className:"text-sm font-medium",children:s.name}),e.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:s.color}})]}),e.jsxs(be,{className:"bg-background",children:[e.jsx("div",{className:"text-2xl font-bold text-customborder",children:s.currency==="cor"?"C$":"$"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.currency==="cor"?"Córdobas":"Dólares"})]})]})}function ic(){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(se,{className:"h-8 w-48"}),e.jsx(se,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[...Array(3)].map((s,a)=>e.jsxs(ge,{className:"overflow-hidden",children:[e.jsx(se,{className:"h-2 w-full"}),e.jsxs(ve,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(se,{className:"h-4 w-[100px]"}),e.jsx(se,{className:"h-4 w-4 rounded-full"})]}),e.jsxs(be,{children:[e.jsx(se,{className:"h-8 w-[60px]"}),e.jsx(se,{className:"h-4 w-[80px] mt-2"})]})]},a))})]})}const lc=h.object({speciality:h.string()});function oc({esp:s}){const a=O(),[r,t]=x.useState(!1),n=J({resolver:W(lc),defaultValues:{speciality:s}}),i=$({mutationFn:async o=>{const d=await(await D.doctors.speciality.$patch({json:o})).json();if(!d.success)throw new Error;return P.success("Especialidad actualizada correctamente"),a.invalidateQueries({queryKey:["doctorInfo"]}),t(!1),d},onError:()=>{P.error('"Error al actualizar la especialidad"')}}),l=o=>{i.mutate(o)};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(ua,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Cambiar la especialidad"})]})}),e.jsxs(Q,{children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Quieres cambiar la especialidad"}),e.jsx(Ce,{children:"Verás tu especialidad en los documentos generados."})]}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(l),children:[e.jsx(w,{control:n.control,name:"speciality",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Especialidad"}),e.jsx(sr,{children:"Por ejemplo: Cardiología, Urología, Dermatología... etc"}),e.jsx(v,{children:e.jsx(I,{...o})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:i.isPending,type:"submit",children:"Guardar"})})]})})]})]})}const ka={Facebook:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M16,2c-7.732,0-14,6.268-14,14,0,6.566,4.52,12.075,10.618,13.588v-9.31h-2.887v-4.278h2.887v-1.843c0-4.765,2.156-6.974,6.835-6.974,.887,0,2.417,.174,3.043,.348v3.878c-.33-.035-.904-.052-1.617-.052-2.296,0-3.183,.87-3.183,3.13v1.513h4.573l-.786,4.278h-3.787v9.619c6.932-.837,12.304-6.74,12.304-13.897,0-7.732-6.268-14-14-14Z"></path></svg>',Instagram:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M10.202,2.098c-1.49,.07-2.507,.308-3.396,.657-.92,.359-1.7,.84-2.477,1.619-.776,.779-1.254,1.56-1.61,2.481-.345,.891-.578,1.909-.644,3.4-.066,1.49-.08,1.97-.073,5.771s.024,4.278,.096,5.772c.071,1.489,.308,2.506,.657,3.396,.359,.92,.84,1.7,1.619,2.477,.779,.776,1.559,1.253,2.483,1.61,.89,.344,1.909,.579,3.399,.644,1.49,.065,1.97,.08,5.771,.073,3.801-.007,4.279-.024,5.773-.095s2.505-.309,3.395-.657c.92-.36,1.701-.84,2.477-1.62s1.254-1.561,1.609-2.483c.345-.89,.579-1.909,.644-3.398,.065-1.494,.081-1.971,.073-5.773s-.024-4.278-.095-5.771-.308-2.507-.657-3.397c-.36-.92-.84-1.7-1.619-2.477s-1.561-1.254-2.483-1.609c-.891-.345-1.909-.58-3.399-.644s-1.97-.081-5.772-.074-4.278,.024-5.771,.096m.164,25.309c-1.365-.059-2.106-.286-2.6-.476-.654-.252-1.12-.557-1.612-1.044s-.795-.955-1.05-1.608c-.192-.494-.423-1.234-.487-2.599-.069-1.475-.084-1.918-.092-5.656s.006-4.18,.071-5.656c.058-1.364,.286-2.106,.476-2.6,.252-.655,.556-1.12,1.044-1.612s.955-.795,1.608-1.05c.493-.193,1.234-.422,2.598-.487,1.476-.07,1.919-.084,5.656-.092,3.737-.008,4.181,.006,5.658,.071,1.364,.059,2.106,.285,2.599,.476,.654,.252,1.12,.555,1.612,1.044s.795,.954,1.051,1.609c.193,.492,.422,1.232,.486,2.597,.07,1.476,.086,1.919,.093,5.656,.007,3.737-.006,4.181-.071,5.656-.06,1.365-.286,2.106-.476,2.601-.252,.654-.556,1.12-1.045,1.612s-.955,.795-1.608,1.05c-.493,.192-1.234,.422-2.597,.487-1.476,.069-1.919,.084-5.657,.092s-4.18-.007-5.656-.071M21.779,8.517c.002,.928,.755,1.679,1.683,1.677s1.679-.755,1.677-1.683c-.002-.928-.755-1.679-1.683-1.677,0,0,0,0,0,0-.928,.002-1.678,.755-1.677,1.683m-12.967,7.496c.008,3.97,3.232,7.182,7.202,7.174s7.183-3.232,7.176-7.202c-.008-3.97-3.233-7.183-7.203-7.175s-7.182,3.233-7.174,7.203m2.522-.005c-.005-2.577,2.08-4.671,4.658-4.676,2.577-.005,4.671,2.08,4.676,4.658,.005,2.577-2.08,4.671-4.658,4.676-2.577,.005-4.671-2.079-4.676-4.656h0"></path></svg>',LinkedIn:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M26.111,3H5.889c-1.595,0-2.889,1.293-2.889,2.889V26.111c0,1.595,1.293,2.889,2.889,2.889H26.111c1.595,0,2.889-1.293,2.889-2.889V5.889c0-1.595-1.293-2.889-2.889-2.889ZM10.861,25.389h-3.877V12.87h3.877v12.519Zm-1.957-14.158c-1.267,0-2.293-1.034-2.293-2.31s1.026-2.31,2.293-2.31,2.292,1.034,2.292,2.31-1.026,2.31-2.292,2.31Zm16.485,14.158h-3.858v-6.571c0-1.802-.685-2.809-2.111-2.809-1.551,0-2.362,1.048-2.362,2.809v6.571h-3.718V12.87h3.718v1.686s1.118-2.069,3.775-2.069,4.556,1.621,4.556,4.975v7.926Z" fill-rule="evenodd"></path></svg>',X:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M18.42,14.009L27.891,3h-2.244l-8.224,9.559L10.855,3H3.28l9.932,14.455L3.28,29h2.244l8.684-10.095,6.936,10.095h7.576l-10.301-14.991h0Zm-3.074,3.573l-1.006-1.439L6.333,4.69h3.447l6.462,9.243,1.006,1.439,8.4,12.015h-3.447l-6.854-9.804h0Z"></path></svg>',Twitch:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M8.5,2L3.143,7.357V26.643h6.429v5.357l5.357-5.357h4.286l9.643-9.643V2H8.5ZM26.714,15.929l-4.286,4.286h-4.286l-3.75,3.75v-3.75h-4.821V4.143H26.714V15.929Z"></path><path d="M21.357 7.893H23.5V14.322H21.357z"></path><path d="M15.464 7.893H17.607V14.322H15.464z"></path></svg>',YouTube:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M31.331,8.248c-.368-1.386-1.452-2.477-2.829-2.848-2.496-.673-12.502-.673-12.502-.673,0,0-10.007,0-12.502,.673-1.377,.37-2.461,1.462-2.829,2.848-.669,2.512-.669,7.752-.669,7.752,0,0,0,5.241,.669,7.752,.368,1.386,1.452,2.477,2.829,2.847,2.496,.673,12.502,.673,12.502,.673,0,0,10.007,0,12.502-.673,1.377-.37,2.461-1.462,2.829-2.847,.669-2.512,.669-7.752,.669-7.752,0,0,0-5.24-.669-7.752ZM12.727,20.758V11.242l8.364,4.758-8.364,4.758Z"></path></svg>',WhatsApp:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M25.873,6.069c-2.619-2.623-6.103-4.067-9.814-4.069C8.411,2,2.186,8.224,2.184,15.874c-.001,2.446,.638,4.833,1.852,6.936l-1.969,7.19,7.355-1.929c2.026,1.106,4.308,1.688,6.63,1.689h.006c7.647,0,13.872-6.224,13.874-13.874,.001-3.708-1.44-7.193-4.06-9.815h0Zm-9.814,21.347h-.005c-2.069,0-4.099-.557-5.87-1.607l-.421-.25-4.365,1.145,1.165-4.256-.274-.436c-1.154-1.836-1.764-3.958-1.763-6.137,.003-6.358,5.176-11.531,11.537-11.531,3.08,.001,5.975,1.202,8.153,3.382,2.177,2.179,3.376,5.077,3.374,8.158-.003,6.359-5.176,11.532-11.532,11.532h0Zm6.325-8.636c-.347-.174-2.051-1.012-2.369-1.128-.318-.116-.549-.174-.78,.174-.231,.347-.895,1.128-1.098,1.359-.202,.232-.405,.26-.751,.086-.347-.174-1.464-.54-2.788-1.72-1.03-.919-1.726-2.054-1.929-2.402-.202-.347-.021-.535,.152-.707,.156-.156,.347-.405,.52-.607,.174-.202,.231-.347,.347-.578,.116-.232,.058-.434-.029-.607-.087-.174-.78-1.88-1.069-2.574-.281-.676-.567-.584-.78-.595-.202-.01-.433-.012-.665-.012s-.607,.086-.925,.434c-.318,.347-1.213,1.186-1.213,2.892s1.242,3.355,1.416,3.587c.174,.232,2.445,3.733,5.922,5.235,.827,.357,1.473,.571,1.977,.73,.83,.264,1.586,.227,2.183,.138,.666-.1,2.051-.839,2.34-1.649,.289-.81,.289-1.504,.202-1.649s-.318-.232-.665-.405h0Z" fill-rule="evenodd"></path></svg>',Snapchat:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M30.893,22.837c-.208-.567-.606-.871-1.058-1.122-.085-.05-.163-.09-.23-.12-.135-.07-.273-.137-.41-.208-1.41-.747-2.51-1.69-3.274-2.808-.217-.315-.405-.648-.562-.996-.065-.186-.062-.292-.015-.389,.046-.074,.108-.138,.18-.188,.242-.16,.492-.323,.661-.432,.302-.195,.541-.35,.695-.46,.579-.405,.983-.835,1.236-1.315,.357-.672,.404-1.466,.13-2.175-.383-1.009-1.336-1.635-2.49-1.635-.243,0-.486,.025-.724,.077-.064,.014-.127,.028-.189,.044,.011-.69-.005-1.418-.066-2.135-.218-2.519-1.1-3.84-2.02-4.893-.589-.66-1.283-1.218-2.053-1.653-1.396-.797-2.979-1.202-4.704-1.202s-3.301,.405-4.698,1.202c-.773,.434-1.468,.994-2.057,1.656-.92,1.053-1.802,2.376-2.02,4.893-.061,.717-.077,1.449-.067,2.135-.062-.016-.125-.031-.189-.044-.238-.051-.481-.077-.724-.077-1.155,0-2.109,.626-2.491,1.635-.276,.71-.23,1.505,.126,2.178,.254,.481,.658,.911,1.237,1.315,.153,.107,.393,.262,.695,.46,.163,.106,.402,.261,.635,.415,.082,.053,.151,.123,.204,.205,.049,.1,.051,.208-.022,.408-.155,.341-.34,.668-.553,.976-.747,1.092-1.815,2.018-3.179,2.759-.723,.383-1.474,.639-1.791,1.502-.239,.651-.083,1.391,.525,2.015h0c.223,.233,.482,.429,.766,.58,.592,.326,1.222,.578,1.876,.75,.135,.035,.263,.092,.379,.169,.222,.194,.19,.486,.485,.914,.148,.221,.336,.412,.555,.564,.619,.428,1.315,.455,2.053,.483,.666,.025,1.421,.054,2.283,.339,.357,.118,.728,.346,1.158,.613,1.032,.635,2.446,1.503,4.811,1.503s3.789-.873,4.829-1.51c.427-.262,.796-.488,1.143-.603,.862-.285,1.617-.313,2.283-.339,.737-.028,1.433-.055,2.053-.483,.259-.181,.475-.416,.632-.69,.212-.361,.207-.613,.406-.789,.109-.074,.229-.129,.356-.162,.662-.173,1.301-.428,1.901-.757,.302-.162,.575-.375,.805-.63l.008-.009c.57-.61,.714-1.329,.48-1.964Zm-2.102,1.13c-1.282,.708-2.135,.632-2.798,1.059-.563,.363-.23,1.144-.639,1.426-.503,.347-1.989-.025-3.909,.609-1.584,.524-2.594,2.029-5.442,2.029s-3.835-1.502-5.444-2.033c-1.916-.634-3.406-.262-3.909-.609-.409-.282-.077-1.064-.639-1.426-.664-.427-1.516-.351-2.798-1.055-.816-.451-.353-.73-.081-.862,4.645-2.249,5.386-5.721,5.419-5.979,.04-.312,.084-.557-.259-.875-.332-.307-1.804-1.218-2.213-1.503-.676-.472-.973-.944-.754-1.523,.153-.401,.527-.552,.92-.552,.124,0,.248,.014,.369,.041,.742,.161,1.462,.533,1.879,.633,.05,.013,.102,.02,.153,.021,.222,0,.3-.112,.285-.366-.048-.812-.162-2.394-.034-3.872,.176-2.034,.831-3.042,1.61-3.934,.374-.428,2.132-2.286,5.493-2.286s5.123,1.85,5.497,2.276c.78,.891,1.436,1.899,1.61,3.934,.128,1.479,.018,3.061-.034,3.872-.018,.268,.063,.366,.285,.366,.052,0,.103-.008,.153-.021,.417-.1,1.137-.472,1.879-.633,.121-.027,.245-.041,.369-.041,.395,0,.766,.153,.92,.552,.219,.579-.077,1.051-.753,1.523-.409,.285-1.881,1.196-2.213,1.503-.344,.317-.299,.563-.259,.875,.033,.261,.773,3.734,5.419,5.979,.274,.137,.737,.416-.079,.871Z"></path></svg>',Pinterest:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M16,2C8.268,2,2,8.268,2,16c0,5.931,3.69,11.001,8.898,13.041-.122-1.108-.233-2.811,.049-4.02,.254-1.093,1.642-6.959,1.642-6.959,0,0-.419-.839-.419-2.079,0-1.947,1.128-3.4,2.533-3.4,1.194,0,1.771,.897,1.771,1.972,0,1.201-.765,2.997-1.16,4.661-.33,1.393,.699,2.53,2.073,2.53,2.488,0,4.401-2.624,4.401-6.411,0-3.352-2.409-5.696-5.848-5.696-3.983,0-6.322,2.988-6.322,6.076,0,1.203,.464,2.494,1.042,3.195,.114,.139,.131,.26,.097,.402-.106,.442-.342,1.393-.389,1.588-.061,.256-.203,.311-.468,.187-1.749-.814-2.842-3.37-2.842-5.424,0-4.416,3.209-8.472,9.25-8.472,4.857,0,8.631,3.461,8.631,8.086,0,4.825-3.042,8.708-7.265,8.708-1.419,0-2.752-.737-3.209-1.608,0,0-.702,2.673-.872,3.328-.316,1.216-1.169,2.74-1.74,3.67,1.31,.406,2.702,.624,4.145,.624,7.732,0,14-6.268,14-14S23.732,2,16,2Z"></path></svg>',TikTok:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M24.562,7.613c-1.508-.983-2.597-2.557-2.936-4.391-.073-.396-.114-.804-.114-1.221h-4.814l-.008,19.292c-.081,2.16-1.859,3.894-4.039,3.894-.677,0-1.315-.169-1.877-.465-1.288-.678-2.169-2.028-2.169-3.582,0-2.231,1.815-4.047,4.046-4.047,.417,0,.816,.069,1.194,.187v-4.914c-.391-.053-.788-.087-1.194-.087-4.886,0-8.86,3.975-8.86,8.86,0,2.998,1.498,5.65,3.783,7.254,1.439,1.01,3.19,1.606,5.078,1.606,4.886,0,8.86-3.975,8.86-8.86V11.357c1.888,1.355,4.201,2.154,6.697,2.154v-4.814c-1.345,0-2.597-.4-3.647-1.085Z"></path></svg>',Discord:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M26.413,6.536c-1.971-.902-4.052-1.543-6.189-1.904-.292,.523-.557,1.061-.793,1.612-2.277-.343-4.592-.343-6.869,0-.236-.551-.5-1.089-.793-1.612-2.139,.365-4.221,1.006-6.194,1.909C1.658,12.336,.596,17.987,1.127,23.558h0c2.294,1.695,4.861,2.984,7.591,3.811,.615-.827,1.158-1.704,1.626-2.622-.888-.332-1.744-.741-2.56-1.222,.215-.156,.425-.316,.628-.472,4.806,2.26,10.37,2.26,15.177,0,.205,.168,.415,.328,.628,.472-.817,.483-1.676,.892-2.565,1.225,.467,.918,1.011,1.794,1.626,2.619,2.732-.824,5.301-2.112,7.596-3.808h0c.623-6.461-1.064-12.06-4.46-17.025Zm-15.396,13.596c-1.479,0-2.702-1.343-2.702-2.994s1.18-3.006,2.697-3.006,2.73,1.354,2.704,3.006-1.192,2.994-2.699,2.994Zm9.967,0c-1.482,0-2.699-1.343-2.699-2.994s1.18-3.006,2.699-3.006,2.723,1.354,2.697,3.006-1.189,2.994-2.697,2.994Z"></path></svg>'},Sr=({icon:s})=>e.jsx("div",{className:"w-6 h-6 text-gray-600",dangerouslySetInnerHTML:{__html:s}});function cc({socials:s={}}){const[a,r]=x.useState({platform:"",value:""}),t=O(),n=$({mutationFn:async c=>{const d=await D.doctors.socials.$post({json:{skills:JSON.stringify(c)}});if(!d.ok)throw new Error("Failed to add social media");return d.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["doctorInfo"]}),r({platform:"",value:""})}}),i=$({mutationFn:async c=>{const d=await D.doctors.socials[":social"].$delete({param:{social:c}});if(!d.ok)throw new Error("Failed to delete social media");return d.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["doctorInfo"]})}}),l=()=>{if(a.platform&&a.value){const c={...s,[a.platform]:a.value};n.mutate(c)}},o=c=>{i.mutate(c)};return n.error||i.error?e.jsxs("div",{className:"text-red-500",children:[e.jsx(pn,{className:"inline-block mr-2"}),"An error occurred while updating your social media. Please try again later."]}):e.jsxs(ge,{className:"col-span-full",children:[e.jsx(ve,{className:"bg-background",children:e.jsx(we,{children:"Redes Sociales"})}),e.jsxs(be,{className:"bg-background",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:s&&Object.entries(s).map(([c,d])=>{const u=ka[c]||"";return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Sr,{icon:u}),e.jsx("span",{className:"ml-2",children:d})]}),e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>o(c),disabled:i.isPending,children:e.jsx(Ja,{className:"h-4 w-4"})})]},c)})}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(de,{htmlFor:"platform",children:"Agregar Red Social"}),e.jsxs(pe,{value:a.platform,onValueChange:c=>r({...a,platform:c}),children:[e.jsx(me,{id:"platform",children:e.jsx(fe,{placeholder:"Selecciona una plataforma"})}),e.jsx(xe,{children:Object.keys(ka).map(c=>e.jsx(te,{value:c,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Sr,{icon:ka[c]}),e.jsx("span",{className:"ml-2",children:c})]})},c))})]}),e.jsx(I,{type:"text",placeholder:"Ingresa el valor (ej. número o enlace)",value:a.value,onChange:c=>r({...a,value:c.target.value})}),e.jsx(E,{onClick:l,disabled:n.isPending,children:"Agregar"})]})]})]})}function dc(){const s=O(),[a,r]=x.useState(!1),t={maxFiles:1,maxSize:1024*1024*3,multiple:!1},n=["image/jpeg","image/png","image/webp"],[i,l]=x.useState(null),o=$({mutationFn:async()=>{const c=new FormData;if(i===null||i.length===0)return;if(!i.every(j=>n.includes(j.type))){P.error("Tipo de archivo no admitido");return}c.append("file",i[0]);const m=await(await fetch("/api/users/logo",{method:"POST",body:c})).json();m.success||P.error(m.error),s.invalidateQueries({queryKey:["logo"]}),P.success("El logo ha sido actualizado correctamente"),r(!1)}});return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:"outline",className:"w-8 h-8 p-0.5  ",children:e.jsx(xs,{className:"w-6 h-6"})})})}),e.jsx(V,{children:"Actualizar mi logo"})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Actualizar mi logotipo"})}),e.jsxs(Ds,{value:i,onValueChange:l,dropzoneOptions:t,className:"w-full",children:[e.jsx(Rs,{className:"h-[200px] w-full rounded-lg border-2 border-dashed border-muted-foreground/25 hover:border-muted-foreground/50 transition-colors",children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center space-y-2 text-center",children:[e.jsx(ue.div,{className:" p-4",animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:e.jsx(xs,{className:"h-8 w-8 text-customborder"})}),e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-primary",children:"Haz clic para subir"})," o arrastra y suelta"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"PNG, JPG o Webp (max. 3MB)"})]})}),e.jsx(Ue,{children:i&&i.length>0&&e.jsx(ue.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4",children:e.jsx(Is,{children:i.map((c,d)=>e.jsx(ue.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{delay:d*.1},children:e.jsx(Fs,{index:d,className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xs,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-sm p-2 w-56 truncate text-muted-foreground",children:c.name})]})})},d))})})})]}),e.jsx(_,{loading:o.isPending,className:"w-full mt-4",onClick:()=>o.mutate(),children:"Guardar"})]})]})}function uc(){const{data:s,isLoading:a,isError:r}=T({queryKey:["logo"],queryFn:async()=>{const t=await fetch("/api/users/logos",{method:"GET"});if(!t.ok){const i=await t.json();throw new Error(i.error||"Failed to fetch image")}const n=await t.blob();return URL.createObjectURL(n)},retry:!1});return e.jsxs("div",{className:"w-full h-full my-6 sm:my-10",children:[e.jsxs("div",{className:"flex  justify-center gap-5",children:[e.jsx("p",{className:"text-center text-lg font-semibold mb-4",children:"Mi Logo"}),e.jsx(dc,{})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[a&&e.jsx("p",{className:"",children:"Cargando..."}),r&&e.jsx("p",{className:"",children:"Hubo un error al cargar la imagen"}),!a&&!r&&e.jsx("img",{src:s,alt:"Mi Logo",className:"w-50 h-50  object-cover"})]})]})}function mc({user:s}){var n,i;const{data:a,isPending:r,error:t}=T({queryKey:["doctorInfo"],queryFn:async()=>{const o=await(await D.doctors.info.$get()).json();return o.success?o.data:{credential:null,socials:null,fileType:null,speciality:null,assistantName:null}}});return t?e.jsx(e.Fragment,{children:"An error occurred while fetching your profile information. Please try again later."}):e.jsxs("div",{className:"mt-4 mx-4",children:[e.jsx(de,{className:"text-lg font-medium",children:"Perfil Médico"}),r?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 mt-2 gap-2",children:[e.jsx(Ee,{}),e.jsx(Ee,{}),e.jsx(Ee,{})]}):a?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 mt-2 gap-2",children:[e.jsx(Xs,{title:"Expedientes",value:((n=s.doctor)==null?void 0:n.specialtie)||"No definido",component:e.jsx(Jo,{esp:((i=s.doctor)==null?void 0:i.specialtie)||""})}),e.jsx(Xs,{title:"Código MINSA",value:a.credential||"No definido",component:a.credential?null:e.jsx(Zo,{})}),e.jsx(Xs,{title:"Mi asistente",value:a.assistantName||"No definido",component:a.assistantName?null:e.jsx(ec,{})}),e.jsx(Xs,{title:"Mi Especialidad",value:a.speciality||"No definida",component:e.jsx(oc,{esp:a.speciality||""})})]}):null,e.jsx(nc,{}),r?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 mt-2 gap-2",children:[e.jsx(Ee,{}),e.jsx(Ee,{}),e.jsx(Ee,{})]}):a?e.jsx("div",{className:"mt-4",children:e.jsx(cc,{socials:a.socials})}):null,e.jsx("div",{children:e.jsx(uc,{})})]})}function Xs({title:s,value:a,component:r}){return e.jsx(ge,{children:e.jsxs(be,{className:"flex justify-between items-center p-4",children:[e.jsxs("p",{className:"text-sm font-medium w-9/12",children:[s,": ",e.jsx("strong",{children:a})]}),e.jsx("div",{className:"text-sm font-medium w-3/12",children:r})]})})}function xc(){const{data:s,isPending:a}=T({queryKey:["sessionService"],queryFn:async()=>(await(await D.auth.whatsapp.$get()).json()).data,staleTime:12e5}),[r,t]=x.useState(null),[n,i]=x.useState(null),[l,o]=x.useState(0),[c,d]=x.useState(!1);x.useEffect(()=>{if(!s||c)return;const N=Ul(Ns,{auth:{token:s}});return N.on("connect_error",q=>{l<3?(P.error(`Error de conexión. Reintentando... (${l+1}/3)`),o(A=>A+1)):(P.error("No se pudo conectar con el servidor después de 3 intentos. Intenta de nuevo más tarde."),console.error("Error de conexión:",q),d(!0),t(null))}),N.on("connect",()=>{o(0)}),i(N),N.on("qr",q=>{P.info("Escanea el QR para iniciar la sesión."),console.log(q),t(q)}),N.on("closeSession",q=>{P.info(q),t(null)}),N.on("errorSession",q=>{P.error(q),t(null)}),N.on("openSession",q=>{P.success(q),t(null)}),()=>{N.disconnect()}},[s,l,c]);const u=()=>{try{n?n.emit("session"):P.error("No se pudo conectar con el servidor")}catch(N){console.log(N),P.error("Ocurrió un error al solicitar el código QR")}},m=()=>{p.mutate()},j=()=>{f.mutate()},p=$({mutationFn:async()=>{try{const N=await fetch(`${Ns}/test`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!N.ok)throw new Error(`Error de conexión: ${N.statusText}`);const q=await N.json();q.success?P.success("Mensaje enviado correctamente"):P.error(q.error||"Error al enviar el mensaje")}catch(N){console.error("Error al realizar la solicitud:",N),P.error("No se pudo realizar la solicitud. Verifica la conexión.")}}}),f=$({mutationFn:async()=>{try{const q=await(await fetch(`${Ns}/close`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}})).json();q.success?P.success("Sesión cerrada correctamente"):P.error(q.error||"Error al enviar los mensajes")}catch(N){console.error("Error al realizar la solicitud:",N),P.error("No se pudo realizar la solicitud. Verifica la conexión.")}}});return e.jsxs(ge,{className:"w-full max-w-md mx-auto",children:[e.jsx(ve,{className:"flex flex-col items-center space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h1",{className:"text-lg font-bold text-center",children:"Gestión de Sesiones de WhatsApp"}),e.jsx(Kn,{param:"session"})]})}),e.jsxs(be,{children:[e.jsx(B,{children:e.jsxs("section",{className:"flex flex-wrap justify-center items-center gap-2 mb-4",children:[e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{onClick:u,disabled:a||c,className:"w-full sm:w-auto",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(gl,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Solicitar QR"})]})})}),e.jsx(V,{children:"Escanea el código QR para conectar tu cuenta de WhatsApp"})]}),e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(_,{onClick:m,disabled:p.isPending||a,loading:p.isPending,className:"w-full sm:w-auto",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(yl,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Mensaje de prueba"})]})})}),e.jsx(V,{children:"Puedes enviarte un mensaje de prueba a tu propio WhatsApp"})]}),e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(_,{onClick:j,disabled:f.isPending||a,loading:f.isPending,className:"w-full sm:w-auto",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(bl,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Cerrar sesión"})]})})}),e.jsx(V,{children:"Una vez que cierras la sesión en tu móvil, debes cerrarla desde acá también."})]})]})}),e.jsx("div",{className:"flex justify-center",children:r&&e.jsx("img",{className:"w-full max-w-[250px] h-auto object-contain rounded-lg",src:r,alt:"QR Code"})})]})]})}function hc(){const{data:s,isLoading:a,error:r}=T(js);return a?e.jsx("div",{children:"Cargando..."}):r?e.jsxs("div",{children:["Error: ",r.message]}):s?e.jsx("div",{className:" w-full max-w-3xl mx-auto p-6 md:p-8",children:e.jsxs(Bn,{className:"",defaultValue:"profile",children:[e.jsxs(ar,{children:[e.jsx(Ye,{value:"profile",children:"Acerca de mí"}),e.jsx(Ye,{value:"password",children:"Seguridad"}),s.role==="DOCTOR"&&e.jsxs(e.Fragment,{children:[e.jsx(Ye,{value:"doctor",children:"Doctor"}),e.jsx(Ye,{value:"whats",children:"WhatsApp"})]})]}),e.jsx(We,{value:"profile",children:e.jsxs("div",{className:"mt-4 mx-4",children:[e.jsx(de,{className:"text-lg font-medium",children:"Acerca de mí"}),e.jsxs("section",{className:"w-full flex flex-col sm:flex-row",children:[e.jsx("div",{className:"sm:w-1/2 w-full mt-4  sm:order-2 order-1 ",children:e.jsx(Qo,{name:s.name})}),e.jsxs("div",{className:"sm:w-1/2 w-full mt-4 sm:ml-4 sm:order-1 order-2",children:[e.jsxs("div",{children:[e.jsx(de,{htmlFor:"name",children:"Nombre"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{defaultValue:s.name,value:s.name,id:"name"}),e.jsx(Ko,{userName:s.name})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx(de,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{defaultValue:s.email,id:"email",type:"email"}),e.jsx(Ho,{userEmail:s.email})]})]})]})]})]})}),e.jsx(We,{value:"password",children:e.jsxs("div",{className:"mt-4 mx-4",children:[e.jsx(de,{className:"text-lg font-medium",children:"Cambiar mi clave"}),e.jsx(Go,{})]})}),e.jsx(We,{value:"doctor",children:s&&e.jsx(mc,{user:s})}),e.jsx(We,{value:"whats",children:e.jsx("div",{className:"mt-4 mx-4",children:e.jsx(xc,{})})})]})}):e.jsx("div",{children:"No se encontró información del usuario."})}const jc=ce("/profile/_profile/me")({component:pc});function pc(){const{data:s,isPending:a}=T(js);return a?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("div",{children:s&&e.jsx(ga,{role:s.role})}),s&&e.jsx(hc,{})]})}h.object({reason:h.string().max(700,{message:"Máximo 15 caracteres"})});h.object({history:h.string().max(700,{message:"Máximo 700 caracteres"})});h.object({interrogation:h.string().max(700,{message:"Máximo 700 caracteres"})});h.object({price:h.number().min(200,"El precio debe ser mayor o igual a C$ 200.00"),pay:h.boolean().default(!1),cordobas:h.number().nullable(),dolares:h.number().nullable()});h.object({data:h.string().max(700,{message:"Máximo 700 caracteres"}),autoType:h.enum(["history","interrogation","reason","abd","anus","aspects","diag","exInf","exSup","gen","neu","obs","skin"])});const Xn=h.object({craneo:h.string().optional().nullable(),ojos:h.string().optional().nullable(),orejas:h.string().optional().nullable(),nariz:h.string().optional().nullable(),boca:h.string().optional().nullable(),cuello:h.string().optional().nullable()}),et=h.object({pulmonares:h.string().optional().nullable(),mamas:h.string().optional().nullable(),caja:h.string().optional().nullable(),cardiaco:h.string().optional().nullable()}),fc=({textAreaRef:s,triggerAutoSize:a,maxHeight:r=Number.MAX_SAFE_INTEGER,minHeight:t=0})=>{const[n,i]=x.useState(!0);x.useEffect(()=>{if(s){n&&(s.style.minHeight=`${t+2}px`,r>t&&(s.style.maxHeight=`${r}px`),i(!1)),s.style.height=`${t+2}px`;const o=s.scrollHeight;o>r?s.style.height=`${r}px`:s.style.height=`${o+2}px`}},[s,a])},G=x.forwardRef(({maxHeight:s=Number.MAX_SAFE_INTEGER,minHeight:a=52,className:r,onChange:t,value:n,...i},l)=>{const o=x.useRef(null),[c,d]=x.useState("");return fc({textAreaRef:o.current,triggerAutoSize:c,maxHeight:s,minHeight:a}),x.useImperativeHandle(l,()=>({textArea:o.current,focus:()=>{var u;return(u=o.current)==null?void 0:u.focus()},maxHeight:s,minHeight:a})),x.useEffect(()=>{d(n)},[i==null?void 0:i.defaultValue,n]),e.jsx("textarea",{...i,value:n,ref:o,className:F("flex w-full font-semibold rounded-md border border-input bg-background px-3 py-2  ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),onChange:u=>{d(u.target.value),t==null||t(u)}})});G.displayName="AutosizeTextarea";function gc({querieId:s,data:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(Xn),defaultValues:a??{}}),l=$({mutationFn:async c=>{const u=await(await D.queries.head[":querieId"].$patch({param:{querieId:s},json:c})).json();u.success||P(u.error),P.success("Guardado correctamente"),n.invalidateQueries({queryKey:["groups",s]}),t(!1)}}),o=async c=>l.mutate(c);return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{children:e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{className:"",size:"icon",children:e.jsx(ma,{className:"w-5 h-5"})})}),e.jsx(V,{children:"Guardar Cabeza y Cuello"})]})})}),e.jsxs(Q,{className:"max-w-[1200px]",children:[e.jsx(X,{children:"Cabeza y cuello"}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),children:[e.jsxs("div",{className:" w-full grid grid-cols-2 gap-4 ",children:[e.jsx(w,{control:i.control,name:"craneo",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Cráneo y cuero cabelludo"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:l.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"ojos",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Ojos"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:l.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"orejas",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Orejas y oídos"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:l.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"nariz",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nariz"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:l.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"boca",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Boca"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:l.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"cuello",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Cuello"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:l.isPending})}),e.jsx(C,{})]})})]}),e.jsx(oe,{children:e.jsx(_,{loading:l.isPending,className:"my-2",children:"Guardar"})})]})})]})]})}function st({querieId:s,data:a,isView:r}){const t=yc(a);return e.jsxs(ge,{children:[e.jsx(ve,{className:"my-0 py-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{className:"text-lg font-semibold",children:"Cabeza y Cuello"}),r===!1&&e.jsx(gc,{querieId:s,data:t})]})}),e.jsx(be,{className:"pt-0 mt-0 px-6",children:t?Object.entries(t).map(([n,i])=>i!=null?e.jsxs("div",{className:"my-1 w-full",children:[e.jsx("span",{className:" font-bold",children:`${n.charAt(0).toUpperCase()}${n.slice(1)}: `}),e.jsx("span",{className:"",children:i.split(`
`).map((l,o)=>e.jsxs(cs.Fragment,{children:[l,e.jsx("br",{})]},o))})]},n):null):e.jsx("div",{children:"Sin datos para mostrar"})})]})}function yc(s){if(!s)return null;try{const a=JSON.parse(s);return Xn.parse(a)}catch{return null}}function bc({querieId:s,data:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(et),defaultValues:a??{}}),l=c=>o.mutate(c),o=$({mutationFn:async c=>{const u=await(await D.queries.torax[":querieId"].$patch({param:{querieId:s},json:c})).json();u.success||P.error(u.error),P.success("Guardado correctamente"),n.invalidateQueries({queryKey:["groups",s]}),t(!1)}});return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{children:e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{className:"",size:"icon",children:e.jsx(ma,{className:"w-5 h-5"})})}),e.jsx(V,{children:"Guardar Tórax"})]})})}),e.jsxs(Q,{className:"max-w-[1200px]",children:[e.jsx(X,{children:"Tórax"}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(l),children:[e.jsxs("div",{className:" w-full grid grid-cols-2 gap-4 ",children:[e.jsx(w,{control:i.control,name:"caja",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Caja torácica"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:o.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"mamas",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Mamas"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:o.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"cardiaco",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Cardíaco"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:o.isPending})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"pulmonares",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Campos Pulmonares"}),e.jsx(v,{children:e.jsx(G,{value:c.value??"",onChange:c.onChange,disabled:o.isPending})}),e.jsx(C,{})]})})]}),e.jsx(oe,{children:e.jsx(_,{className:"my-2",type:"submit",loading:o.isPending,children:"Guardar"})})]})})]})]})}function at({querieId:s,data:a,isView:r}){const t=vc(a);return e.jsxs(ge,{children:[e.jsx(ve,{className:"my-0 py-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{className:"text-lg font-semibold ",children:"Tórax:"}),r===!1&&e.jsx(bc,{querieId:s,data:t})]})}),e.jsx(be,{className:"pt-0 mt-0 px-6",children:t?Object.entries(t).map(([n,i])=>i!=null?e.jsxs("div",{className:"my-1 w-full",children:[e.jsx("span",{className:" font-bold",children:`${n.charAt(0).toUpperCase()}${n.slice(1)}: `}),e.jsx("span",{className:"",children:i.split(`
`).map((l,o)=>e.jsxs(cs.Fragment,{children:[l,e.jsx("br",{})]},o))})]},n):null):e.jsx("div",{children:"Sin datos para mostrar"})})]})}function vc(s){if(!s)return null;try{const a=JSON.parse(s);return et.parse(a)}catch{return null}}const Nc=h.object({FC:h.number().int().min(30,{message:"La frecuencia cardíaca mínima es 30"}).max(220,{message:"La frecuencia cardíaca máxima es 220"}).nullable().optional(),SA:h.number().int().min(0,{message:"Mínimo 0"}).max(10,{message:"Máximo 10"}).nullable().optional(),FR:h.number().int().min(10,{message:"La frecuencia respiratoria mínima es 10"}).max(60,{message:"La frecuencia respiratoria máxima es 60"}).nullable().optional(),T:h.number().min(30,{message:"La temperatura mínima es 30°C"}).max(45,{message:"La temperatura máxima es 45°C"}).nullable().optional(),PA:h.object({a:h.number().min(10,{message:"La presión sistólica mínima es 10"}).max(300,{message:"La presión sistólica máxima es 300"}).nullable().optional(),b:h.number().min(10,{message:"La presión diastólica mínima es 10"}).max(300,{message:"La presión diastólica máxima es 300"}).nullable().optional()}).superRefine((s,a)=>{const{a:r,b:t}=s;r!=null&&t==null&&a.addIssue({path:["b"],code:h.ZodIssueCode.custom,message:"La presión diastólica es obligatoria si se proporciona la sistólica."}),t!=null&&r==null&&a.addIssue({path:["a"],code:h.ZodIssueCode.custom,message:"La presión sistólica es obligatoria si se proporciona la diastólica."})}).nullable().optional()}),wc=h.object({IMC:h.number().nullable().optional(),W:h.number().min(1,"El peso mínimo es 1 kg").max(300,"El peso máximo es 300 kg").nullable().optional(),TL:h.number().min(30,{message:"La talla mínima es 30 cm"}).max(300,{message:"La talla máxima es 300 cm"}).nullable().optional(),PC:h.number().min(25,{message:"El perímetro cefálico mínimo es 25 cm"}).max(60,{message:"El perímetro cefálico máximo es 60 cm"}).nullable().optional(),PRA:h.number().min(40,{message:"El perímetro abdominal mínimo es 40 cm"}).max(150,{message:"El perímetro abdominal máximo es 150 cm"}).nullable().optional(),ASC:h.number().min(.5,{message:"El área superficial corporal mínima es 0.5 m²"}).max(3,{message:"El área superficial corporal máxima es 3.0 m²"}).nullable().optional(),PT:h.number().min(60,{message:"El perímetro torácico mínimo es 60 cm"}).max(140,{message:"El perímetro torácico máximo es 140 cm"}).nullable().optional()});function Cc({querieId:s,data:a,specialtie:r}){var d,u;const t=O(),[n,i]=x.useState(!1),l=J({resolver:W(Nc),defaultValues:{FC:a==null?void 0:a.FC,FR:a==null?void 0:a.FR,SA:a==null?void 0:a.SA,PA:{a:(d=a==null?void 0:a.PA)==null?void 0:d.a,b:(u=a==null?void 0:a.PA)==null?void 0:u.b},T:a==null?void 0:a.T}}),o=$({mutationFn:async m=>{if(Object.values(m).every(N=>N==null||typeof N=="object"&&Object.values(N).every(q=>q==null)))return P.error("No se pueden enviar todos los campos vacíos"),null;const f=await(await D.queries.vitals[":querieId"].$post({param:{querieId:s},json:m})).json();if(!f.success){P.error(f.error);return}return t.invalidateQueries({queryKey:["exam"]}),i(!1),f}}),c=m=>{o.mutate(m)};return e.jsxs(Z,{open:n,onOpenChange:i,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",children:e.jsx(Be,{})})})}),e.jsx(V,{children:"Guardar signos vitales"})]})}),e.jsxs(Q,{className:"sm:max-w-4xl w-full",children:[e.jsx(ie,{children:e.jsx(X,{children:"Signos vitales"})}),e.jsx(ee,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(c),children:[e.jsxs("div",{className:"w-full sm:flex sm:space-y-0 space-y-3  justify-between",children:[e.jsx(w,{control:l.control,name:"FC",render:({field:m})=>{var j;return e.jsxs(b,{children:[e.jsx(y,{children:"Frecuencia cardíaca:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:p=>{const f=p.target.value;m.onChange(f===""?null:Number(f))},value:(j=m.value)==null?void 0:j.toString(),disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"LPM"})]})}),e.jsx(C,{})]})}}),e.jsx(w,{control:l.control,name:"FR",render:({field:m})=>{var j;return e.jsxs(b,{children:[e.jsx(y,{children:"Frecuencia Respiratoria:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:p=>{const f=p.target.value;m.onChange(f===""?null:Number(f))},value:(j=m.value)==null?void 0:j.toString(),disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"RPM"})]})}),e.jsx(C,{})]})}}),e.jsx(w,{control:l.control,name:"PA",render:({field:m})=>{var j,p,f,N,q,A,R,k;return e.jsxs(b,{children:[e.jsx(y,{children:"Presión Arterial:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[60px]",onChange:g=>{var M;const S=g.target.value;m.onChange({a:S===""?null:Number(S),b:(M=m.value)==null?void 0:M.b})},value:(p=(j=m.value)==null?void 0:j.a)==null?void 0:p.toString(),disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),e.jsx(I,{className:"w-[60px]",onChange:g=>{var M;const S=g.target.value;m.onChange({a:(M=m.value)==null?void 0:M.a,b:S===""?null:Number(S)})},value:(N=(f=m.value)==null?void 0:f.b)==null?void 0:N.toString(),disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"mmHg"})]})}),e.jsx("p",{className:"text-[0.8rem] font-medium text-destructive",children:((A=(q=l.formState.errors.PA)==null?void 0:q.a)==null?void 0:A.message)||((k=(R=l.formState.errors.PA)==null?void 0:R.b)==null?void 0:k.message)||""})]})}}),e.jsx(w,{control:l.control,name:"T",render:({field:m})=>{var j;return e.jsxs(b,{children:[e.jsx(y,{children:"Temperatura:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:p=>{const f=p.target.value;m.onChange(f===""?null:Number(f))},value:(j=m.value)==null?void 0:j.toString(),disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"°C"})]})}),e.jsx(C,{})]})}}),r!=="GENERAL"&&e.jsx(w,{control:l.control,name:"SA",render:({field:m})=>e.jsxs(b,{children:[e.jsx(y,{children:"Silverman Andersen:"}),e.jsx(v,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(I,{className:"w-[80px]",onChange:j=>{const p=j.target.value;/^[0-9]*$/.test(p)&&m.onChange(p===""?null:Number(p))},value:m.value||"",disabled:o.isPending,type:"number"})})}),e.jsx(C,{})]})})]}),e.jsx(_,{className:"sm:mt-8",loading:o.isPending,type:"submit",children:"Guardar"})]})})]})]})}function Sc({querieId:s,data:a,specialtie:r}){const t=O(),[n,i]=x.useState(!1),l=J({resolver:W(wc),defaultValues:a||{}}),o=$({mutationFn:async d=>{const m=await(await D.queries.antro[":querieId"].$post({param:{querieId:s},json:d})).json();return m.success||P.error(m.error),t.invalidateQueries({queryKey:["exam"]}),i(!1),m}}),c=d=>{o.mutate(d)};return e.jsxs(Z,{open:n,onOpenChange:i,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",children:e.jsx(Be,{})})})}),e.jsx(V,{children:"Guardar Datos antropométricos"})]})}),e.jsxs(Q,{className:"sm:max-w-3xl w-full",children:[e.jsx(ie,{children:e.jsx(X,{children:"Datos antropométricos:"})}),e.jsx(ee,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(c),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-4",children:[e.jsx(w,{control:l.control,name:"W",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"Peso:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value,j=m===""?null:Number(m);d.onChange(j)},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"kg"})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:l.control,name:"TL",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"Talla:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value,j=m===""?null:Number(m);d.onChange(j)},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"CM"})]})}),e.jsx(C,{})]})}),r!=="GENERAL"&&e.jsxs(e.Fragment,{children:[e.jsx(w,{control:l.control,name:"PC",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"Perímetro Cefálico:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value;d.onChange(m===""?null:Number(m))},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"CM"})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:l.control,name:"PT",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"Perímetro Torácico:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value;d.onChange(m===""?null:Number(m))},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"CM"})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:l.control,name:"PRA",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"Perímetro Abdominal:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value;d.onChange(m===""?null:Number(m))},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"CM"})]})}),e.jsx(C,{})]})})]}),e.jsx(w,{control:l.control,name:"IMC",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"IMC:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value;d.onChange(m===""?null:Number(m))},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"kg/m²"})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:l.control,name:"ASC",render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:"Área Superficial Corporal:"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-[80px]",onChange:u=>{const m=u.target.value;d.onChange(m===""?null:Number(m))},value:d.value||"",disabled:o.isPending,type:"number"}),e.jsx("span",{className:"text-muted-foreground",children:"m²"})]})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(E,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(_,{type:"submit",loading:o.isPending,children:"Guardar"})]})]})})]})]})}function nr({querieId:s,specialtie:a,isView:r}){var o,c,d,u,m,j,p,f,N,q,A,R,k;const{data:t,isPending:n}=T({queryFn:async()=>(await(await D.queries.exam.$get({query:{querieId:s}})).json()).data,queryKey:["exam"]});if(n)return e.jsx("div",{children:"Cargando..."});const i=[{icon:e.jsx(Ar,{className:"text-ring"}),label:"Frecuencia cardíaca:",value:(o=t==null?void 0:t.vitals)!=null&&o.FC?`${t.vitals.FC}`:null,unit:"LPM"},{icon:e.jsx(Pc,{className:"text-ring"}),label:"Frecuencia Respiratoria:",value:(c=t==null?void 0:t.vitals)!=null&&c.FR?`${t.vitals.FR}`:null,unit:"RPM"},{icon:e.jsx(Ar,{className:"text-ring"}),label:"Presión Arterial:",value:(u=(d=t==null?void 0:t.vitals)==null?void 0:d.PA)!=null&&u.a?`${t.vitals.PA.a}/${t.vitals.PA.b}`:null,unit:"mmHg"},{icon:e.jsx(Ac,{className:"text-ring"}),label:"Temperatura:",value:(m=t==null?void 0:t.vitals)!=null&&m.T?`${t.vitals.T}`:null,unit:"°C"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Silverman Andersen:",value:(j=t==null?void 0:t.vitals)!=null&&j.SA?`${t.vitals.SA}`:null,unit:"cm"}],l=[{icon:e.jsx(Ec,{className:"text-ring"}),label:"Peso:",value:(p=t==null?void 0:t.antropometrics)!=null&&p.W?`${t.antropometrics.W}`:null,unit:"kg"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Talla:",value:(f=t==null?void 0:t.antropometrics)!=null&&f.TL?`${t.antropometrics.TL}`:null,unit:"cm"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Perímetro Cefálico:",value:(N=t==null?void 0:t.antropometrics)!=null&&N.PC?`${t.antropometrics.PC}`:null,unit:"cm"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Perímetro Torácico:",value:(q=t==null?void 0:t.antropometrics)!=null&&q.PT?`${t.antropometrics.PT}`:null,unit:"cm"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Perímetro Abdominal:",value:(A=t==null?void 0:t.antropometrics)!=null&&A.PRA?`${t.antropometrics.PRA}`:null,unit:"cm"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Área superficie corporal:",value:(R=t==null?void 0:t.antropometrics)!=null&&R.ASC?`${t.antropometrics.ASC}`:null,unit:"m²"},{icon:e.jsx(ps,{className:"text-ring"}),label:"Indice de masa corporal",value:(k=t==null?void 0:t.antropometrics)!=null&&k.IMC?`${t.antropometrics.IMC}`:null,unit:"kg/m²"}];return e.jsx("section",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("h1",{className:"text-lg font-semibold  mr-2",children:"Signos Vitales"}),r===!1&&e.jsx(Cc,{specialtie:a,data:t==null?void 0:t.vitals,querieId:s}),i.map((g,S)=>g.value&&e.jsx(Pr,{icon:g.icon,label:g.label,value:`${g.value} ${g.unit}`},S)),e.jsx("h1",{className:"text-lg font-semibold  mr-2",children:"Datos antropométricos: "}),r===!1&&e.jsx(Sc,{specialtie:a,data:t==null?void 0:t.antropometrics,querieId:s}),l.map((g,S)=>g.value&&e.jsx(Pr,{icon:g.icon,label:g.label,value:`${g.value} ${g.unit}`},S))]})})}function Pr({icon:s,label:a,value:r}){return e.jsxs("div",{className:"min-w-32 flex items-center gap-2 p-2 bg-card border border-customborder rounded shadow-sm",children:[e.jsx("div",{children:e.jsx("p",{className:"text-xs font-medium",children:a})}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx("div",{className:"flex-shrink-0",children:s}),e.jsx("p",{className:"font-bold",children:r})]})]})}function Pc(s){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",...s,width:"24",height:"24",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M6.081 20c1.612 0 2.919 -1.335 2.919 -2.98v-9.763c0 -.694 -.552 -1.257 -1.232 -1.257c-.205 0 -.405 .052 -.584 .15l-.13 .083c-1.46 1.059 -2.432 2.647 -3.404 5.824c-.42 1.37 -.636 2.962 -.648 4.775c-.012 1.675 1.261 3.054 2.877 3.161l.203 .007z"}),e.jsx("path",{d:"M17.92 20c-1.613 0 -2.92 -1.335 -2.92 -2.98v-9.763c0 -.694 .552 -1.257 1.233 -1.257c.204 0 .405 .052 .584 .15l.13 .083c1.46 1.059 2.432 2.647 3.405 5.824c.42 1.37 .636 2.962 .648 4.775c.012 1.675 -1.261 3.054 -2.878 3.161l-.202 .007z"}),e.jsx("path",{d:"M9 12a3 3 0 0 0 3 -3a3 3 0 0 0 3 3"}),e.jsx("path",{d:"M12 4v5"})]})}function Ac(s){return e.jsx("svg",{...s,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 11.25 1.5 1.5.75-.75V8.758l2.276-.61a3 3 0 1 0-3.675-3.675l-.61 2.277H12l-.75.75 1.5 1.5M15 11.25l-8.47 8.47c-.34.34-.8.53-1.28.53s-.94.19-1.28.53l-.97.97-.75-.75.97-.97c.34-.34.53-.8.53-1.28s.19-.94.53-1.28L12.75 9M15 11.25 12.75 9"})})}function Ar(s){return e.jsxs("svg",{...s,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"}),e.jsx("path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27"})]})}function ps(s){return e.jsxs("svg",{...s,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z"}),e.jsx("path",{d:"m14.5 12.5 2-2"}),e.jsx("path",{d:"m11.5 9.5 2-2"}),e.jsx("path",{d:"m8.5 6.5 2-2"}),e.jsx("path",{d:"m17.5 15.5 2-2"})]})}function Ec(s){return e.jsxs("svg",{...s,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"5",r:"3"}),e.jsx("path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z"})]})}const qc=h.object({tradeName:h.string({required_error:"Este campo es requerido"}),presentation:h.string({required_error:"Este campo es requerido"}).min(1,{message:"Error"}),indications:h.string({required_error:"Este campo es requerido"}).min(1,{message:"Error"}),genericName:h.string().optional(),drugId:h.string()}),kc=h.object({details:h.array(qc)}),ya=x.forwardRef(({className:s,...a},r)=>e.jsx(ke,{ref:r,className:F("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...a}));ya.displayName=ke.displayName;const rt=x.forwardRef(({className:s,...a},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ln,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(ke.Input,{ref:r,className:F("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...a})]}));rt.displayName=ke.Input.displayName;const tr=x.forwardRef(({className:s,...a},r)=>e.jsx(ke.List,{ref:r,className:F("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...a}));tr.displayName=ke.List.displayName;const ba=x.forwardRef((s,a)=>e.jsx(ke.Empty,{ref:a,className:"py-6 text-center text-sm",...s}));ba.displayName=ke.Empty.displayName;const va=x.forwardRef(({className:s,...a},r)=>e.jsx(ke.Group,{ref:r,className:F("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...a}));va.displayName=ke.Group.displayName;const Dc=x.forwardRef(({className:s,...a},r)=>e.jsx(ke.Separator,{ref:r,className:F("-mx-1 h-px bg-border",s),...a}));Dc.displayName=ke.Separator.displayName;const Na=x.forwardRef(({className:s,...a},r)=>e.jsx(ke.Item,{ref:r,className:F("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a}));Na.displayName=ke.Item.displayName;const Us=Vi,Qs=Ki,Ms=x.forwardRef(({className:s,align:a="center",sideOffset:r=4,...t},n)=>e.jsx(Li,{children:e.jsx(on,{ref:n,align:a,sideOffset:r,className:F("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));Ms.displayName=on.displayName;const Ic=({data:s,onSelect:a,defaultValue:r=""})=>{var j;const[t,n]=x.useState(!1),[i,l]=x.useState(r),[o,c]=x.useState(""),[d,u]=x.useState(s);x.useEffect(()=>{l(r)},[r]),x.useEffect(()=>{u(s)},[s]);const m=p=>{if(d.find(N=>N.value===p))l(p),a(p);else if(o){const N={value:o,label:o};u(q=>[...q,N]),l(o),a(o)}n(!1)};return e.jsxs(Us,{open:t,onOpenChange:n,children:[e.jsx(Qs,{asChild:!0,children:e.jsxs(E,{variant:"outline",role:"combobox","aria-expanded":t,className:"w-[200px] justify-between",children:[i?((j=d.find(p=>p.value===i))==null?void 0:j.label)||i:"Presentación...",e.jsx(Je,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ms,{className:"w-[200px] p-0",children:e.jsxs(ya,{children:[e.jsx(rt,{value:o,onValueChange:p=>c(p),placeholder:"Presentación..."}),e.jsx(ba,{children:e.jsx(E,{onClick:()=>m(o),children:"Agregar"})}),e.jsx(va,{children:d.map(p=>e.jsxs(Na,{value:p.value,onSelect:()=>m(p.value),children:[e.jsx(gs,{className:F("mr-2 h-4 w-4",i===p.value?"opacity-100":"opacity-0")}),p.label]},p.value))})]})})]})},ir=h.object({genericName:h.string().optional().nullable(),tradeName:h.string({required_error:"Este campo es requerido"}).min(4,{message:"Mínimo 4 caracteres"}),presentations:h.string().array()});function Fc(s){const a=O(),[r,t]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState(s.prescriptionDetails),c=J({resolver:W(kc),defaultValues:{details:l}});x.useEffect(()=>{c.reset({details:l})},[l,c]);const{data:d,isLoading:u}=T({queryKey:["searchDrugs",n],queryFn:async()=>n===""?[]:(await(await D.drugs.search.$get({query:{q:n}})).json()).data}),{data:m,refetch:j}=T({queryKey:["drugPresentations",l.map(g=>g.drugId)],queryFn:async()=>{const g=new Map;for(const S of l){const ne=await(await D.drugs.presentations[":id"].$get({param:{id:S.drugId}})).json();ne.success&&ne.data!==null&&g.set(S.drugId,ne.data)}return g},enabled:l.length>0});x.useEffect(()=>{r&&l.length>0&&j()},[r,l,j]);const p=$({mutationFn:async()=>{const g={tradeName:n.toLowerCase(),presentations:[]};if(!ir.safeParse(g).success){P.error("Error al crear el nuevo medicamento");return}const ne=await(await D.drugs.$post({json:g})).json();if(!ne.success){P.error(ne.error);return}ne.result&&N({drugId:ne.result.id,tradeName:ne.result.tradeName,genericName:ne.result.genericName,presentations:ne.result.presentations??[]})}}),f=()=>{P.promise(p.mutateAsync(),{loading:"Espere..."})},N=g=>{if(!l.find(S=>S.drugId===g.drugId)){const S=[...l,{drugId:g.drugId,tradeName:g.tradeName,genericName:g.genericName??"",presentation:"",indications:""}];o(S),c.setValue("details",S)}},q=g=>{const S=l.filter(M=>M.drugId!==g);o(S),c.setValue("details",S)},A=$({mutationFn:async g=>{const S=a.getQueryData(["prescription",s.querieId]);if(S&&S.length>0){const ne=await(await D.prescriptions[":querieId"].$put({param:{querieId:s.querieId},json:{details:g.details}})).json();if(!ne.success){P.error(ne.error);return}a.invalidateQueries({queryKey:["prescription"]}),P.success("Prescripción Guardada")}else{const ne=await(await D.prescriptions.create[":querieId"].$post({param:{querieId:s.querieId},json:{details:g.details}})).json();if(!ne.success){P.error(ne.error);return}a.invalidateQueries({queryKey:["prescription"]}),P.success("Prescripción Creada")}t(!1)}}),R=g=>{A.mutate(g)},k=g=>{if(m&&m.has(g))return m.get(g).map(M=>({value:M,label:M}));const S=d==null?void 0:d.find(M=>M.drugId===g);return S?S.presentations.map(M=>({value:M,label:M})):[]};return e.jsxs(Z,{open:r,onOpenChange:g=>{t(g),g&&l.length>0&&j()},children:[e.jsx(U,{children:e.jsxs(E,{variant:"outline",children:[e.jsx(Hi,{className:"mr-2 h-4 w-4"}),"Agregar Prescripción"]})}),e.jsxs(Q,{className:"max-w-full",children:[e.jsxs(X,{children:["Nueva prescripción para ",e.jsx("strong",{children:s.patientName})]}),e.jsxs("section",{className:"sm:flex w-full",children:[e.jsxs("aside",{className:"sm:w-1/3 gap-2 p-2",children:[e.jsx(de,{className:"mb-2 font-semibold text-2sm",children:"Buscar Fármacos"}),e.jsxs("div",{className:"flex w-auto items-center",children:[e.jsx(I,{className:"w-200",placeholder:"Buscar Fármacos",onChange:g=>{const M=g.target.value.replace(/[^a-zA-Z\s]/g,"");i(M)}}),e.jsx(E,{variant:"outline",className:"ml-3",onClick:f,size:"sm",children:"Guardar"})]}),e.jsx("div",{className:"w-full my-4",children:e.jsx(As,{className:"h-auto w-full rounded-md border",children:u?e.jsx("div",{children:"Cargando..."}):d==null?void 0:d.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsx("p",{className:"font-semibold",children:g.tradeName}),e.jsx("p",{className:"font-medium mx-4",children:g.genericName}),e.jsx(E,{onClick:()=>N(g),size:"sm",children:"Agregar"})]},g.drugId))})})]}),e.jsx("div",{className:"sm:w-2/3",children:e.jsx(As,{className:"w-full h-96 rounded-md",children:e.jsx(ee,{...c,children:e.jsxs("form",{className:"mr-5",onSubmit:c.handleSubmit(R),children:[c.watch("details").map((g,S)=>e.jsxs("div",{className:"flex flex-wrap w-full space-y-2 md:space-y-0 md:flex-nowrap md:items-start border-b py-2",children:[e.jsx("div",{className:"w-full md:w-auto px-2",children:e.jsx(E,{size:"icon",className:"mt-8",variant:"destructive",onClick:()=>q(g.drugId),children:e.jsx(Ba,{})})}),e.jsx("div",{className:"w-full md:w-1/2 px-2",children:e.jsx(w,{control:c.control,name:`details.${S}.tradeName`,render:({field:M})=>e.jsxs(b,{children:[e.jsx(y,{children:"Fármaco"}),e.jsx(v,{children:e.jsx(I,{value:M.value,readOnly:!0})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"w-full md:w-1/2 px-2",children:e.jsx(w,{control:c.control,name:`details.${S}.genericName`,render:({field:M})=>e.jsxs(b,{children:[e.jsx(y,{children:"Generico"}),e.jsx(v,{children:e.jsx(I,{...M})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"w-full md:w-1/4 px-2",children:e.jsx(w,{control:c.control,name:`details.${S}.presentation`,render:({field:M})=>e.jsxs(b,{children:[e.jsx(y,{children:"Presentación"}),e.jsx(v,{children:e.jsx(Ic,{defaultValue:M.value,data:k(g.drugId),onSelect:ne=>{M.onChange(ne);const He=l.map(($e,Pe)=>Pe===S?{...$e,presentation:ne}:$e);o(He)}})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"w-full md:w-1/2 px-2",children:e.jsx(w,{control:c.control,name:`details.${S}.indications`,render:({field:M})=>e.jsxs(b,{children:[e.jsx(y,{children:"Dosis o Indicaciones"}),e.jsx(v,{children:e.jsx(G,{placeholder:"Indicaciones",...M,onChange:ne=>{M.onChange(ne);const He=l.map(($e,Pe)=>Pe===S?{...$e,indications:ne.target.value}:$e);o(He)}})}),e.jsx(C,{})]})})})]},S)),c.watch("details").length>0&&e.jsx("div",{className:"flex justify-end p-2",children:e.jsx(_,{loading:A.isPending,variant:"default",type:"submit",children:"Guardar"})})]})})})})]})]})]})}const Rc=({items:s,className:a})=>{let[r,t]=x.useState(null);return e.jsx("div",{className:F("grid grid-cols-1 md:grid-cols-2  lg:grid-cols-3  py-2",a),children:s.map((n,i)=>e.jsxs("div",{className:"relative group  block p-2 h-full w-full",onMouseEnter:()=>t(i),onMouseLeave:()=>t(null),children:[e.jsx(Ue,{children:r===i&&e.jsx(ue.span,{className:"absolute inset-0 h-full w-full bg-neutral-200 dark:bg-slate-800/[0.8] block  rounded-3xl",layoutId:"hoverBackground",initial:{opacity:0},animate:{opacity:1,transition:{duration:.15}},exit:{opacity:0,transition:{duration:.15,delay:.2}}})}),e.jsx(ge,{className:"w-full max-w-md rounded-2xl h-full  py-2 overflow-hidden relative z-20",children:e.jsxs(be,{className:"grid gap-3 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:n.tradeName}),e.jsx("p",{className:"text-muted-foreground text-xs",children:n.indications})]}),e.jsx("div",{className:"bg-primary px-4 py-1 rounded-full text-primary-foreground text-xs font-medium",children:n.presentation})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("p",{className:"text-muted-foreground text-xs",children:n.genericName})})]})})]},n==null?void 0:n.tradeName))})};function ss(){return e.jsxs("div",{className:"w-full max-w-3xl h-auto mx-auto p-4 space-y-4 shadow-lg rounded-lg",children:[e.jsx(se,{className:"h-[200px] w-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-3/4"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-2/3"})]}),e.jsx(se,{className:"h-[150px] w-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-4/5"})]})]})}async function Mc(){try{const s=await fetch("/api/users/logos",{method:"GET"});if(!s.ok)throw new Error("Error al obtener el logo");const a=await s.blob();return new Promise((r,t)=>{const n=new FileReader;n.onloadend=()=>r(n.result),n.onerror=()=>t(null),n.readAsDataURL(a)})}catch(s){return console.error("No se pudo obtener el logo:",s),null}}async function as(s,a,r){const o=await Mc();if(o){const d=new Image;d.src=o,await new Promise(p=>{d.onload=()=>p(null)});const u=d.width/d.height;let m=40,j=55;d.width>d.height?j=40/u:m=55*u,s.addImage(o,"PNG",18,12,m,j)}if(s.setFont("Helvetica","bold"),s.setFontSize(14),s.text("CLINICA DE ESPECIALIDADES FAMED",105,20,{align:"center"}),s.setFont("Helvetica","normal"),s.setFontSize(12),s.text("Especialista: "+a.doctorName,105,27,{align:"center"}),re(s,{startY:30,body:[[{content:"Especialidad: "+a.doctorEspeciality+"; Código MINSA: "+(a.doctorCredential||""),styles:{halign:"center"}}]],theme:"plain",styles:{fontSize:10}}),"socials"in a){const d=a.socials;d&&Object.keys(d).length>0&&re(s,{startY:47,body:[Object.entries(d).map(([u,m])=>u+": "+m)],theme:"plain",styles:{fontSize:10}})}let c=s.lastAutoTable.finalY+5;return s.setFont("Helvetica","normal"),s.setFontSize(12),s.text(r,105,c,{align:"center"}),c+7}function Ze(s,a,r){re(s,{startY:a,body:[[r]],styles:{fontSize:14,textColor:[0,0,0],font:"Helvetica"},pageBreak:"auto",theme:"plain"})}function ts(s,a,r){s.setFontSize(12),s.setFont("Helvetica","normal"),s.setTextColor(0,0,0),s.text(r,20,a)}async function Tc(s){const a=await fetch(s);if(a.ok){const r=await a.arrayBuffer(),t=new Uint8Array(r);let n="";const i=8192;for(let c=0;c<t.length;c+=i){const d=t.subarray(c,c+i);n+=String.fromCharCode.apply(null,Array.from(d))}const l=btoa(n),o=a.headers.get("Content-Type")||"image/jpeg";return console.log(o),l}else return console.error("Error al obtener la imagen:",a.status),null}async function $c(s,a,r){const t=new es;let n=0;n=await as(t,r,"Prescripción"),re(t,{startY:n,head:[["Datos del Paciente",""]],body:[["Paciente:",s.patientName],["Fecha:",Y(new Date(s.createdAt),"dd/MM/yyyy")]],theme:"grid",headStyles:{fillColor:[200,200,200],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:10},columnStyles:{0:{cellWidth:40},1:{cellWidth:"auto"}}}),n=t.lastAutoTable.finalY+10,ts(t,n,"Detalles de la Prescripción"),re(t,{startY:n+10,head:[["Medicamento","Nombre Genérico","Presentación","Indicaciones"]],body:a.map(c=>[c.tradeName,c.genericName,c.presentation,c.indications]),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:10},columnStyles:{0:{cellWidth:40},1:{cellWidth:40},2:{cellWidth:40},3:{cellWidth:"auto"}}});const i=t.internal.pageSize,l=t.getNumberOfPages();for(let c=1;c<=l;c++){t.setPage(c),t.setFontSize(10),t.setTextColor(0,0,0);const d=i.height?i.height:i.getHeight();t.text(`Página ${c} de ${l}`,190,d-10,{align:"right"})}const o=t.output("blob");return URL.createObjectURL(o)}const Se=Ha({queryKey:["internal"],queryFn:async()=>(await(await D.pdf.internal.$get()).json()).data}),Er=Ha({queryKey:["external"],queryFn:async()=>(await(await D.pdf.external.$get()).json()).data});function nt({querieId:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(null),[i,l]=x.useState(!1),o=O(),{data:c,refetch:d,isLoading:u,isError:m}=T({queryKey:["pdfPrescription",s],queryFn:async()=>{const N=await(await D.pdf.prescription.$get({query:{querieId:s}})).json();if(!N.success)throw new Error("Error");return N.data},enabled:!1});x.useEffect(()=>{a&&(d(),o.prefetchQuery(Er))},[a,d]);const{data:j}=T(Er);x.useEffect(()=>{c&&j&&(l(!0),$c(c.prescription,c.details,j).then(f=>{n(f),l(!1)}).catch(()=>{n(null),l(!1)}))},[c,j]);const p=()=>u||i?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):m?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):!c||!t?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:t,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsx(E,{size:"icon",variant:"ghost",children:e.jsx(vl,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Generar documento PDF: Prescripción"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:p()})})]})}function tt({querieId:s,patientName:a,isView:r}){const{data:t,isPending:n,error:i}=T({queryKey:["prescription",s],queryFn:async()=>{const o=await(await D.prescriptions.$get({query:{q:s}})).json();if(o.error)throw new Error(o.error);return o.exist===!1?[]:o.data}});return n?e.jsxs(ge,{children:[e.jsx(ve,{children:e.jsx(we,{children:"Prescripción"})}),e.jsx(be,{children:e.jsx(Ee,{})})]}):e.jsxs(e.Fragment,{children:[i&&e.jsx("p",{children:i.message}),e.jsx("div",{children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 ",children:[e.jsxs("div",{className:"flex items-center justify-between ",children:[e.jsx("p",{className:"text-lg font-semibold ",children:"Prescripción"}),r===!1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fc,{querieId:s,patientName:a,prescriptionDetails:t??[]}),e.jsx(nt,{querieId:s})]})]}),e.jsx(Rc,{items:t})]})})]})}const it=x.createContext(null);function wa(){const s=x.useContext(it);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const lt=x.forwardRef(({orientation:s="horizontal",opts:a,setApi:r,plugins:t,className:n,children:i,...l},o)=>{const[c,d]=Yl({...a,axis:s==="horizontal"?"x":"y"},t),[u,m]=x.useState(!1),[j,p]=x.useState(!1),f=x.useCallback(R=>{R&&(m(R.canScrollPrev()),p(R.canScrollNext()))},[]),N=x.useCallback(()=>{d==null||d.scrollPrev()},[d]),q=x.useCallback(()=>{d==null||d.scrollNext()},[d]),A=x.useCallback(R=>{R.key==="ArrowLeft"?(R.preventDefault(),N()):R.key==="ArrowRight"&&(R.preventDefault(),q())},[N,q]);return x.useEffect(()=>{!d||!r||r(d)},[d,r]),x.useEffect(()=>{if(d)return f(d),d.on("reInit",f),d.on("select",f),()=>{d==null||d.off("select",f)}},[d,f]),e.jsx(it.Provider,{value:{carouselRef:c,api:d,opts:a,orientation:s||((a==null?void 0:a.axis)==="y"?"vertical":"horizontal"),scrollPrev:N,scrollNext:q,canScrollPrev:u,canScrollNext:j},children:e.jsx("div",{ref:o,onKeyDownCapture:A,className:F("relative",n),role:"region","aria-roledescription":"carousel",...l,children:i})})});lt.displayName="Carousel";const ot=x.forwardRef(({className:s,...a},r)=>{const{carouselRef:t,orientation:n}=wa();return e.jsx("div",{ref:t,className:"overflow-hidden",children:e.jsx("div",{ref:r,className:F("flex",n==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...a})})});ot.displayName="CarouselContent";const lr=x.forwardRef(({className:s,...a},r)=>{const{orientation:t}=wa();return e.jsx("div",{ref:r,role:"group","aria-roledescription":"slide",className:F("min-w-0 shrink-0 grow-0 basis-full",t==="horizontal"?"pl-4":"pt-4",s),...a})});lr.displayName="CarouselItem";const ct=x.forwardRef(({className:s,variant:a="outline",size:r="icon",...t},n)=>{const{orientation:i,scrollPrev:l,canScrollPrev:o}=wa();return e.jsxs(E,{ref:n,variant:a,size:r,className:F("absolute  h-8 w-8 rounded-full",i==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:l,...t,children:[e.jsx(Qa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});ct.displayName="CarouselPrevious";const dt=x.forwardRef(({className:s,variant:a="outline",size:r="icon",...t},n)=>{const{orientation:i,scrollNext:l,canScrollNext:o}=wa();return e.jsxs(E,{ref:n,variant:a,size:r,className:F("absolute h-8 w-8 rounded-full",i==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:l,...t,children:[e.jsx(Ya,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});dt.displayName="CarouselNext";function zc({resourceId:s,queryId:a}){const r=O(),[t,n]=x.useState(!1),i=$({mutationFn:async()=>{const o=s.split(".").shift(),d=await(await D.media.resources[":queryId"][":resourceId"].$delete({param:{queryId:a,resourceId:o}})).json();if(d.error){P.error(d.error);return}d.success&&P.success("Recurso eliminado correctamente"),r.invalidateQueries({queryKey:["resources",a]}),n(!1)}}),l=()=>{i.mutate()};return e.jsxs(Z,{open:t,onOpenChange:n,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",variant:"destructive",className:"absolute h-5 w-5 top-2 right-2 m-1 rounded-none ",children:e.jsx(Ja,{})})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"¿Quieres eliminar este recurso?"})}),e.jsx(oe,{children:e.jsx(_,{variant:"destructive",loading:i.isPending,onClick:l,children:"Eliminar"})})]})]})}const Oc={"application/pdf":{icon:Js,color:"text-red-500"},"application/msword":{icon:Js,color:"text-blue-500"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{icon:Js,color:"text-blue-500"},document:{icon:Js,color:"text-blue-500"},"application/vnd.ms-excel":{icon:Zs,color:"text-green-500"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{icon:Zs,color:"text-green-500"},"application/vnd.ms-excel.sheet.binary.macroEnabled.12":{icon:Zs,color:"text-green-500"},"application/vnd.ms-excel.sheet.macroEnabled.12":{icon:Zs,color:"text-green-500"}},_c=["image/jpeg","image/png","image/webp"];function Lc({resource:s,queryId:a,isView:r}){var i;const t=((i=s.id.split(".").pop())==null?void 0:i.split("?")[0])||"",n=Oc[t]||{icon:Nl,color:"text-gray-500"};return e.jsx(lr,{className:"md:basis-1/4 lg:basis-1/6",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"relative flex flex-col items-center justify-center p-1 border rounded-lg aspect-square",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"w-full h-full flex items-center justify-center",children:_c.includes(t)?e.jsx("img",{src:s.url,alt:s.name,className:"object-cover w-full h-full rounded-lg"}):e.jsx(n.icon,{className:`w-12 h-12 ${n.color}`})}),r===!1&&e.jsx(zc,{resourceId:s.id,queryId:a})]}),e.jsx("p",{className:"mt-2 text-xs text-center truncate",title:s.name,children:s.name})]})})}function Vc(){return e.jsx(lr,{className:"md:basis-1/4 lg:basis-1/6",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"relative flex flex-col items-center justify-center p-1 border rounded-lg aspect-square",children:e.jsx(se,{className:"w-full h-full rounded-lg"})}),e.jsx(se,{className:"h-4 w-3/4 mx-auto mt-2"})]})})}function ut({querieId:s,isView:a}){const{data:r,isPending:t}=T({queryKey:["resources",s],queryFn:async()=>{const i=await(await D.media.resources[":queryId"].$get({param:{queryId:s}})).json();if("error"in i)throw new Error(i.error);if("resources"in i)return i.resources;throw new Error("Respuesta inesperada del servidor.")}});return e.jsx("div",{className:"px-2 sm:px-4 md:px-8",children:e.jsxs(lt,{opts:{align:"start"},className:"w-full",children:[e.jsx(ot,{children:t?Array.from({length:6}).map((n,i)=>e.jsx(Vc,{},i)):r&&r.length>0?r.map(n=>e.jsx(Lc,{resource:n,queryId:s,isView:a},n.id)):e.jsx("p",{className:"text-center w-full py-4",children:"No hay recursos disponibles."})}),e.jsx(ct,{}),e.jsx(dt,{})]})})}function Ca({patientName:s,patientId:a,size:r}){const{data:t,isPending:n}=T({queryKey:["imagePatient",a],queryFn:async()=>(await(await D.media.patient.$get({query:{patientId:a}})).json()).data,staleTime:36e5,refetchOnWindowFocus:!1});return e.jsx(e.Fragment,{children:n||!t?e.jsx(Es,{children:e.jsx(Gs,{className:"w-full h-full text-sm bg-accent",children:Un(s)})}):e.jsx("a",{href:t,children:e.jsx(Es,{className:`w-${r} h-${r}`,children:e.jsx(pa,{src:t,alt:"@"+s,className:"w-full h-full object-cover"})})})})}function or({patientName:s,patientId:a}){const r=O(),[t,n]=x.useState(!1),i={maxFiles:1,maxSize:1024*1024*3,multiple:!1},l=["image/jpeg","image/png","image/webp"],[o,c]=x.useState(null),d=$({mutationFn:async()=>{const u=new FormData;if(o===null||o.length===0)return;if(!o.every(f=>l.includes(f.type))){P.error("Tipo de archivo no admitido");return}u.append("file",o[0]);const p=await(await fetch(`/api/media/patient/${a}`,{method:"POST",body:u})).json();if(!p.success){P.error(p.error);return}r.invalidateQueries({queryKey:["imagePatient",a]}),P.success("La foto ha sido actualizada correctamente"),n(!1)}});return e.jsxs(Z,{open:t,onOpenChange:n,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:"outline",className:"w-6 h-6 p-0.5  ",children:e.jsx(Da,{className:"  w-4 h-4 "})})})}),e.jsx(V,{children:"Actualizar foto"})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsxs(X,{children:["Actualizar foto de ",e.jsx("span",{className:"font-bold",children:s})]})}),e.jsxs(Ds,{value:o,onValueChange:c,dropzoneOptions:i,className:"w-full",children:[e.jsx(Rs,{className:"h-[200px] w-full rounded-lg border-2 border-dashed border-muted-foreground/25 hover:border-muted-foreground/50 transition-colors",children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center space-y-2 text-center",children:[e.jsx(ue.div,{className:" p-4",animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:e.jsx(xs,{className:"h-8 w-8 text-customborder"})}),e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-primary",children:"Haz clic para subir"})," o arrastra y suelta"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"PNG, JPG o Webp (max. 3MB)"})]})}),e.jsx(Ue,{children:o&&o.length>0&&e.jsx(ue.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4",children:e.jsx(Is,{children:o.map((u,m)=>e.jsx(ue.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{delay:m*.1},children:e.jsx(Fs,{index:m,className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Da,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("div",{className:"text-sm p-2 w-56 truncate text-muted-foreground",children:u.name})]})})},m))})})})]}),e.jsx(_,{loading:d.isPending,className:"w-full mt-4",onClick:()=>d.mutate(),children:"Guardar"})]})]})}const Kc=h.object({id:h.string().min(36).max(36)}),Ta=ce("/doctor/_doctor/view")({async validateSearch({id:s}){return s},component:Hc});function Hc(){const s=Ta.useSearch(),a=Kc.safeParse(s);if(!a.success)return e.jsx("div",{children:"Error: Parámetros no válidos"});const r=a.data.id,{data:t}=Ta.useRouteContext(),{data:n,isLoading:i}=T({queryKey:["querieBaseView",r],queryFn:async()=>{if(!r)return null;const m=await(await D.queries.base.$get({query:{querieId:r}})).json();if(!m.success)throw new Error("Error al cargar la consulta");return m.data}}),{data:l,isLoading:o,error:c}=T({queryKey:["query",r],queryFn:async()=>{if(!r)return null;const m=await(await D.queries.data.$get({query:{querieId:r}})).json();if(!m.success)throw new Error("Error al cargar la consulta");return m.data}}),{data:d}=T({queryKey:["groups",r],queryFn:async()=>{const m=await(await D.queries.grups.$get({query:{querieId:r}})).json();return!m.success||!m.data||m.data===void 0?null:m.data}});return e.jsx("div",{className:"relative min-h-screen",children:e.jsxs("div",{className:"w-full ",children:[c&&e.jsxs("div",{children:["Error: ",c.message]}),o&&e.jsxs("div",{className:"p-6 sm:m-8 m-4 grid sm:grid-cols-3 grid-cols-1 gap-2",children:[e.jsx(Ee,{}),e.jsx(Ee,{}),e.jsx(Ee,{})]}),!o&&l&&e.jsx("section",{className:"p-6 sm:m-8 m-4",children:e.jsxs("div",{className:"flex  justify-center sm:space-x-8 items-center  text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center space-x-2 ",children:[e.jsxs("div",{className:"mr-4 flex items-end",children:[e.jsx(or,{patientId:l.patientId,patientName:l.name}),e.jsx(Ca,{patientName:l.name,patientId:l.patientId,size:"24"})]}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Paciente:"}),e.jsx("span",{className:"block text-xl font-semibold",children:l.name})]})]}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Expediente:"}),e.jsx("span",{className:"block text-xl font-semibold",children:l.idFile})]}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Fecha:"}),e.jsx("span",{className:"block text-xl font-semibold",children:l.createdAt})]}),l.emergency&&e.jsx("div",{className:"",children:e.jsx(de,{className:"mt-6 inline-block bg-destructive text-lg font-semibold py-1 px-3 rounded-full",children:"Emergencia"})})]})}),e.jsxs("section",{className:"sm:space-y-5 mt-5 space-y-3 sm:m-8 m-4",children:[i&&e.jsxs("div",{className:"grid sm:grid-cols-3 grid-cols-1 gap-2",children:[e.jsx(Ee,{}),e.jsx(Ee,{}),e.jsx(Ee,{})]}),n&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Motivo de la consulta:"}),e.jsx(G,{value:n.reason??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Historia de la Enfermedad Actual:"}),e.jsx(G,{value:n.history??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Interrogatorio por aparatos y sistemas:"}),e.jsx(G,{value:n.interrogation??""})]})]}),e.jsx("div",{className:"w-full",children:l&&e.jsx(ut,{isView:!0,querieId:l.id})}),e.jsxs("div",{children:[o&&e.jsx("div",{children:"Cargando consulta..."}),!o&&l&&e.jsx(nr,{specialtie:t==null?void 0:t.doctor.specialtie,querieId:l.id,isView:!0})]}),i&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(je,{}),e.jsx(je,{})]}),n&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Aspecto General:"}),e.jsx(G,{value:n.aspects??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Piel y mucosas:"}),e.jsx(G,{value:n.skin??""})]})]}),e.jsxs("div",{className:"grid sm:gap-4 gap-2 sm:grid-cols-2 grid-cols-1",children:[l&&e.jsx(st,{isView:!0,querieId:l.id,data:JSON.stringify(d==null?void 0:d.head)}),l&&e.jsx(at,{isView:!0,querieId:l.id,data:JSON.stringify(d==null?void 0:d.torax)})]}),i&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{})]}),n&&e.jsxs("div",{className:"grid pt-4 sm:grid-cols-2 grid-cols-1 gap-2 border border-customborder p-4 rounded-sm",children:[e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Abdomen y Pelvis:"}),e.jsx(G,{value:n.abd??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Ano y recto (cuando aplique el caso):"}),e.jsx(G,{value:n.anus??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Extremidades superiores:"}),e.jsx(G,{value:n.exSup??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Extremidades inferiores:"}),e.jsx(G,{value:n.exInf??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Genitourinario (cuando aplique el caso):"}),e.jsx(G,{value:n.genitu??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Examen neurológico:"}),e.jsx(G,{value:n.neuro??""})]})]}),i&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(je,{}),e.jsx(je,{})]}),n&&e.jsxs("div",{className:"mt-4 grid sm:gap-4 gap-2 sm:grid-cols-2 grid-cols-1",children:[e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Observaciones y Análisis:"}),e.jsx(G,{value:n.observations??""})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{children:"Diagnósticos o Problemas:"}),e.jsx(G,{value:n.diag??""})]})]}),l&&e.jsxs("div",{className:"border border-customborder p-4 rounded-sm ",children:[e.jsx("p",{className:"text-lg font-semibold",children:"Planes"}),e.jsx(tt,{patientName:l.name,isView:!0,querieId:l.id})]})]})]})})}const Re=x.forwardRef(({className:s,...a},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:F("w-full caption-bottom text-sm",s),...a})}));Re.displayName="Table";const Me=x.forwardRef(({className:s,...a},r)=>e.jsx("thead",{ref:r,className:F("[&_tr]:border-b",s),...a}));Me.displayName="TableHeader";const Te=x.forwardRef(({className:s,...a},r)=>e.jsx("tbody",{ref:r,className:F("[&_tr:last-child]:border-0",s),...a}));Te.displayName="TableBody";const Sa=x.forwardRef(({className:s,...a},r)=>e.jsx("tfoot",{ref:r,className:F("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));Sa.displayName="TableFooter";const le=x.forwardRef(({className:s,...a},r)=>e.jsx("tr",{ref:r,className:F("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a}));le.displayName="TableRow";const ae=x.forwardRef(({className:s,...a},r)=>e.jsx("th",{ref:r,className:F("h-10 px-2 text-left align-middle font-bold text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));ae.displayName="TableHead";const z=x.forwardRef(({className:s,...a},r)=>e.jsx("td",{ref:r,className:F("p-2 font-medium align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));z.displayName="TableCell";const Gc=x.forwardRef(({className:s,...a},r)=>e.jsx("caption",{ref:r,className:F("mt-4 text-sm text-muted-foreground",s),...a}));Gc.displayName="TableCaption";function Ls({id:s}){const a=_e(),r=$({mutationFn:async()=>{const n=await(await D.queries[":dateId"].$post({param:{dateId:s}})).json();if(!n.success)throw new Error(n.error||"Error desconocido");return n},onError:t=>{P.error(t.message)},onSuccess:t=>{t.redirect&&(t.role==="DOCTOR"&&a({to:`/doctor/queries/?querieId=${t.redirect}`}),t.role==="ASSISTANT"&&a({to:`/assistant/queries/?querieId=${t.redirect}`}))}});return e.jsxs(Z,{children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"sm",children:"Atender"})}),e.jsxs(Q,{children:[e.jsx(X,{children:"Atender Consulta"}),e.jsx(Ce,{children:"¿Desea atender esta consulta?"}),e.jsx("form",{onSubmit:t=>{t.preventDefault(),r.mutate()},className:"w-full",children:e.jsx(_,{disabled:r.isPending,loading:r.isPending,className:"w-full",children:"Atender Ahora"})}),e.jsx(Vo,{disabled:r.isPending,asChild:!0,children:e.jsx(E,{variant:"outline",children:"Cancelar"})})]})]})}const mt=h.object({country:h.string(),countryCode:h.number(),flag:h.string()}),xt=h.object({name:h.string({required_error:"Este campo es requerido"}).min(10,{message:"Ingrese un nombre válido"}).max(130,{message:"Nombre incorrecto"}),sex:h.enum(["MASCULINO","FEMENINO"],{required_error:"Este campo es requerido"}),nationality:mt,department:h.string({required_error:"Este campo es requerido"}),municipality:h.string({required_error:"Este campo es requerido"}),address:h.string({required_error:"Este campo es requerido"}).min(10,{message:"La dirección debe de tener al menos 10 caracteres"}),action:h.enum(["now","date"]).nullable(),date:h.date().refine(s=>{const a=new Date,r=new Date(s);a.setHours(0,0,0,0),r.setHours(0,0,0,0);const t=a.getFullYear()-r.getFullYear(),n=a.getMonth()-r.getMonth(),i=a.getDate()-r.getDate(),o=n>0||n===0&&i>=0?t:t-1;return r<=a&&o<=18},{message:"La fecha de nacimiento debe indicar que el paciente tiene 18 años o menos"})}),Bc=h.object({name:h.string({required_error:"Este campo es requerido"}).min(10,{message:"Ingrese un nombre válido"}).max(130,{message:"Nombre incorrecto"}),sex:h.enum(["MASCULINO","FEMENINO"],{required_error:"Este campo es requerido"}),nationality:mt,department:h.string({required_error:"Este campo es requerido"}),municipality:h.string({required_error:"Este campo es requerido"}),address:h.string({required_error:"Este campo es requerido"}).min(10,{message:"La dirección debe de tener al menos 10 caracteres"}),action:h.enum(["now","date"]).nullable(),date:h.date({required_error:"Este campo es requerido"}).refine(s=>{const a=new Date;a.setHours(0,0,0,0);const r=new Date(a);return r.setFullYear(a.getFullYear()-16),s<=r},{message:"Debe tener al menos 16 años"}),phone:h.string().min(8,{message:"El número debe de tener al menos 8 caracteres"}).max(8,{message:"El número debe de tener 8 caracteres como máximo"}).optional().nullable(),Dni:h.string().length(16,"Complete la Cédula").refine(s=>/^[A-Za-z]$/.test(s[s.length-1]),{message:"El último carácter debe ser una letra"}).optional().nullable(),foreign:h.string().optional().nullable(),dateDni:h.date().optional().nullable()}),Uc=h.object({phones:h.array(h.string()).min(1,{message:"Mínimo 1"}),sms:h.string().min(4,{message:"Mínimo 4 caracteres"})}),hs=x.forwardRef(({className:s,...a},r)=>e.jsx(cn,{ref:r,className:F("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(Gi,{className:F("flex items-center justify-center text-current"),children:e.jsx(gs,{className:"h-4 w-4"})})}));hs.displayName=cn.displayName;async function Qc(s){const r=await(await D.patients.sms.$get({query:{id:s}})).json();if(!r.success)throw new Error("Error al cargar los datos del paciente");return r.data}function Pa({id:s}){const[a,r]=x.useState(!1),{data:t}=T({queryKey:["sessionService"],queryFn:async()=>(await(await D.auth.whatsapp.$get()).json()).data,staleTime:1e3*60*20,enabled:a}),{isLoading:n,error:i,data:l}=T({queryKey:["infoPatient",s],queryFn:()=>Qc(s),enabled:a}),o=J({resolver:W(Uc),defaultValues:{sms:"",phones:[]}}),d=Fr({data:l||[],columns:[{id:"select",cell:({row:j})=>e.jsx(hs,{checked:o.watch("phones").includes(j.original.phone),onCheckedChange:p=>{const f=j.original,N=o.watch("phones");f.phone?p?N.includes(f.phone)||o.setValue("phones",[...N,f.phone]):o.setValue("phones",N.filter(q=>q!==f.phone)):j.toggleSelected(!1)},"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Nombre",cell:({row:j})=>{const p=j.original;return e.jsx("p",{className:p.isPatient?"font-bold":"",children:p.name})}},{accessorKey:"phone",header:"Teléfono",cell:({row:j})=>{const p=j.original;return e.jsx("p",{children:ls(p.phone)})}}],getCoreRowModel:Rr()}),u=$({mutationFn:async j=>{try{const f=await(await fetch(`${Ns}/send`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(j)})).json();f.success?P.success("Mensaje enviado correctamente"):P.error(f.error||"Error al cerrar la sesión")}catch(p){console.error("Error al realizar la solicitud:",p),P.error("No se pudo realizar la solicitud. Debe iniciar sesión.")}}}),m=j=>{u.mutate(j)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",children:e.jsx(Bi,{})})})}),e.jsx(V,{children:"Enviar un mensaje"})]})}),e.jsxs(Q,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Enviar mensajes por WhatsApp"}),e.jsx(Kn,{param:"sms"})]})}),e.jsx(Ce,{children:"Puedes enviar un mensaje al paciente o a uno de sus familiares"}),e.jsxs("pre",{children:[n&&"Cargando...",i&&"Error al cargar la información"]}),l&&e.jsx(ee,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(m),children:[e.jsx(w,{control:o.control,name:"phones",render:()=>{var j;return e.jsxs(b,{children:[e.jsx(y,{children:"Selecciona:"}),e.jsx(v,{children:e.jsxs(Re,{children:[e.jsx(Me,{children:d.getHeaderGroups().map(p=>e.jsx(le,{children:p.headers.map(f=>e.jsx(ae,{children:f.isPlaceholder?null:aa(f.column.columnDef.header,f.getContext())},f.id))},p.id))}),e.jsx(Te,{children:(j=d.getRowModel().rows)!=null&&j.length?d.getRowModel().rows.map(p=>e.jsx(le,{"data-state":p.getIsSelected()&&"selected",children:p.getVisibleCells().map(f=>e.jsx(z,{children:aa(f.column.columnDef.cell,f.getContext())},f.id))},p.id)):e.jsx(le,{children:e.jsx(z,{colSpan:2,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(C,{})]})}}),e.jsxs("div",{className:"my-2",children:[e.jsx(w,{control:o.control,name:"sms",render:({field:j})=>e.jsxs(b,{children:[e.jsx(y,{children:"Mensaje"}),e.jsx(v,{children:e.jsx(I,{onChange:j.onChange,value:j.value,type:"text"})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:u.isPending,children:"Enviar"})})]})]})})]})]})}function Yc(){const{data:s,isLoading:a,isError:r}=T({queryKey:["upcomingDates"],queryFn:async()=>(await(await D.dates.current.$get()).json()).data}),[t,n]=x.useState(""),i=s?s.filter(o=>o.patient.toLowerCase().includes(t.toLowerCase())):[],l=s?s.length:0;return e.jsxs("div",{className:" p-4  ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Citas para hoy (",l,"):"]}),e.jsx(I,{placeholder:"Buscar...",value:t,onChange:o=>n(o.target.value),className:"max-w-xs"})]}),e.jsxs("div",{className:"",children:[a&&e.jsx("div",{children:"Cargando..."}),r&&e.jsx("div",{children:"Ocurrió un error al cargar los datos."}),s&&e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Paciente"}),e.jsx(ae,{children:"Hora"})]})}),e.jsx(Te,{children:i.map(o=>e.jsxs(le,{children:[e.jsx(z,{children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"font-medium",children:o.patient})})})}),e.jsxs(z,{children:[Y(new Date(o.start),"hh:mm a")," -"," ",Y(new Date(o.end),"hh:mm a")]}),e.jsx(z,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Pa,{id:o.patientId})})}),e.jsx(z,{children:e.jsx(Ls,{id:o.id})})]},o.id))})]})]})]})}const Wc=ca("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ge({className:s,variant:a,...r}){return e.jsx("div",{className:F(Wc({variant:a}),s),...r})}function Jc(){const{data:s,isPending:a}=T({queryKey:["process"],queryFn:async()=>(await(await D.flows.process.$get()).json()).data});return e.jsxs("div",{className:" p-4  ",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Consultas en proceso:"})}),e.jsxs("div",{className:"",children:[a&&e.jsx("div",{children:"Cargando..."}),e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Paciente"}),e.jsx(ae,{children:"Emergencia"})]})}),e.jsxs(Te,{children:[s&&s.length>0&&s.map(r=>e.jsxs(le,{children:[e.jsx(z,{children:r.patientName}),e.jsx(z,{children:r.emergency?e.jsx(Ge,{variant:"destructive",children:"Emergencia"}):""}),e.jsx(z,{children:e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{variant:"outline",size:"icon",children:e.jsx(qe,{to:`/doctor/queries?querieId=${r.id}`,children:e.jsx(wl,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Continuar con la consulta"})]})})})]},r.id)),s&&s.length===0&&e.jsx(le,{children:e.jsx(z,{colSpan:2,children:"No hay consultas en proceso"})})]})]})]})]})}const Zc=h.object({amount:h.number({invalid_type_error:"Ingresa un valor",required_error:"Este campo es requerido"}).positive("No se aceptan valores negativos").min(10,"Agrega al menos C$ 10.00")}),Xc=h.object({rate:h.number({invalid_type_error:"Ingresa un valor",required_error:"Este campo es requerido"}).positive().min(35)});function Aa({current:s,isManagement:a}){const r=O(),[t,n]=x.useState(!1),i=J({resolver:W(Xc),defaultValues:{rate:s??0}}),l=$({mutationFn:async c=>{if(c.rate===s){P.error("La tasa de cambio no puede ser la misma que la actual");return}const u=await(await D.services.rate.$patch({json:c})).json();return u.success===!1&&P.error("Error al actualizar la tasa de cambio"),P.success("Tasa de cambio actualizada correctamente"),r.invalidateQueries({queryKey:["money"]}),r.invalidateQueries({queryKey:["chargeDocRate"]}),r.invalidateQueries({queryKey:["endQueryRate"]}),n(!1),u}}),o=c=>{l.mutate(c)};return e.jsxs(Z,{open:t,onOpenChange:n,children:[a?e.jsx(U,{asChild:!0,children:e.jsxs(E,{className:"w-full justify-start text-primary hover:text-primary hover:bg-primary/10 transition-colors",variant:"ghost",children:[e.jsx(br,{className:"mr-2 h-4 w-4"}),"Tasa de cambio"]})}):e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"outline",children:e.jsx(br,{})})})}),e.jsx(V,{children:"Actualizar tasa de cambio"})]})}),e.jsxs(Q,{children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Actualizar Tasa de Cambio"}),e.jsx(Ce,{children:"Ingrese la nueva tasa de cambio. Esta tasa se utilizará para todas las conversiones futuras."})]}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),children:[e.jsxs("div",{className:"flex gap-4 ",children:[e.jsxs(b,{children:[e.jsx(y,{htmlFor:"current",children:"Tasa de cambio Actual"}),e.jsx(I,{className:"border-none",id:"current",value:s,readOnly:!0})]}),e.jsx(w,{control:i.control,name:"rate",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"rate",children:"Nueva tasa de cambio"}),e.jsx(v,{children:e.jsx(I,{type:"number",value:c.value??0,onChange:d=>{const u=parseFloat(d.target.value)??0;c.onChange(u)},placeholder:"Tasa de cambio",className:"w-full"})}),e.jsx(C,{})]})})]}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:l.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function L(s){return new Intl.NumberFormat("es-NI",{style:"currency",currency:"NIO",minimumFractionDigits:2,maximumFractionDigits:2}).format(s).replace("NIO","").trim()}function Ne(s){return new Intl.NumberFormat("es-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(s).replace("USD","").trim()}function ht({querieId:s,patientName:a,price:r}){const t=O(),n=_e(),[i,l]=x.useState(!1),{data:o,isPending:c}=T({queryKey:["chargeDocRate"],queryFn:async()=>(await(await D.services.rate.$get()).json()).data}),d=h.object({price:h.number().min(200,"El precio debe ser mayor o igual a C$ 200.00"),chargePersonally:h.boolean(),paymentMethod:h.enum(["cash","transfer"]).nullable(),bankAccountId:h.string().optional(),cordobasReceived:h.number().nullable(),dollarsReceived:h.number().nullable(),availableCordobas:h.number().min(0,"Córdobas disponibles no puede ser negativo"),exchangeRate:h.number()}).refine(S=>S.chargePersonally?!!S.paymentMethod:!0,{message:"Debe seleccionar un método de pago si cobra personalmente",path:["paymentMethod"]}).refine(S=>S.chargePersonally&&S.paymentMethod==="transfer"?!!S.bankAccountId:!0,{message:"Debe seleccionar una cuenta bancaria para transferencias",path:["bankAccountId"]}).refine(S=>S.chargePersonally&&S.paymentMethod==="cash"?(S.cordobasReceived??0)+(S.dollarsReceived??0)*S.exchangeRate>=S.price:!0,{message:"Monto Insuficiente, el total debe ser igual o mayor que el precio",path:["cordobasReceived"]}).refine(S=>S.chargePersonally&&S.paymentMethod==="cash"?(S.cordobasReceived??0)+(S.dollarsReceived??0)*S.exchangeRate-S.price<=S.availableCordobas:!0,{message:"No hay suficiente efectivo en córdobas para dar el cambio",path:["cordobasReceived"]}),u=J({resolver:W(d),mode:"onChange",defaultValues:{price:r,chargePersonally:!0,paymentMethod:"cash",cordobasReceived:null,dollarsReceived:null,availableCordobas:0,exchangeRate:0}}),m=u.watch("chargePersonally"),j=u.watch("paymentMethod"),p=u.watch("price");x.useEffect(()=>{m?j===null&&u.setValue("paymentMethod","cash"):(u.setValue("paymentMethod",null),u.setValue("bankAccountId",void 0),u.setValue("cordobasReceived",null),u.setValue("dollarsReceived",null)),u.trigger(["paymentMethod","bankAccountId","cordobasReceived","dollarsReceived"])},[m,j,u]),x.useEffect(()=>{j!=="cash"&&(u.setValue("cordobasReceived",null),u.setValue("dollarsReceived",null)),j!=="transfer"&&u.setValue("bankAccountId",void 0),u.trigger(["cordobasReceived","dollarsReceived","bankAccountId"])},[j,u]),x.useEffect(()=>{u.trigger("price")},[p,u]);const f=S=>{const M=S.target.value.replace(/[^0-9]/g,"");return M?parseInt(M,10):0},N=()=>{const S=u.watch("dollarsReceived")??0;return(u.watch("cordobasReceived")??0)+S*((o==null?void 0:o.rate)??1)},q=()=>{if(!m||j!=="cash")return null;const S=N();return Math.max(0,S-u.watch("price"))},A=()=>{if(!m||j!=="cash")return null;const S=u.watch("price"),M=N();return Math.max(0,S-M)},R=$({mutationFn:async S=>{const M=q(),He=await(await D.flows.charged[":querieId"].$patch({param:{querieId:s},json:{price:S.price,chargePersonally:S.chargePersonally,paymentMethod:S.paymentMethod,bankAccountId:S.bankAccountId??null,cordobas:S.chargePersonally&&S.paymentMethod==="cash"?S.cordobasReceived:null,dollars:S.chargePersonally&&S.paymentMethod==="cash"?S.dollarsReceived:null,change:S.chargePersonally&&S.paymentMethod==="cash"?M:null}})).json();He.success?(P.success("Consulta finalizada correctamente"),l(!1),t.invalidateQueries({queryKey:["recents"]}),t.invalidateQueries({queryKey:["process"]}),t.invalidateQueries({queryKey:["money"]}),t.invalidateQueries({queryKey:["earings"]}),n({to:"/doctor/upcoming"})):P.error(He.error)}}),{data:k}=T({queryKey:["myBanks"],queryFn:async()=>(await(await D.flows.bankaccounts.$get()).json()).data}),g=S=>{R.mutate(S)};return c?e.jsx("div",{children:"Cargando..."}):e.jsxs(Z,{open:i,onOpenChange:l,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{variant:"ghost",className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4"}),e.jsx("span",{children:"Cobrar"})]})}),e.jsx(Bs,{className:"bg-black/50"}),e.jsxs(Q,{className:"sm:max-w-[700px] max-h-[100vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Cobrar consulta"}),e.jsxs(Ce,{children:["Cobra el monto definido a: ",a,"."]})]}),e.jsx(ee,{...u,children:e.jsxs("form",{className:"space-y-4",onSubmit:u.handleSubmit(g),children:[e.jsx("div",{className:" gap-4",children:e.jsx(w,{control:u.control,name:"price",render:({field:S})=>e.jsxs(b,{children:[e.jsxs(y,{htmlFor:"price",children:["Costo: ",L(S.value)]}),e.jsx(C,{})]})})}),e.jsx(Ue,{children:u.watch("chargePersonally")&&e.jsxs(ue.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{control:u.control,name:"paymentMethod",render:({field:S})=>e.jsxs(b,{children:[e.jsx(y,{children:"Método de pago"}),e.jsxs(pe,{defaultValue:"cash",onValueChange:S.onChange,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{})})}),e.jsxs(xe,{children:[e.jsx(te,{value:"cash",children:"Efectivo"}),e.jsx(te,{value:"transfer",children:"Transferencia bancaria"})]})]}),e.jsx(C,{})]})}),u.watch("paymentMethod")==="transfer"&&e.jsx(w,{control:u.control,name:"bankAccountId",render:({field:S})=>e.jsxs(b,{children:[e.jsx(y,{children:"Banco"}),e.jsxs(pe,{onValueChange:S.onChange,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione el banco"})})}),e.jsx(xe,{children:k&&k.map(M=>e.jsx(te,{value:M.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:M.color}}),e.jsx("span",{className:"font-medium",children:M.name}),e.jsx(Ge,{className:"text-sm  font-bold ml-auto",children:M.currency==="cor"?"C$":"$"})]})},M.id))})]}),e.jsx(C,{})]})})]}),u.watch("paymentMethod")==="cash"&&e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 bg-secondary p-2 rounded-md",children:[e.jsxs("p",{className:"text-sm",children:["Tasa de cambio actual:",e.jsx("span",{className:"font-semibold ml-2",children:L((o==null?void 0:o.rate)??0)})]}),e.jsx(Aa,{current:(o==null?void 0:o.rate)??0})]}),e.jsxs("div",{className:"font-semibold bg-secondary p-2 rounded-md text-sm",children:["Córdobas disponibles:",e.jsx("span",{className:"ml-2",children:L(u.watch("availableCordobas"))})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:u.control,name:"cordobasReceived",render:({field:S})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"cordobasReceived",children:"Córdobas"}),e.jsx(v,{children:e.jsx(I,{id:"cordobasReceived",type:"text",inputMode:"numeric",value:S.value??"",onChange:M=>S.onChange(f(M)),className:"text-sm px-2"})}),e.jsx(C,{})]})}),e.jsx(w,{control:u.control,name:"dollarsReceived",render:({field:S})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"dollarsReceived",children:"Dólares"}),e.jsx(v,{children:e.jsx(I,{id:"dollarsReceived",type:"text",inputMode:"numeric",value:S.value??"",onChange:M=>S.onChange(f(M)),className:"text-sm px-2"})}),e.jsx(C,{})]})})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg flex flex-col justify-center items-center gap-4 bg-secondary",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Total recibido:"}),e.jsx("p",{className:"text-2xl font-bold",children:L(N())})]}),q()!==null&&q()>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Cambio:"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:L(q())})]}),A()!==null&&A()>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Por cobrar:"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:L(A())})]})]})]})]})}),e.jsx(oe,{children:e.jsx(_,{loading:R.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function ed(){const{data:s}=T({queryKey:["recents"],queryFn:async()=>(await(await D.flows.recent.$get()).json()).data});return e.jsxs("div",{className:" p-4  ",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Atendido recientemente:"})}),e.jsx("div",{className:"",children:e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Paciente"}),e.jsx(ae,{children:"Costo"}),e.jsx(ae,{children:"Cobrada"})]})}),e.jsxs(Te,{children:[s&&s.length>0&&s.map(a=>e.jsxs(le,{children:[e.jsx(z,{children:a.patientName}),e.jsx(z,{children:L(a.price??0)}),e.jsx(z,{children:a.pending?e.jsx(Ui,{className:"w-5 h-5 text-green-500"}):e.jsx(ht,{querieId:a.id,patientName:a.patientName,price:a.price??0})})]},a.id)),s&&s.length===0&&e.jsx(le,{children:e.jsx(z,{colSpan:2,children:"No hay consultas atendidas recientemente"})})]})]})})]})}function qr(s,a){return a?s.split(new RegExp(`(${a})`,"gi")).map((t,n)=>t.toLowerCase()===a.toLowerCase()?e.jsx("span",{className:"dark:text-blue-500 text-blue-800",children:t},n):t):s}function jt({onSelect:s,patient:a}){const[r,t]=x.useState(!1),[n,i]=x.useState(a||null),[l,o]=x.useState("");x.useEffect(()=>{i(a)},[a]);const{data:c=[],isFetching:d}=T({queryKey:["patients",l],queryFn:async()=>l===""?[]:(await(await D.patients.search.$get({query:{q:l}})).json()).data,staleTime:5*60*1e3}),u=a?[...c.filter(m=>m.id!==a.id),a]:c;return e.jsxs(Us,{open:r,onOpenChange:t,children:[e.jsx(Qs,{asChild:!0,children:e.jsxs(E,{variant:"outline",role:"combobox","aria-expanded":r,className:"w-full justify-between",children:[n?e.jsx("div",{className:"flex items-center",children:n==null?void 0:n.name}):"Buscar Paciente",e.jsx(Ua,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ms,{className:"w-full p-0",children:e.jsxs(ya,{children:[e.jsxs("div",{className:"m-3 flex items-center",children:[e.jsx(ln,{className:"h-5 w-5 mr-1"}),e.jsx(I,{placeholder:"Buscar",value:l,onChange:m=>o(m.target.value)})]}),e.jsxs(tr,{children:[d&&e.jsx("div",{className:"w-5 flex m-auto h-5",children:e.jsx(ia,{})}),e.jsx(ba,{children:"Sin resultados"}),e.jsx(va,{children:u.map(m=>e.jsxs(Na,{value:m.id,onSelect:()=>{i(m),s(m),t(!1)},children:[e.jsxs("div",{className:"w-full font-bold flex space-x-3 justify-between",children:[e.jsx("p",{children:qr(m.name,l)}),e.jsx("p",{children:qr(m.fileId,l)})]}),e.jsx(gs,{className:F("ml-auto h-4 w-4",(n==null?void 0:n.id)===m.id?"opacity-100":"opacity-0")})]},m.id))})]})]})})]})}function sd(){const s=O(),a=_e(),r=h.object({id:h.string({required_error:"Requerido"}),fileId:h.string({required_error:"Requerido"}),name:h.string({required_error:"Requerido"})}),t=J({resolver:W(r)}),n=l=>{i.mutate(l)},i=$({mutationFn:async l=>{const c=await(await D.queries.emergency[":patientId"].$post({param:{patientId:l.id}})).json();if(c.success)return s.invalidateQueries({queryKey:["listDates"]}),s.invalidateQueries({queryKey:["upcomingDates"]}),c.redirect&&a({to:`/doctor/queries/?querieId=${c.redirect}`}),c},onError:l=>{console.log(l.message)}});return e.jsxs(Z,{children:[e.jsx(U,{children:e.jsx(E,{children:"Emergencia"})}),e.jsxs(Q,{children:[e.jsx(X,{children:"Emergencia"}),e.jsx(Ce,{children:"Selecciona al paciente, para atenderlo de inmediato"}),e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(n),children:[e.jsx(w,{control:t.control,name:"id",render:()=>e.jsxs(b,{children:[e.jsx(y,{children:"Paciente:"}),e.jsx(v,{children:e.jsx(jt,{patient:null,onSelect:l=>{t.setValue("id",l.id),t.setValue("name",l.name),t.setValue("fileId",l.fileId)}})}),e.jsx(C,{})]})}),e.jsx(_,{type:"submit",className:"justify-end",children:"Atender Emergencia"})]})})]})]})}const ad=ce("/doctor/_doctor/upcoming")({component:()=>e.jsxs("div",{className:"p-8 space-y-5",children:[e.jsx("div",{className:"ml-4",children:e.jsx(sd,{})}),e.jsx(Yc,{}),e.jsx(Jc,{}),e.jsx(ed,{})]})});function rd({monto:s,querieId:a,patientName:r}){const t=O(),[n,i]=x.useState(!1),{data:l,isPending:o}=T({queryKey:["exchangeRate"],queryFn:async()=>(await(await D.services.rate.$get()).json()).data}),c=h.object({cordobasReceived:h.number({required_error:"Por favor, ingrese el monto en córdobas",invalid_type_error:"Por favor, ingrese un monto válido en córdobas"}).min(0,"El monto en córdobas no puede ser negativo").max(1e4,"Máximo C$10,000.00").default(0),dollarsReceived:h.number({required_error:"Por favor, ingrese el monto en dólares",invalid_type_error:"Por favor, ingrese un monto válido en dólares"}).min(0,"El monto en dólares no puede ser negativo").max(2e3,"Máximo $2,000.00").default(0),total:h.number({required_error:"Monto insuficiente",invalid_type_error:"Monto insuficiente"}).min(s,"El monto total debe ser igual o mayor al costo de la consulta").default(0)}),d=J({resolver:W(c),defaultValues:{cordobasReceived:0,dollarsReceived:0,total:0}}),u=R=>{const k=R.target.value.replace(/[^0-9]/g,"");return k?parseInt(k,10):0},m=()=>{const R=d.watch("dollarsReceived")??0;return(d.watch("cordobasReceived")??0)+R*((l==null?void 0:l.rate)??1)},j=()=>{const R=m();return Math.max(0,R-s)},p=()=>{const R=m();return Math.max(0,s-R)},f=l==null?void 0:l.cordobasA,N=()=>j()<=(f??0);x.useEffect(()=>{const R=m();d.setValue("total",R),d.trigger()},[d.watch("dollarsReceived"),d.watch("cordobasReceived"),l==null?void 0:l.rate]);const q=$({mutationFn:async R=>{const g=await(await D.flows.chargea[":querieId"].$patch({param:{querieId:a},json:{cordobas:R.cordobasReceived,dollars:R.dollarsReceived,change:j()}})).json();if(!g.success)throw new Error(g.error||"Error al guardar el registro");return g},onSuccess:()=>{P.success("Cobro realizado con éxito"),t.invalidateQueries({queryKey:["recents"]}),t.invalidateQueries({queryKey:["process"]}),t.invalidateQueries({queryKey:["money"]}),t.invalidateQueries({queryKey:["earings"]}),i(!1)},onError:R=>{P.error(R.message||"Error al realizar el cobro")}}),A=R=>{if(!N()){P.error("No hay suficiente efectivo para dar el cambio");return}q.mutate(R)};return o?e.jsx("div",{children:"Cargando..."}):e.jsxs(Z,{open:n,onOpenChange:i,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{variant:"ghost",className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4"}),e.jsx("span",{children:"Cobrar"})]})}),e.jsx(Bs,{className:"bg-black/50"}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsxs(ie,{children:[e.jsx(X,{className:"text-2xl font-bold",children:"Confirmar Cobro"}),e.jsxs(Ce,{className:"text-lg",children:["Paciente: ",e.jsx("span",{className:"font-medium",children:r})]})]}),e.jsx(ee,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(A),className:"space-y-4",children:[e.jsx("div",{className:"text-sm",children:e.jsxs("p",{children:["Tasa de cambio: ",L((l==null?void 0:l.rate)??0)]})}),e.jsx("div",{className:"text-lg",children:e.jsxs("p",{children:["Costo de la consulta:",e.jsx("span",{className:"font-semibold text-accent ml-2",children:L(s)})]})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:d.control,name:"cordobasReceived",render:({field:R})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"cordobasReceived",children:"Córdobas C$"}),e.jsx(v,{children:e.jsx(I,{id:"cordobasReceived",type:"text",inputMode:"numeric",value:R.value||"",onChange:k=>R.onChange(u(k)),className:"text-sm px-2"})}),e.jsx(C,{})]})}),e.jsx(w,{control:d.control,name:"dollarsReceived",render:({field:R})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"dollarsReceived",children:"Dólares $"}),e.jsx(v,{children:e.jsx(I,{id:"dollarsReceived",type:"text",inputMode:"numeric",value:R.value||"",onChange:k=>R.onChange(u(k)),className:"text-sm px-2"})}),e.jsx(C,{})]})})]}),e.jsx(Ue,{children:e.jsx(ue.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:e.jsxs("div",{className:"p-4 border rounded-lg w-full flex flex-col justify-center items-center gap-4 bg-secondary",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Total recibido:"}),e.jsx("p",{className:"text-2xl font-bold",children:L(m())})]}),j()>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Cambio:"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:L(j())})]}),p()>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Falta por pagar:"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:L(p())})]}),!N()&&e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm font-medium text-red-600",children:"No hay suficiente efectivo para dar el cambio"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sx font-medium",children:"Córdobas disponibles:"}),e.jsx("p",{className:"text-lg font-semibold",children:L(f??0)})]})]})})}),e.jsx(oe,{children:e.jsx(_,{loading:q.isPending,type:"submit",className:"w-full",disabled:!N(),children:"Confirmar"})})]})})]})]})}function pt({role:s}){const{data:a}=T({queryKey:["earings"],queryFn:async()=>(await(await D.flows.earrings.$get()).json()).data});return e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("div",{className:"w-full flex justify-between items-center",children:e.jsx("p",{className:"text-sm font-semibold",children:"Consultas que no han sido cobradas"})}),e.jsx("div",{children:e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Paciente"}),e.jsx(ae,{children:"Fecha"}),e.jsx(ae,{children:"Emergencia"}),e.jsx(ae,{children:"Monto"})]})}),e.jsx(Te,{children:!a||a.length===0?e.jsx(le,{children:e.jsx(z,{className:"text-center",colSpan:5,children:"No hay datos para mostrar..."})}):a.map((r,t)=>{const n=_s(r.date);return e.jsxs(le,{children:[e.jsx(z,{children:r.patientName}),e.jsx(z,{children:Y(n,"dd/MM/yyyy")}),e.jsx(z,{children:r.emergency?"Emergencia":""}),e.jsx(z,{children:e.jsx(Ge,{className:"bg-accent",children:r.price&&r.price.toFixed(2)+" C$"})}),e.jsx(z,{children:r.price&&e.jsx(e.Fragment,{children:s==="ASSISTANT"?e.jsx(rd,{querieId:r.id,monto:r.price,patientName:r.patientName}):e.jsx(ht,{querieId:r.id,price:r.price,patientName:r.patientName})})})]},t)})})]})})]})}function nd(){const{data:s}=T({queryKey:["collected"],queryFn:async()=>(await(await D.flows.collected.$get()).json()).data}),a=(s==null?void 0:s.reduce((r,t)=>r+(t.price??0),0))??0;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-full flex justify-between items-center",children:e.jsx("p",{className:"text-sm font-semibold",children:"Consultas recientes cobradas por mi asistente"})}),e.jsx("div",{children:e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Paciente"}),e.jsx(ae,{children:"Fecha"}),e.jsx(ae,{children:"Emergencia"}),e.jsx(ae,{children:"Monto"})]})}),e.jsx(Te,{children:!s||s.length===0?e.jsx(le,{children:e.jsx(z,{className:"text-center",colSpan:4,children:"No hay datos para mostrar..."})}):s.map(r=>{const t=_s(r.date);return e.jsxs(le,{children:[e.jsx(z,{children:r.patientName}),e.jsx(z,{children:Y(t,"dd/MM/yyyy")}),e.jsx(z,{children:r.emergency?"Emergencia":""}),e.jsx(z,{children:e.jsx(Ge,{variant:"secondary",children:r.price!==null?`C$ ${r.price.toFixed(2)}`:"N/A"})})]},r.id)})}),e.jsx(Sa,{children:e.jsxs(le,{children:[e.jsx(z,{colSpan:3,children:"Total"}),e.jsxs(z,{className:"text-left",children:["C$ ",a.toFixed(2)]})]})})]})})]})}function td({amount:s}){const a=O(),[r,t]=x.useState(!1),n=J({resolver:W(Zc),defaultValues:{amount:0}}),i=$({mutationFn:async o=>{if((await(await D.services.change.$patch({json:o})).json()).success)P.success("Registrado correctamente"),a.invalidateQueries({queryKey:["money"]});else throw new Error("Error al guardar el cambio");t(!1)},onError:o=>{P.error(o.message)}}),l=o=>{i.mutate(o)};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{className:"w-full justify-start text-primary hover:text-primary hover:bg-primary/10 transition-colors",variant:"ghost",children:[e.jsx(Qi,{className:"mr-2 h-4 w-4"}),"Entregar"]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsxs(ie,{children:[e.jsx(X,{className:"text-2xl font-bold text-center text-primary",children:"Entregar"}),e.jsx(Ce,{children:"Define el monto que deseas entregar a tu asistente"})]}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(l),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(b,{children:[e.jsx(y,{className:"text-sm font-medium",children:"Efectivo actual"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-primary h-4 w-4"}),e.jsx(I,{readOnly:!0,value:s.toFixed(2),disabled:i.isPending,className:"pl-10 pr-3 text-right font-semibold bg-primary/5"})]})}),e.jsx(C,{})]}),e.jsx(w,{control:n.control,name:"amount",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{className:"text-sm font-medium",children:"Efectivo a sumar"}),e.jsx(v,{children:e.jsxs("div",{className:"relative",children:[e.jsx(kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-primary h-4 w-4"}),e.jsx(I,{...o,disabled:i.isPending,value:o.value===0?"":o.value,onChange:c=>{const d=c.target.value;o.onChange(d===""?0:Number(d))},type:"number",step:"0.01",min:"0",placeholder:"0.00",className:"pl-10 pr-3 text-right font-semibold border-primary/20 focus:border-primary focus:ring-primary"})]})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"p-4 bg-primary/5 rounded-lg",children:[e.jsx("p",{className:"text-sm  font-medium mb-2",children:"Resumen de la transacción"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Nuevo total:"}),e.jsx("span",{className:"text-lg font-bold text-primary",children:L(s+(n.watch("amount")||0))})]})]}),e.jsx(oe,{children:e.jsx(_,{loading:i.isPending,type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:"Guardar Cambio"})})]})})]})]})}function kr(s){return e.jsxs("svg",{...s,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M21 6h-4a3 3 0 0 0 0 6h1a3 3 0 0 1 0 6h-4"}),e.jsx("path",{d:"M10 18h-1a6 6 0 1 1 0 -12h1"}),e.jsx("path",{d:"M17 20v-2"}),e.jsx("path",{d:"M18 6v-2"})]})}const id=h.object({totalCordobas:h.number().default(0),totalDolares:h.number().default(0),faltanteC:h.number().default(0),sobranteC:h.number().default(0),faltanteD:h.number().default(0),sobranteD:h.number().default(0),c050:h.number().int().max(500,"Máximo 500").default(0),c1:h.number().int().max(500,"Máximo 500").default(0),c5:h.number().int().max(500,"Máximo 500").default(0),c10:h.number().int().max(500,"Máximo 500").default(0),c20:h.number().int().max(500,"Máximo 500").default(0),c50:h.number().int().max(400,"Máximo 400").default(0),c100:h.number().int().max(400,"Máximo 400").default(0),c200:h.number().int().max(300,"Máximo 300").default(0),c500:h.number().int().max(200,"Máximo 200").default(0),c1000:h.number().int().max(100,"Máximo 100").default(0),d1:h.number().int().max(100,"Máximo 100").default(0),d5:h.number().int().max(75,"Máximo 75").default(0),d10:h.number().int().max(50,"Máximo 50").default(0),d20:h.number().int().max(45,"Máximo 45").default(0),d50:h.number().int().max(25,"Máximo 25").default(0),d100:h.number().int().max(20,"Máximo 20").default(0)});function ld({cordobas:s,dolares:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(id),defaultValues:{totalCordobas:0,totalDolares:0,c050:0,c1:0,c5:0,c10:0,c20:0,c50:0,c100:0,c200:0,c500:0,c1000:0,d1:0,d5:0,d10:0,d20:0,d50:0,d100:0}}),l=()=>{const m={c050:i.watch("c050")*.5,c1:i.watch("c1")*1,c5:i.watch("c5")*5,c10:i.watch("c10")*10,c20:i.watch("c20")*20,c50:i.watch("c50")*50,c100:i.watch("c100")*100,c200:i.watch("c200")*200,c500:i.watch("c500")*500,c1000:i.watch("c1000")*1e3},j={d1:i.watch("d1")*1,d5:i.watch("d5")*5,d10:i.watch("d10")*10,d20:i.watch("d20")*20,d50:i.watch("d50")*50,d100:i.watch("d100")*100},p=Object.values(m).reduce((N,q)=>N+q,0),f=Object.values(j).reduce((N,q)=>N+q,0);i.setValue("totalCordobas",isNaN(p)?0:p),i.setValue("totalDolares",isNaN(f)?0:f)},o=()=>{const m=i.watch("totalCordobas")??0,j=i.watch("totalDolares")??0;i.setValue("faltanteC",m<s?s-m:0),i.setValue("sobranteC",m>s?m-s:0),i.setValue("faltanteD",j<a?a-j:0),i.setValue("sobranteD",j>a?j-a:0)},c=$({mutationFn:async()=>{const j=await(await D.services.conciliation.$patch({json:{cordobas:i.watch("totalCordobas"),dolares:i.watch("totalDolares"),sobranteC:i.watch("sobranteC")??0,faltanteC:i.watch("faltanteC")??0,sobranteD:i.watch("sobranteD")??0,faltanteD:i.watch("faltanteD")??0}})).json();j.success?(P.success("Caja arqueada con éxito"),n.invalidateQueries({queryKey:["money"]}),n.invalidateQueries({queryKey:["conciliaciones"]}),t(!1)):P.error(j.error)}}),d=()=>{c.mutate()};x.useEffect(()=>{l(),o()},[i.watch()]);const u=m=>{const j=m.target.value;if(/^\d*$/.test(j))return i.trigger(),parseInt(j)||0};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{className:"w-full justify-start text-primary hover:text-primary hover:bg-primary/10 transition-colors",variant:"ghost",children:[e.jsx(Yi,{className:"mr-2 h-4 w-4"}),"Arqueo"]})}),e.jsxs(Q,{className:"sm:max-w-[900px] w-11/12 max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(X,{className:"text-2xl font-bold",children:"Arqueo"}),e.jsx(Ce,{children:"Verifica la cantidad de dinero recaudado por tu asistente"})]}),e.jsxs("div",{className:"flex sm:space-x-5 space-x-3 bg-primary/5 p-4 rounded-sm",children:[e.jsxs("p",{children:["Córdobas:"," ",e.jsx("span",{className:"font-semibold",children:L(s)})]}),e.jsxs("p",{children:["Dólares:"," ",e.jsx("span",{className:"font-semibold",children:Ne(a)})]})]}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(d),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border p-4 rounded-sm space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Córdobas"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-5 gap-2",children:[{name:"c050",label:"0.50"},{name:"c1",label:"1"},{name:"c5",label:"5"},{name:"c10",label:"10"},{name:"c20",label:"20"},{name:"c50",label:"50"},{name:"c100",label:"100"},{name:"c200",label:"200"},{name:"c500",label:"500"},{name:"c1000",label:"1000"}].map(({name:m,label:j})=>e.jsx(w,{control:i.control,name:m,render:({field:p})=>e.jsxs(b,{children:[e.jsxs(y,{children:["C$ ",j]}),e.jsx(v,{children:e.jsx(I,{type:"text",inputMode:"numeric",pattern:"\\d*",...p,onChange:f=>p.onChange(u(f)),className:"text-sm"})}),e.jsx(C,{})]})},m))})]}),e.jsxs("div",{className:"border p-4 rounded-sm space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Dólares"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:["d1","d5","d10","d20","d50","d100"].map(m=>e.jsx(w,{control:i.control,name:m,render:({field:j})=>e.jsxs(b,{children:[e.jsxs(y,{children:["$ ",m.slice(1)]}),e.jsx(v,{children:e.jsx(I,{type:"text",inputMode:"numeric",pattern:"\\d*",...j,onChange:p=>j.onChange(u(p)),className:"text-sm"})}),e.jsx(C,{})]})},m))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Córdobas:"}),e.jsx("span",{className:"text-lg font-semibold",children:L(i.watch("totalCordobas"))})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Faltante:"}),e.jsx("span",{children:L(i.watch("faltanteC"))})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Sobrante:"}),e.jsx("span",{children:L(i.watch("sobranteC"))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Dólares:"}),e.jsx("span",{className:"text-lg font-semibold",children:Ne(i.watch("totalDolares"))})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Faltante:"}),e.jsx("span",{children:Ne(i.watch("faltanteD"))})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:"Sobrante:"}),e.jsx("span",{children:Ne(i.watch("sobranteD"))})]})]})]}),e.jsx(oe,{children:e.jsx(_,{type:"submit",className:"w-1/4",children:"Confirmar"})})]})})]})]})}function od({money:s}){const a=[{title:"Córdobas",value:L((s==null?void 0:s.cordobasA)??0),actionComponent:e.jsx(td,{amount:(s==null?void 0:s.cordobasA)??0})},{title:"Dólares",value:Ne((s==null?void 0:s.dollarsA)??0),actionComponent:e.jsx(Aa,{current:(s==null?void 0:s.rate)??0,isManagement:!0})},{title:"Efectivo total",value:L((s==null?void 0:s.totalA)??0),actionComponent:e.jsx(ld,{cordobas:(s==null?void 0:s.cordobasA)??0,dolares:(s==null?void 0:s.dollarsA)??0})},{title:"Gastos del día",value:L((s==null?void 0:s.assitantExpenses)??0),actionComponent:e.jsx(qe,{to:"/doctor/expenses",className:"w-full",children:e.jsxs(E,{className:"w-full justify-start text-primary hover:text-primary hover:bg-primary/10 transition-colors",variant:"ghost",children:[e.jsx(gn,{className:"mr-2 h-4 w-4"}),"Ver detalle"]})})}];return e.jsxs("div",{className:"container mx-auto px-4 ",children:[e.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:a.map((r,t)=>e.jsx(ft,{item:r,index:t},r.title))}),e.jsx("div",{className:"sm:mt-5 mt-3",children:e.jsx(nd,{})})]})}function cd({money:s}){const a=[{title:"Córdobas",value:L((s==null?void 0:s.cordobas)??0),actionComponent:""},{title:"Dólares",value:Ne((s==null?void 0:s.dollars)??0),actionComponent:e.jsx(Aa,{current:(s==null?void 0:s.rate)??0,isManagement:!0})},{title:"Efectivo total",value:L((s==null?void 0:s.total)??0),actionComponent:""},{title:"Gastos del día",value:L((s==null?void 0:s.doctorExpenses)??0),actionComponent:e.jsx(qe,{to:"/doctor/expenses",className:"w-full",children:e.jsxs(E,{className:"w-full justify-start text-primary hover:text-primary hover:bg-primary/10 transition-colors",variant:"ghost",children:[e.jsx(gn,{className:"mr-2 h-4 w-4"}),"Ver detalle"]})})}];return e.jsx("div",{className:"container mx-auto px-4 ",children:e.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:a.map((r,t)=>e.jsx(ft,{item:r,index:t},r.title))})})}const dd={initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5}};function ft({item:s,index:a}){return e.jsx(ue.div,{...dd,transition:{delay:a*.1},children:e.jsxs(ge,{className:"h-full sm:p-3 p-2 flex flex-col",children:[e.jsxs(ve,{className:"p-0 flex-grow",children:[e.jsx(we,{className:"text-sm font-medium text-muted-foreground",children:s.title}),s.value!==void 0?e.jsx("p",{className:"text-lg font-bold text-primary",children:s.value}):e.jsx("p",{className:"text-xl font-bold text-muted-foreground"})]}),s.actionComponent&&e.jsx(Zn,{className:"p-0",children:s.actionComponent})]})})}const ud={light:"",dark:".dark"},gt=x.createContext(null);function yt(){const s=x.useContext(gt);if(!s)throw new Error("useChart must be used within a <ChartContainer />");return s}const cr=x.forwardRef(({id:s,className:a,children:r,config:t,...n},i)=>{const l=x.useId(),o=`chart-${s||l.replace(/:/g,"")}`;return e.jsx(gt.Provider,{value:{config:t},children:e.jsxs("div",{"data-chart":o,ref:i,className:F("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",a),...n,children:[e.jsx(md,{id:o,config:t}),e.jsx(Pn,{children:r})]})})});cr.displayName="Chart";const md=({id:s,config:a})=>{const r=Object.entries(a).filter(([t,n])=>n.theme||n.color);return r.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(ud).map(([t,n])=>`
${n} [data-chart=${s}] {
${r.map(([i,l])=>{var c;const o=((c=l.theme)==null?void 0:c[t])||l.color;return o?`  --color-${i}: ${o};`:null}).join(`
`)}
}
`).join(`
`)}}):null},bt=Wl,dr=x.forwardRef(({active:s,payload:a,className:r,indicator:t="dot",hideLabel:n=!1,hideIndicator:i=!1,label:l,labelFormatter:o,labelClassName:c,formatter:d,color:u,nameKey:m,labelKey:j},p)=>{const{config:f}=yt(),N=x.useMemo(()=>{var S;if(n||!(a!=null&&a.length))return null;const[A]=a,R=`${j||A.dataKey||A.name||"value"}`,k=$a(f,A,R),g=!j&&typeof l=="string"?((S=f[l])==null?void 0:S.label)||l:k==null?void 0:k.label;return o?e.jsx("div",{className:F("font-medium",c),children:o(g,a)}):g?e.jsx("div",{className:F("font-medium",c),children:g}):null},[l,o,a,n,c,f,j]);if(!s||!(a!=null&&a.length))return null;const q=a.length===1&&t!=="dot";return e.jsxs("div",{ref:p,className:F("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[q?null:N,e.jsx("div",{className:"grid gap-1.5",children:a.map((A,R)=>{const k=`${m||A.name||A.dataKey||"value"}`,g=$a(f,A,k),S=u||A.payload.fill||A.color;return e.jsx("div",{className:F("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",t==="dot"&&"items-center"),children:d&&(A==null?void 0:A.value)!==void 0&&A.name?d(A.value,A.name,A,R,A.payload):e.jsxs(e.Fragment,{children:[g!=null&&g.icon?e.jsx(g.icon,{}):!i&&e.jsx("div",{className:F("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":t==="dot","w-1":t==="line","w-0 border-[1.5px] border-dashed bg-transparent":t==="dashed","my-0.5":q&&t==="dashed"}),style:{"--color-bg":S,"--color-border":S}}),e.jsxs("div",{className:F("flex flex-1 justify-between leading-none",q?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[q?N:null,e.jsx("span",{className:"text-muted-foreground",children:(g==null?void 0:g.label)||A.name})]}),A.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:A.value.toLocaleString()})]})]})},A.dataKey)})})]})});dr.displayName="ChartTooltip";const xd=x.forwardRef(({className:s,hideIcon:a=!1,payload:r,verticalAlign:t="bottom",nameKey:n},i)=>{const{config:l}=yt();return r!=null&&r.length?e.jsx("div",{ref:i,className:F("flex items-center justify-center gap-4",t==="top"?"pb-3":"pt-3",s),children:r.map(o=>{const c=`${n||o.dataKey||"value"}`,d=$a(l,o,c);return e.jsxs("div",{className:F("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[d!=null&&d.icon&&!a?e.jsx(d.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:o.color}}),d==null?void 0:d.label]},o.value)})}):null});xd.displayName="ChartLegend";function $a(s,a,r){if(typeof a!="object"||a===null)return;const t="payload"in a&&typeof a.payload=="object"&&a.payload!==null?a.payload:void 0;let n=r;return r in a&&typeof a[r]=="string"?n=a[r]:t&&r in t&&typeof t[r]=="string"&&(n=t[r]),n in s?s[n]:s[r]}function vt({className:s,classNames:a,showOutsideDays:r=!0,...t}){return e.jsx(In,{showOutsideDays:r,className:F("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:F(Ps({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:F("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",t.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:F(Ps({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50  aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({...n})=>e.jsx(dn,{className:"h-4 w-4"}),IconRight:({...n})=>e.jsx(un,{className:"h-4 w-4"})},...t})}vt.displayName="Calendar";function Nt({className:s,dateRange:a,onDateRangeChange:r}){const[t,n]=x.useState(a),[i,l]=x.useState(t),[o,c]=x.useState(!1);x.useEffect(()=>{a&&n(a)},[a]);const d=j=>{l(j)},u=j=>{c(j)},m=()=>{i&&(n(i),r(i)),c(!1)};return x.useEffect(()=>{o&&l(t)},[o,t]),e.jsx("div",{className:F("grid gap-2",s),children:e.jsxs(Us,{open:o,onOpenChange:u,children:[e.jsx(Qs,{asChild:!0,children:e.jsxs(E,{id:"date",variant:"outline",className:F("w-auto justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(Cl,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[Y(t.from,"d 'de' MMMM, yyyy",{locale:ze})," ","-"," ",Y(t.to,"d 'de' MMMM, yyyy",{locale:ze})]}):Y(t.from,"d 'de' MMMM, yyyy",{locale:ze}):e.jsx("span",{children:"Seleccionar fechas"})]})}),e.jsxs(Ms,{className:"w-auto p-0",align:"start",children:[e.jsx(vt,{initialFocus:!0,mode:"range",weekStartsOn:0,defaultMonth:(t==null?void 0:t.from)||new Date,selected:i,onSelect:d,numberOfMonths:1,locale:ze}),e.jsx("div",{className:"flex justify-end p-2",children:e.jsxs(E,{size:"sm",className:"ml-auto",onClick:m,children:[e.jsx(Sl,{className:"mr-2 h-4 w-4"}),"Aceptar"]})})]})]})})}const wt=new Date;wt.setHours(23,59,59,999);const hd=h.object({from:h.date().max(new Date,{message:"La fecha de inicio no puede estar en el futuro."}),to:h.date().max(wt,{message:"La fecha de finalización no puede estar en el futuro."})}),jd={queryCount:{label:"Atendidas",color:"hsl(var(--accent))"}};function pd(){const[s,a]=x.useState({from:xa(new Date,7),to:new Date}),[r,t]=x.useState(null),{data:n,isLoading:i,isError:l,error:o,refetch:c}=T({queryKey:["weekQueries",s==null?void 0:s.from,s==null?void 0:s.to],queryFn:async()=>{var p;if(!(s!=null&&s.from)||!(s!=null&&s.to))return[];const u=hd.safeParse(s);if(!u.success)return t(u.error.errors[0].message),[];const j=await(await D.charts.range.$get({query:{from:Y(s.from,"yyyy-MM-dd"),to:Y(s.to,"yyyy-MM-dd")}})).json();return console.log(j),((p=j.data)==null?void 0:p.map(f=>({date:Y(_s(f.date),"yyyy-MM-dd"),queryCount:f.queryCount})))||[]},enabled:!!(s!=null&&s.from)&&!!(s!=null&&s.to)}),d=u=>{a(u),t(null),c()};return i?e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{className:"h-8 w-64"}),e.jsx(se,{className:"h-[300px] w-full"})]}):e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsx("div",{className:"flex flex-col sm:flex-row w-full items-start sm:items-center justify-between gap-4",children:e.jsx("div",{className:"w-full sm:w-auto",children:e.jsx(Nt,{dateRange:s,onDateRangeChange:d})})}),r?e.jsx("div",{className:"text-destructive",children:r}):l?e.jsxs("div",{className:"text-destructive",children:["Hubo un error al cargar los datos: ",o.message,". Por favor, intenta nuevamente."]}):e.jsx("div",{className:"h-[50px] w-full",children:n&&n.length>0?e.jsx(cr,{className:"w-full h-full",config:jd,children:e.jsxs(An,{accessibilityLayer:!0,data:n,layout:"vertical",margin:{right:16},children:[e.jsx(En,{horizontal:!1}),e.jsx(qn,{dataKey:"date",type:"category",tickLine:!1,tickMargin:10,axisLine:!1,hide:!0}),e.jsx(kn,{dataKey:"queryCount",type:"number",hide:!0}),e.jsx(bt,{cursor:!1,content:e.jsx(dr,{className:"",indicator:"line"})}),e.jsxs(Dn,{dataKey:"queryCount",layout:"vertical",fill:"hsl(var(--accent))",radius:4,barSize:24,children:[e.jsx(Ra,{dataKey:"date",position:"insideLeft",offset:8,className:"fill-[--color-label]",fontSize:12}),e.jsx(Ra,{dataKey:"queryCount",position:"right",offset:8,className:"fill-foreground",fontSize:12})]})]})}):e.jsx("div",{className:"text-gray-500",children:"No hay datos para mostrar en el rango seleccionado."})})]})}function fd(){return e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 ",children:e.jsx(pd,{})})})}function gd(s){return/^(0[0-9]|1[0-9]|2[0-3])$/.test(s)}function yd(s){return/^(0[1-9]|1[0-2])$/.test(s)}function bd(s){return/^[0-5][0-9]$/.test(s)}function Ea(s,{max:a,min:r=0,loop:t=!1}){let n=parseInt(s,10);return isNaN(n)?"00":(t?(n>a&&(n=r),n<r&&(n=a)):(n>a&&(n=a),n<r&&(n=r)),n.toString().padStart(2,"0"))}function Ct(s){return gd(s)?s:Ea(s,{max:23})}function St(s){return yd(s)?s:Ea(s,{min:1,max:12})}function la(s){return bd(s)?s:Ea(s,{max:59})}function ur(s,{min:a,max:r,step:t}){let n=parseInt(s,10);return isNaN(n)?"00":(n+=t,Ea(String(n),{min:a,max:r,loop:!0}))}function vd(s,a){return ur(s,{min:0,max:23,step:a})}function Nd(s,a){return ur(s,{min:1,max:12,step:a})}function Dr(s,a){return ur(s,{min:0,max:59,step:a})}function wd(s,a){const r=la(a);return s.setMinutes(parseInt(r,10)),s}function Cd(s,a){const r=la(a);return s.setSeconds(parseInt(r,10)),s}function Sd(s,a){const r=Ct(a);return s.setHours(parseInt(r,10)),s}function Pd(s,a,r){const t=parseInt(St(a),10),n=qd(t,r);return s.setHours(n),s}function za(s,a,r,t){switch(r){case"minutes":return wd(s,a);case"seconds":return Cd(s,a);case"hours":return Sd(s,a);case"12hours":return t?Pd(s,a,t):s;default:return s}}function Ad(s,a){if(!s)return"00";switch(a){case"minutes":return la(String(s.getMinutes()));case"seconds":return la(String(s.getSeconds()));case"hours":return Ct(String(s.getHours()));case"12hours":const r=Pt(s.getHours());return St(String(r));default:return"00"}}function Ed(s,a,r){switch(r){case"minutes":return Dr(s,a);case"seconds":return Dr(s,a);case"hours":return vd(s,a);case"12hours":return Nd(s,a);default:return"00"}}function qd(s,a){return a==="PM"?s<=11?s+12:s:a==="AM"&&s===12?0:s}function Pt(s){return s===0||s===12?"12":s>=22?`${s-12}`:s%12>9?`${s}`:`0${s%12}`}function kd(s){return Array.from({length:12},(a,r)=>({value:r,label:Y(new Date(2021,r),"MMMM",{locale:s})}))}function Dd(s,a=50){const r=new Date;return Array.from({length:a*2+1},(t,n)=>({value:r.getFullYear()-a+n,label:(r.getFullYear()-a+n).toString()}))}function At({className:s,classNames:a,showOutsideDays:r=!0,yearRange:t=50,...n}){const i=x.useMemo(()=>kd(n.locale||Fa),[]),l=x.useMemo(()=>Dd(n.locale||Fa,t),[]);return e.jsx(In,{showOutsideDays:r,className:F("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0 justify-center",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:F(Ps({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:F(Ps({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({...o})=>e.jsx(dn,{className:"h-4 w-4"}),IconRight:({...o})=>e.jsx(un,{className:"h-4 w-4"}),CaptionLabel:({displayMonth:o})=>e.jsxs("div",{className:"inline-flex gap-2",children:[e.jsxs(pe,{defaultValue:o.getMonth().toString(),onValueChange:c=>{var u;const d=new Date(o);d.setMonth(parseInt(c,10)),(u=n.onMonthChange)==null||u.call(n,d)},children:[e.jsx(me,{className:"w-fit border-none p-0 focus:bg-accent focus:text-accent-foreground",children:e.jsx(fe,{})}),e.jsx(xe,{children:i.map(c=>e.jsx(te,{value:c.value.toString(),children:c.label},c.value))})]}),e.jsxs(pe,{defaultValue:o.getFullYear().toString(),onValueChange:c=>{var u;const d=new Date(o);d.setFullYear(parseInt(c,10)),(u=n.onMonthChange)==null||u.call(n,d)},children:[e.jsx(me,{className:"w-fit border-none p-0 focus:bg-accent focus:text-accent-foreground",children:e.jsx(fe,{})}),e.jsx(xe,{children:l.map(c=>e.jsx(te,{value:c.value.toString(),children:c.label},c.value))})]})]})},...n})}At.displayName="Calendar";const Et=x.forwardRef(({period:s,setPeriod:a,date:r,onDateChange:t,onLeftFocus:n,onRightFocus:i},l)=>{const o=d=>{d.key==="ArrowRight"&&(i==null||i()),d.key==="ArrowLeft"&&(n==null||n())},c=d=>{if(a==null||a(d),r){const u=new Date(r),m=Pt(r.getHours());t==null||t(za(u,m.toString(),"12hours",s==="AM"?"PM":"AM"))}};return e.jsx("div",{className:"flex h-10 items-center",children:e.jsxs(pe,{defaultValue:s,onValueChange:d=>c(d),children:[e.jsx(me,{ref:l,className:"w-[65px] focus:bg-accent focus:text-accent-foreground",onKeyDown:o,children:e.jsx(fe,{})}),e.jsxs(xe,{children:[e.jsx(te,{value:"AM",children:"AM"}),e.jsx(te,{value:"PM",children:"PM"})]})]})})});Et.displayName="TimePeriodSelect";const sa=x.forwardRef(({className:s,type:a="tel",value:r,id:t,name:n,date:i=new Date(new Date().setHours(0,0,0,0)),onDateChange:l,onChange:o,onKeyDown:c,picker:d,period:u,onLeftFocus:m,onRightFocus:j,...p},f)=>{const[N,q]=x.useState(!1),[A,R]=x.useState("0");x.useEffect(()=>{if(N){const M=setTimeout(()=>{q(!1)},2e3);return()=>clearTimeout(M)}},[N]);const k=x.useMemo(()=>Ad(i,d),[i,d]),g=M=>d==="12hours"&&N&&k.slice(1,2)==="1"&&A==="0"?"0"+M:N?k.slice(1,2)+M:"0"+M,S=M=>{if(M.key!=="Tab"){if(M.preventDefault(),M.key==="ArrowRight"&&(j==null||j()),M.key==="ArrowLeft"&&(m==null||m()),["ArrowUp","ArrowDown"].includes(M.key)){const ne=M.key==="ArrowUp"?1:-1,He=Ed(k,ne,d);N&&q(!1);const $e=i?new Date(i):new Date;l==null||l(za($e,He,d,u))}if(M.key>="0"&&M.key<="9"){d==="12hours"&&R(M.key);const ne=g(M.key);N&&(j==null||j()),q($e=>!$e);const He=i?new Date(i):new Date;l==null||l(za(He,ne,d,u))}}};return e.jsx(I,{ref:f,id:t||d,name:n||d,className:F("w-[48px] text-center  text-base tabular-nums caret-transparent focus:bg-accent focus:text-accent-foreground [&::-webkit-inner-spin-button]:appearance-none",s),value:r||k,onChange:M=>{M.preventDefault(),o==null||o(M)},type:a,inputMode:"decimal",onKeyDown:M=>{c==null||c(M),S(M)},...p})});sa.displayName="TimePickerInput";const Vs=x.forwardRef(({date:s,onChange:a,hourCycle:r=24,granularity:t="second"},n)=>{const i=x.useRef(null),l=x.useRef(null),o=x.useRef(null),c=x.useRef(null),[d,u]=x.useState(s&&s.getHours()>=12?"PM":"AM");return x.useImperativeHandle(n,()=>({minuteRef:i.current,hourRef:l.current,secondRef:o.current,periodRef:c.current}),[i,l,o]),e.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[e.jsx(sa,{picker:r===24?"hours":"12hours",date:s,id:"datetime-picker-hour-input",onDateChange:a,ref:l,period:d,onRightFocus:()=>{var m;return(m=i.current)==null?void 0:m.focus()}}),(t==="minute"||t==="second")&&e.jsx(e.Fragment,{children:e.jsx(sa,{picker:"minutes",date:s,onDateChange:a,ref:i,onLeftFocus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},onRightFocus:()=>{var m;return(m=o.current)==null?void 0:m.focus()}})}),t==="second"&&e.jsx(e.Fragment,{children:e.jsx(sa,{picker:"seconds",date:s,onDateChange:a,ref:o,onLeftFocus:()=>{var m;return(m=i.current)==null?void 0:m.focus()},onRightFocus:()=>{var m;return(m=c.current)==null?void 0:m.focus()}})}),r===12&&e.jsx("div",{className:"grid gap-1 text-center",children:e.jsx(Et,{period:d,setPeriod:u,date:s,onDateChange:m=>{a==null||a(m),m&&(m==null?void 0:m.getHours())>=12?u("PM"):u("AM")},ref:c,onLeftFocus:()=>{var m;return(m=o.current)==null?void 0:m.focus()}})})]})});Vs.displayName="TimePicker";const Ys=x.forwardRef(({locale:s=Fa,value:a,onChange:r,hourCycle:t=24,yearRange:n=50,disabled:i=!1,displayFormat:l,granularity:o="second",placeholder:c="Pick a date",...d},u)=>{const[m,j]=x.useState(a??new Date),p=x.useRef(null),f=q=>{if(!q)return;if(!a){r==null||r(q),j(q);return}const R=(q.getTime()-a.getTime())/(1e3*60*60*24),k=Ql(a,{days:Math.ceil(R)});r==null||r(k),j(k)};x.useImperativeHandle(u,()=>({...p.current,value:a}),[a]);const N={hour24:(l==null?void 0:l.hour24)??"PPP HH:mm:ss",hour12:(l==null?void 0:l.hour12)??"PP hh:mm:ss b"};return e.jsxs(Us,{children:[e.jsx(Qs,{asChild:!0,disabled:i,children:e.jsxs(E,{variant:"outline",className:F("w-[200px] justify-start text-left font-normal",!a&&"text-muted-foreground"),ref:p,children:[e.jsx(Wi,{className:"mr-2 h-4 w-4"}),a?Y(a,t===24?N.hour24:N.hour12,{locale:s}):e.jsx("span",{children:c})]})}),e.jsxs(Ms,{className:"w-auto p-0",children:[e.jsx(At,{mode:"single",selected:a,month:m,onSelect:q=>f(q),onMonthChange:f,initialFocus:!0,yearRange:n,locale:s,...d}),o!=="day"&&e.jsx("div",{className:"border-t border-border p-3",children:e.jsx(Vs,{onChange:r,date:a,hourCycle:t,granularity:o})})]})]})});Ys.displayName="DateTimePicker";function Id(){const[s,a]=x.useState(new Date),{data:r,isLoading:t}=T({queryKey:["transactions",s==null?void 0:s.toISOString()],queryFn:async()=>(await(await D.flows.flowsbanks.$get({query:{dateParam:Y(s??new Date,"yyyy-MM-dd")}})).json()).data,enabled:!!s});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"w-full flex justify-between items-center",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Consultas pagadas por medio de transferencias o depósitos bancarios"}),e.jsx(Ys,{granularity:"day",locale:ze,weekStartsOn:0,displayFormat:{hour24:"dd/MM/yyyy"},onChange:n=>{n!==void 0&&a(n)},value:s})]}),e.jsxs("section",{className:"space-y-20",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold mt-6",children:"Transacciones"}),t?e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"})]}):e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Paciente"}),e.jsx(ae,{children:"Precio"}),e.jsx(ae,{children:"Cuenta Bancaria"}),e.jsx(ae,{children:"Moneda"}),e.jsx(ae,{children:"Total"}),e.jsx(ae,{children:"Fecha de Transacción"})]})}),e.jsx(Te,{children:r&&(r==null?void 0:r.listData.map(n=>e.jsxs(le,{children:[e.jsx(z,{children:n.patientName}),e.jsx(z,{children:L(n.price??0)}),e.jsx(z,{children:n.bankAccountName}),e.jsx(z,{children:n.bankCurrency==="cor"?e.jsx(Ge,{children:"Córdobas"}):e.jsx(Ge,{children:"Dólares"})}),e.jsx(z,{children:n.bankCurrency==="cor"?L(n.cordobas):Ne(n.dollars)}),e.jsx(z,{children:Y(new Date(n.transactionDate),"dd/MM/yyyy HH:mm",{locale:ze})})]},n.queryId)))})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold ",children:"Resumen"}),t?e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"})]}):e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{}),e.jsx(ae,{children:"Nombre de la Cuenta"}),e.jsx(ae,{children:"Moneda"}),e.jsx(ae,{children:"Total"}),e.jsx(ae,{children:"Cantidad de Transacciones"})]})}),e.jsx(Te,{children:r&&r.groupData.map(n=>e.jsxs(le,{children:[e.jsx(z,{className:"w-6",children:e.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:n.bankColor}})}),e.jsx(z,{children:n.bankAccountName}),e.jsx(z,{children:n.bankCurrency==="cor"?e.jsx(Ge,{children:"Córdobas"}):e.jsx(Ge,{children:"Dólares"})}),e.jsx(z,{children:n.bankCurrency==="cor"?L(n.totalCordobas):Ne(n.totalDollars)}),e.jsx(z,{children:n.count})]},n.bankAccountName))})]})]})]})]})}async function Fd(s,a,r){const t=new es;let n=0;n=await as(t,r,`Informe de ingresos ${Y(a.from,"dd/MM/yyyy")} - ${Y(a.to,"dd/MM/yyyy")}`);const i=s.map(c=>[c.date,c.patient,c.method===null?"Efectivo":"Transferencia",c.price?`${L(c.price)}`:""]),l=s.reduce((c,d)=>c+(d.price||0),0);re(t,{startY:n+10,head:[["Fecha","Paciente","Método de Pago","Monto"]],body:i,foot:[["","","Total",`${L(l)}`]],theme:"striped",footStyles:{fontStyle:"bold"},styles:{fontSize:11,cellPadding:2},columnStyles:{0:{cellWidth:25},1:{cellWidth:"auto"},3:{cellWidth:25},4:{cellWidth:25}}});const o=t.output("blob");return URL.createObjectURL(o)}function Rd({time:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(null),[i,l]=x.useState(!1),o=O(),{data:c,refetch:d,isLoading:u,isError:m}=T({queryKey:["pdfIncomes",s],queryFn:async()=>{if(!s.from||!s.to||!fs(s.from)||!fs(s.to))throw new Error("Fechas inválidas");const N=await(await D.pdf.incomes.$get({query:{from:Y(s.from,"yyyy-MM-dd"),to:Y(s.to,"yyyy-MM-dd")}})).json();if(!N.success)throw new Error("Error");return N.data},enabled:!1});x.useEffect(()=>{a&&(d(),o.prefetchQuery(Se))},[a,d]);const{data:j}=T(Se);x.useEffect(()=>{c&&j&&(l(!0),Fd(c,s,j).then(f=>{n(f),l(!1)}).catch(()=>{n(null),l(!1)}))},[c,j]);const p=()=>u||i?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):m?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):!c||!t?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:t,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsxs(E,{children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),"Detalle"]})})}),e.jsx(V,{children:"Generar documento PDF"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:p()})})]})}async function Md(s,a,r){const t=new es;let n=0;n=await as(t,r,`Informe  resumen de ingresos  ${Y(a.from,"dd/MM/yyyy")} - ${Y(a.to,"dd/MM/yyyy")}`);const i=s.map(d=>[d.date,d.totalCordobas?`${L(d.totalCordobas)}`:"",d.totalDollars?`${Ne(d.totalDollars)}`:""]),l=s.reduce((d,u)=>d+(u.totalCordobas||0),0),o=s.reduce((d,u)=>d+(u.totalDollars||0),0);re(t,{startY:n+10,head:[["Fecha","Córdobas","Dólares"]],body:i,foot:[["Total",`${L(l)}`,`${Ne(o)}`]],theme:"striped",footStyles:{fontStyle:"bold"},styles:{fontSize:11,cellPadding:2},columnStyles:{0:{cellWidth:25},1:{cellWidth:"auto"},2:{cellWidth:"auto"}}});const c=t.output("blob");return URL.createObjectURL(c)}function Td({time:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(null),[i,l]=x.useState(!1),o=O(),{data:c,refetch:d,isLoading:u,isError:m}=T({queryKey:["pdfIngresos",s],queryFn:async()=>{if(!s.from||!s.to||!fs(s.from)||!fs(s.to))throw new Error("Fechas inválidas");const N=await(await D.pdf.inco.$get({query:{from:Y(s.from,"yyyy-MM-dd"),to:Y(s.to,"yyyy-MM-dd")}})).json();if(!N.success)throw new Error("Error");return N.data},enabled:!1});x.useEffect(()=>{a&&(d(),o.prefetchQuery(Se))},[a,d]);const{data:j}=T(Se);x.useEffect(()=>{c&&j&&(l(!0),Md(c,s,j).then(f=>{n(f),l(!1)}).catch(()=>{n(null),l(!1)}))},[c,j]);const p=()=>u||i?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):m?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):!c||!t?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:t,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsxs(E,{children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),"Resumen"]})})}),e.jsx(V,{children:"Generar documento PDF"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:p()})})]})}const qt=new Date;qt.setHours(23,59,59,999);const Ir=h.object({from:h.date().max(new Date,{message:"La fecha de inicio no puede estar en el futuro."}),to:h.date().max(qt,{message:"La fecha de finalización no puede estar en el futuro."})}),$d={totalSum:{label:"Total",color:"hsl(var(--accent))"}};function zd(){const[s,a]=x.useState({from:xa(new Date,7),to:new Date}),[r,t]=x.useState(null),{data:n,isLoading:i,isError:l,error:o,refetch:c}=T({queryKey:["incomes",s.from,s.to],queryFn:async()=>{var p;if(!s.from||!s.to||!fs(s.from)||!fs(s.to))throw new Error("Fechas inválidas");const u=Ir.safeParse(s);if(!u.success)throw new Error(u.error.errors[0].message);const m=await D.charts.incomes.$get({query:{from:Y(s.from,"yyyy-MM-dd"),to:Y(s.to,"yyyy-MM-dd")}});if(!m.ok)throw new Error("Failed to fetch data");return((p=(await m.json()).data)==null?void 0:p.map(f=>({date:f.date,totalSum:f.totalSum?parseFloat(f.totalSum):0})))||[]},enabled:!r}),d=u=>{if(u!=null&&u.from&&(u!=null&&u.to)){const m=Ir.safeParse(u);m.success?(a(u),t(null),c()):t(m.error.errors[0].message)}else t("Por favor, seleccione un rango de fechas válido.")};return e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row w-full items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx(Nt,{dateRange:s,onDateRangeChange:d}),r&&e.jsx("p",{className:"text-destructive text-sm mt-1",children:r})]}),e.jsxs(e.Fragment,{children:[!l&&!i&&n&&n.length>0&&e.jsx(Rd,{time:s}),!l&&!i&&n&&n.length>0&&e.jsx(Td,{time:s})]})]}),l?e.jsxs("div",{className:"text-destructive",children:["Hubo un error al cargar los datos:"," ",o instanceof Error?o.message:"Error desconocido",". Por favor, intenta nuevamente."]}):i?e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{className:"h-8 w-64"}),e.jsx(se,{className:"h-[300px] w-full"})]}):e.jsx("div",{className:"h-[300px] w-full",children:n&&n.length>0?e.jsx(cr,{className:"w-full h-full",config:$d,children:e.jsx(Pn,{width:"100%",height:"100%",children:e.jsxs(An,{data:n,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(En,{strokeDasharray:"3 3"}),e.jsx(kn,{dataKey:"date",tickLine:!1,tickMargin:10,axisLine:!1}),e.jsx(qn,{dataKey:"totalSum",tickFormatter:u=>`${L(u)}`}),e.jsx(bt,{cursor:!1,content:e.jsx(dr,{})}),e.jsx(Dn,{dataKey:"totalSum",fill:"hsl(var(--accent))",radius:[4,4,0,0],barSize:24,children:e.jsx(Ra,{dataKey:"totalSum",position:"top",formatter:u=>`${L(u)}`,offset:8,className:"fill-foreground",fontSize:12})})]})})}):e.jsx("div",{className:"text-gray-500",children:"No hay datos para mostrar en el rango seleccionado."})})]})}function Ts({columns:s,data:a,pageCount:r=-1,onPaginationChange:t}){var N;const[n,i]=x.useState([]),[l,o]=x.useState([]),[c,d]=x.useState({}),[{pageIndex:u,pageSize:m},j]=x.useState({pageIndex:0,pageSize:10}),p={pageIndex:u,pageSize:m},f=Fr({data:a,columns:s,pageCount:r,state:{sorting:n,columnFilters:l,columnVisibility:c,pagination:p},onPaginationChange:q=>{const A=typeof q=="function"?q(p):q;j(A),t==null||t(A)},onSortingChange:i,onColumnFiltersChange:o,onColumnVisibilityChange:d,getCoreRowModel:Rr(),getSortedRowModel:ci(),getFilteredRowModel:di(),getPaginationRowModel:ui(),manualPagination:r>-1});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:" border",children:e.jsxs(Re,{children:[e.jsx(Me,{children:f.getHeaderGroups().map(q=>e.jsx(le,{children:q.headers.map(A=>e.jsx(ae,{children:A.isPlaceholder?null:aa(A.column.columnDef.header,A.getContext())},A.id))},q.id))}),e.jsx(Te,{children:(N=f.getRowModel().rows)!=null&&N.length?f.getRowModel().rows.map(q=>e.jsx(le,{"data-state":q.getIsSelected()&&"selected",children:q.getVisibleCells().map(A=>e.jsx(z,{children:aa(A.column.columnDef.cell,A.getContext())},A.id))},q.id)):e.jsx(le,{children:e.jsx(z,{colSpan:s.length,className:"h-24 text-center",children:"No hay resultados."})})})]})}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 py-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Filas por página"}),e.jsx(I,{type:"number",min:1,defaultValue:m,onChange:q=>{const A=Number(q.target.value);f.setPageSize(A)},className:"h-8 w-16"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Página ",f.getState().pagination.pageIndex+1," de"," ",f.getPageCount()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>f.previousPage(),disabled:!f.getCanPreviousPage(),children:"Anterior"}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>f.nextPage(),disabled:!f.getCanNextPage(),children:"Siguiente"})]})]})]})}async function Od(s,a,r,t){const n=new es;let i=await as(n,t,`Informe de arqueos realizados ${a} ${r}`);const l=s.map(c=>[c.userName,c.date,L(c.sob),L(c.fal),L(c.cordobas),Ne(c.dollars),L(c.total)]);re(n,{head:[["Usuario","Fecha","Sobrante","Faltante","Córdobas","Dólares","Total"]],body:l,startY:i+10,theme:"grid",styles:{fontSize:12,cellPadding:2},headStyles:{fillColor:[41,128,185],textColor:255}});const o=n.output("blob");return URL.createObjectURL(o)}function _d({disabled:s,data:a,month:r,year:t}){const[n,i]=x.useState(!1),[l,o]=x.useState(null),[c,d]=x.useState(!1),u=O();x.useEffect(()=>{n&&u.prefetchQuery(Se)},[n]);const{data:m}=T(Se);x.useEffect(()=>{m&&(d(!0),Od(a,r,t,m).then(p=>{o(p),d(!1)}).catch(()=>{o(null),d(!1)}))},[a,m]);const j=()=>c?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):!a||!l?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:l,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:n,onOpenChange:i,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsxs(E,{disabled:s,children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),"Exportar PDF"]})})}),e.jsx(V,{children:"Generar documento PDF"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:j()})})]})}const Oa=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],kt=new Date,Dt=kt.getFullYear(),Ld=Oa[kt.getMonth()],Vd=Array.from({length:10},(s,a)=>(Dt-5+a).toString());function Kd(){const[s,a]=x.useState(Ld),[r,t]=x.useState(Dt.toString()),[n,i]=x.useState({pageIndex:0,pageSize:10}),{data:l,isLoading:o,refetch:c}=T({queryKey:["conciliaciones"],placeholder:qs,queryFn:async()=>{const m=await(await D.pdf.conciliations.$get({query:{month:Oa.indexOf(s)+1,year:parseInt(r),page:n.pageIndex+1,pageSize:n.pageSize}})).json();if(!m.success)throw console.error("Error al obtener datos:",m.error),new Error(m.error||"Error al obtener datos");return m.data},enabled:!0});x.useEffect(()=>{c()},[s,r,n,c]);const d=x.useMemo(()=>[{accessorKey:"date",header:({column:u})=>e.jsxs(E,{variant:"ghost",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),children:["Fecha",e.jsx(Pl,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"userName",header:"Asistente"},{accessorKey:"cordobas",header:"Córdobas",cell:({row:u})=>L(u.original.cordobas)},{accessorKey:"dollars",header:"Dólares",cell:({row:u})=>Ne(u.original.dollars)},{accessorKey:"total",header:"Total",cell:({row:u})=>L(u.original.total)}],[]);return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(pe,{value:s,onValueChange:a,children:[e.jsx(me,{className:"w-[180px]",children:e.jsx(fe,{placeholder:"Mes"})}),e.jsx(xe,{children:Oa.map(u=>e.jsx(te,{value:u,children:u},u))})]}),e.jsxs(pe,{value:r,onValueChange:t,children:[e.jsx(me,{className:"w-[180px]",children:e.jsx(fe,{placeholder:"Año"})}),e.jsx(xe,{children:Vd.map(u=>e.jsx(te,{value:u,children:u},u))})]})]}),o?e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"h-10 w-full"}),e.jsx(se,{className:"h-10 w-full"}),e.jsx(se,{className:"h-10 w-full"}),e.jsx(se,{className:"h-10 w-full"}),e.jsx(se,{className:"h-10 w-full"})]}):l?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{columns:d,data:l.data,pageCount:l.pagination.totalPages,onPaginationChange:i}),e.jsx(_d,{data:l.data,month:s,year:r,disabled:!l.data.length})]}):e.jsx("div",{className:"text-center",children:"No hay datos disponibles"})]})}const Hd=ce("/doctor/_doctor/services")({component:Gd});function Gd(){const{data:s}=T({queryKey:["money"],queryFn:async()=>(await(await D.services.moneyDoctor.$get()).json()).data}),a=[{id:"pending",title:"Pendientes",icon:e.jsx(Al,{className:"h-4 w-4"}),render:()=>e.jsx(pt,{role:"DOCTOR"})},{id:"doctorMoney",title:"Recaudado por mí",icon:e.jsx(El,{className:"h-4 w-4"}),render:()=>e.jsx(cd,{money:s})},{id:"queries",title:"Consultas",icon:e.jsx(ql,{className:"h-4 w-4"}),render:()=>e.jsx(fd,{})},{id:"transactions",title:"Transacciones",icon:e.jsx(Za,{className:"h-4 w-4"}),render:()=>e.jsx(Id,{})},{id:"incomes",title:"Mis Ingresos",icon:e.jsx(kl,{className:"h-4 w-4"}),render:()=>e.jsx(zd,{})}];(s==null?void 0:s.totalA)!=null&&(a.unshift({id:"assistant-consultations",title:"Cobradas",icon:e.jsx(Dl,{className:"h-4 w-4"}),render:()=>e.jsx(od,{money:s})}),a.push({id:"collects",title:"Arqueos",icon:e.jsx(Il,{className:"h-4 w-4"}),render:()=>e.jsx(Kd,{})}));const[r,t]=x.useState(a[0].id),[n,i]=x.useState(!1),l=x.useRef({}),o=x.useRef(null),c=(m,j)=>{let p;return(...f)=>{clearTimeout(p),p=window.setTimeout(()=>m(...f),j)}},d=x.useCallback(c(m=>t(m),150),[]);x.useEffect(()=>{const m={root:null,rootMargin:"-10% 0px -10% 0px",threshold:.5},j=p=>{p.forEach(f=>{f.isIntersecting&&d(f.target.id)})};return o.current=new IntersectionObserver(j,m),a.forEach(p=>{var N;const f=l.current[p.id];f&&((N=o.current)==null||N.observe(f))}),()=>{var p;return(p=o.current)==null?void 0:p.disconnect()}},[a,d]);const u=m=>{const j=l.current[m];if(j){const f=j.getBoundingClientRect().top+window.pageYOffset+-80;window.scrollTo({top:f,behavior:"smooth"})}i(!1)};return e.jsxs("div",{className:"flex min-h-screen w-full",children:[e.jsx(E,{className:"fixed top-20 left-0 z-20 md:hidden",variant:"ghost",onClick:()=>i(!n),children:e.jsx(fn,{className:"h-6 w-6"})}),e.jsx("aside",{className:`fixed inset-y-0 z-20 pt-32 sm:pt-24 flex flex-col items-start gap-6 border-r p-6 bg-background transition-all duration-300 ease-in-out ${n?"translate-x-0":"-translate-x-full"} md:translate-x-0`,children:a.map(m=>e.jsxs(E,{variant:r===m.id?"default":"ghost",className:`w-full justify-start transition-all duration-300 ease-in-out ${r===m.id?"bg-primary text-primary-foreground":""}`,onClick:()=>u(m.id),children:[e.jsx("span",{className:"mr-3",children:m.icon}),e.jsx("span",{children:m.title})]},m.id))}),e.jsxs("main",{className:"flex-1 mx-7 md:ml-64 p-6 mb-18",children:[a.map((m,j)=>e.jsxs("section",{id:m.id,ref:p=>l.current[m.id]=p,className:`min-h-[60vh] ${j===0?"pt-24":"pt-16"} pb-16 flex flex-col justify-start`,children:[e.jsx("h2",{className:"mb-6 text-2xl font-bold",children:m.title}),e.jsx("div",{children:m.render()})]},m.id)),e.jsx("div",{className:"h-screen"})]})]})}function Bd({querieId:s}){const a=O(),r={maxFiles:5,maxSize:1024*1024*3,multiple:!0},t=["application/pdf","image/jpeg","image/png","image/webp","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.binary.macroEnabled.12","application/vnd.ms-excel.sheet.macroEnabled.12"],[n,i]=x.useState(null),l=$({mutationFn:async()=>{const c=new FormData;if(!n)return;if(!n.every(j=>t.includes(j.type))){P.error("Tipo de archivo no admitido");return}n&&n.forEach((j,p)=>{c.append(`files[${p}]`,j)});const m=await(await fetch(`/api/media/resources/${s}`,{method:"POST",body:c})).json();if(console.log(m),m.success)P.success("Archivos subidos con éxito"),i(null),a.invalidateQueries({queryKey:["resources",s]});else{P.error(m.error);return}}}),o=()=>{l.mutate()};return e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-lg font-semibold mb-2",children:"Adjuntar archivos"}),e.jsxs(Ds,{value:n,onValueChange:i,dropzoneOptions:r,className:"w-full  sm:m-4 m-3",children:[e.jsx(Rs,{className:"h-[200px] w-full rounded-lg border-2 border-dashed border-muted-foreground/25 hover:border-muted-foreground/50 transition-colors",children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center space-y-2 text-center",children:[e.jsx(ue.div,{className:" p-4",animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:e.jsx(xs,{className:"h-8 w-8 text-customborder"})}),e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-primary",children:"Haz clic para subir"})," o arrastra y suelta"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"PNG, JPG, PDF, DOCX, XLS (max. 3MB)"})]})}),e.jsx(Ue,{children:n&&n.length>0&&e.jsx(ue.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4",children:e.jsx(Is,{children:n.map((c,d)=>e.jsx(ue.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{delay:d*.1},children:e.jsx(Fs,{index:d,className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Da,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:c.name})]})})},d))})})})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(_,{disabled:!n,loading:l.isPending,onClick:o,children:"Adjuntar estos archivos"})})]})}const Ud=h.object({price:h.number().min(200,"El precio debe ser mayor o igual a C$ 200.00"),chargePersonally:h.boolean(),paymentMethod:h.enum(["cash","transfer"]).nullable(),bankAccountId:h.string().optional(),cordobasReceived:h.number().nullable(),dollarsReceived:h.number().nullable(),availableCordobas:h.number().min(0,"Córdobas disponibles no puede ser negativo"),exchangeRate:h.number().min(1,"Error con la tasa de cambio")}).refine(s=>s.chargePersonally?!!s.paymentMethod:!0,{message:"Debe seleccionar un método de pago si cobra personalmente",path:["paymentMethod"]}).refine(s=>s.chargePersonally&&s.paymentMethod==="transfer"?!!s.bankAccountId:!0,{message:"Debe seleccionar una cuenta bancaria para transferencias",path:["bankAccountId"]}).refine(s=>s.chargePersonally&&s.paymentMethod==="cash"?(s.cordobasReceived??0)+(s.dollarsReceived??0)*s.exchangeRate>=s.price:!0,{message:"Monto Insuficiente, el total debe ser igual o mayor que el precio",path:["cordobasReceived"]}).refine(s=>s.chargePersonally&&s.paymentMethod==="cash"?(s.cordobasReceived??0)+(s.dollarsReceived??0)*s.exchangeRate-s.price<=s.availableCordobas:!0,{message:"No hay suficiente efectivo en córdobas para dar el cambio",path:["cordobasReceived"]});function Qd({querieId:s,patientName:a}){const r=O(),t=_e(),[n,i]=x.useState(!1),l=J({resolver:W(Ud),defaultValues:{price:0,chargePersonally:!1,paymentMethod:null,cordobasReceived:null,dollarsReceived:null,availableCordobas:0,exchangeRate:0},mode:"onChange"}),{data:o}=T({queryKey:["endQueryRate"],queryFn:async()=>{const S=await(await D.services.rate.$get()).json();return S.success&&S.data&&(l.setValue("availableCordobas",S.data.cordobas),l.setValue("exchangeRate",S.data.rate)),S.data}}),c=l.watch("chargePersonally"),d=l.watch("paymentMethod"),u=l.watch("price");x.useEffect(()=>{c?d===null&&l.setValue("paymentMethod","cash"):(l.setValue("paymentMethod",null),l.setValue("bankAccountId",void 0),l.setValue("cordobasReceived",null),l.setValue("dollarsReceived",null)),l.trigger(["paymentMethod","bankAccountId","cordobasReceived","dollarsReceived"])},[c,d,l]),x.useEffect(()=>{d!=="cash"&&(l.setValue("cordobasReceived",null),l.setValue("dollarsReceived",null)),d!=="transfer"&&l.setValue("bankAccountId",void 0),l.trigger(["cordobasReceived","dollarsReceived","bankAccountId"])},[d,l]),x.useEffect(()=>{l.trigger("price")},[u,l]);const m=g=>{const S=g.target.value.replace(/[^0-9]/g,"");return S?parseInt(S,10):0},j=()=>{const g=l.watch("dollarsReceived")??0;return(l.watch("cordobasReceived")??0)+g*l.watch("exchangeRate")},p=()=>{if(!c||d!=="cash")return null;const g=j();return Math.max(0,g-l.watch("price"))},f=()=>{if(!c||d!=="cash")return null;const g=l.watch("price"),S=j();return Math.max(0,g-S)},N=$({mutationFn:async g=>{const S=p(),ne=await(await D.flows.end[":querieId"].$patch({param:{querieId:s},json:{price:g.price,chargePersonally:g.chargePersonally,paymentMethod:g.paymentMethod,bankAccountId:g.bankAccountId??null,cordobas:g.chargePersonally&&g.paymentMethod==="cash"?g.cordobasReceived:null,dollars:g.chargePersonally&&g.paymentMethod==="cash"?g.dollarsReceived:null,change:g.chargePersonally&&g.paymentMethod==="cash"?S:null}})).json();ne.success?(P.success("Consulta finalizada correctamente"),i(!1),r.invalidateQueries({queryKey:["recents"]}),r.invalidateQueries({queryKey:["process"]}),r.invalidateQueries({queryKey:["money"]}),r.invalidateQueries({queryKey:["earings"]}),t({to:"/doctor/upcoming"})):P.error(ne.error)}}),{data:q,refetch:A}=T({queryKey:["myBanks"],queryFn:async()=>(await(await D.flows.bankaccounts.$get()).json()).data,enabled:!1}),R=g=>{N.mutate(g)},k=g=>{i(g)};return e.jsx("div",{className:"fixed bottom-3 left-0 right-0 flex justify-center items-center z-50",children:e.jsxs(Z,{open:n,onOpenChange:k,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{className:"flex items-center gap-2 rounded-sm",children:[e.jsx(oa,{}),e.jsx("span",{children:"Terminar consulta"})]})}),e.jsx(Bs,{className:"bg-black/50"}),e.jsxs(Q,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"¿Terminar consulta?"}),e.jsxs(Ce,{children:["Guarda la información de ",a,". Una vez guardado, no podrás modificar el precio."]})]}),e.jsx(ee,{...l,children:e.jsxs("form",{className:"space-y-4",onSubmit:l.handleSubmit(R),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{control:l.control,name:"price",render:({field:g})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"price",children:"Costo: C$"}),e.jsx(v,{children:e.jsx(I,{id:"price",type:"text",inputMode:"numeric",value:g.value||"",onChange:S=>{const M=m(S);g.onChange(M),l.trigger("price")},className:"text-sm px-2"})}),e.jsx(C,{})]})}),e.jsx(w,{control:l.control,name:"chargePersonally",render:({field:g})=>e.jsxs(b,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(v,{children:e.jsx(hs,{checked:g.value,onCheckedChange:g.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(y,{children:"Cobrar personalmente"}),e.jsx(sr,{children:"Seleccione si desea cobrar la consulta ahora."})]})]})})]}),e.jsx(Ue,{children:c&&e.jsxs(ue.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{control:l.control,name:"paymentMethod",render:({field:g})=>e.jsxs(b,{children:[e.jsx(y,{children:"Método de pago"}),e.jsxs(pe,{onValueChange:S=>{g.onChange(S),S==="transfer"&&A()},value:g.value??void 0,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione el método de pago"})})}),e.jsxs(xe,{children:[e.jsx(te,{value:"cash",children:"Efectivo"}),e.jsx(te,{value:"transfer",children:"Transferencia bancaria"})]})]}),e.jsx(C,{})]})}),d==="transfer"&&e.jsx(w,{control:l.control,name:"bankAccountId",render:({field:g})=>e.jsxs(b,{children:[e.jsx(y,{children:"Banco"}),e.jsxs(pe,{onValueChange:g.onChange,value:g.value,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione el banco"})})}),e.jsx(xe,{children:q&&q.map(S=>e.jsx(te,{value:S.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:S.color}}),e.jsx("span",{className:"font-medium",children:S.name}),e.jsx(Ge,{className:"text-sm  font-bold ml-auto",children:S.currency==="cor"?"C$":"$"})]})},S.id))})]}),e.jsx(C,{})]})})]}),d==="cash"&&e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between gap-2 bg-secondary p-2 rounded-md",children:o&&e.jsxs("div",{className:"flex items-center justify-between gap-2 bg-secondary p-2 rounded-md",children:[e.jsxs("p",{className:"text-sm",children:["Tasa de cambio actual:",e.jsx("span",{className:"font-semibold ml-2",children:L(o.rate)})]}),e.jsx(Aa,{current:o.rate})]})}),e.jsxs("div",{className:"font-semibold bg-secondary p-2 rounded-md text-sm",children:["Córdobas disponibles:",e.jsx("span",{className:"ml-2",children:L(l.watch("availableCordobas"))})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:l.control,name:"cordobasReceived",render:({field:g})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"cordobasReceived",children:"Córdobas"}),e.jsx(v,{children:e.jsx(I,{id:"cordobasReceived",type:"text",inputMode:"numeric",value:g.value??"",onChange:S=>{const M=m(S);g.onChange(M),l.trigger("cordobasReceived")},className:"text-sm px-2"})}),e.jsx(C,{})]})}),e.jsx(w,{control:l.control,name:"dollarsReceived",render:({field:g})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"dollarsReceived",children:"Dólares"}),e.jsx(v,{children:e.jsx(I,{id:"dollarsReceived",type:"text",inputMode:"numeric",value:g.value??"",onChange:S=>{const M=m(S);g.onChange(M),l.trigger("dollarsReceived")},className:"text-sm px-2"})}),e.jsx(C,{})]})})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg flex flex-col justify-center items-center gap-4 bg-secondary",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Total recibido:"}),e.jsx("p",{className:"text-2xl font-bold",children:L(j())})]}),p()!==null&&p()>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Cambio:"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:L(p())})]}),f()!==null&&f()>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium",children:"Falta por pagar:"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:L(f())})]})]})]})]})}),e.jsx(oe,{children:e.jsx(_,{loading:N.isPending,type:"submit",children:"Guardar"})})]})})]})]})})}function Ie({querieId:s,fieldValue:a,label:r,autoType:t}){const[n,i]=x.useState(a||""),[l,o]=x.useState(null),c=u=>{i(u),d.mutate(u)},d=$({mutationFn:async u=>{if(u==="")return;const j=await(await D.queries.auto[":querieId"].$patch({param:{querieId:s},json:{data:u,autoType:t}})).json();j.success?(o(!0),setTimeout(()=>o(null),2e3)):(o(!1),console.log(j.error))}});return e.jsxs("div",{children:[e.jsx(de,{className:`text-lg font-semibold ${l?"text-green-500":""}`,children:r}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(G,{value:n,onChange:u=>i(u.target.value),className:`w-full transition-all ${l?"border-green-500 border-2":" border"}`}),l&&e.jsx(gs,{className:"text-green-500 w-5 h-5 absolute right-2 top-1/2 transform -translate-y-1/2 transition-opacity"})]}),e.jsx(Jl,{data:n,onSave:c,interval:1500})]})}async function Yd(s,a,r){const t=new es;let n=0;n=await as(t,r,"CONTRARREFERENCIA"),re(t,{startY:n+5,body:[["Unidad que realiza la contrarreferencia:","Clínica de Especialidades FAMED"],["Nombres y apellidos del Usuario:",a.name],["Expediente:",a.idFile],["Fecha y hora del Egreso:",Y(new Date,"dd/MM/yyyy HH:mm")],["Dx de Egreso:",s.dx],["RESUMEN CLÍNICO Y TRATAMIENTO",a.diag]]}),n=t.lastAutoTable.finalY+10,re(t,{startY:n,head:[["Recomendaciones para el paciente","Recomendaciones para la unidad de referencia:"]],body:[[s.recommendationsPatient,s.recommendationsUnit]]}),n=t.lastAutoTable.finalY+10,re(t,{startY:n,head:[["¿La referencia fue adecuada?"]],body:[[s.adequate==="true"?"Sí":"No"],["Especifique:"],[s.specifiqueAdecuate||""]]}),n=t.lastAutoTable.finalY+20,n+=20;const i=t.internal.pageSize.width,l=86;t.line((i-l)/2,n,(i+l)/2,n),t.setFontSize(10);const o=`Médico: ${r.doctorName}`,c=t.getStringUnitWidth(o)*t.internal.getFontSize()/t.internal.scaleFactor;t.text(o,(i-c)/2,n+3);const d="Firma y Sello",u=t.getStringUnitWidth(d)*t.internal.getFontSize()/t.internal.scaleFactor;t.text(d,(i-u)/2,n+8);const m=t.output("blob");return URL.createObjectURL(m)}const Wd=ks({unitName:Ae().min(2,"Nombre de la unidad es requerido"),recommendationsPatient:Ae({required_error:"Recomendaciones para el paciente es requerida"}).min(4,"Recomendaciones para el paciente es requerida"),recommendationsUnit:Ae({required_error:"Recomendaciones para la unidad es requerida"}).min(4,"Recomendaciones para la unidad es requerida"),dx:Ae({required_error:"Dx es requerido"}).min(4,"Dx es requerido"),adequate:nl(["true","false"],{required_error:"Adecuación es requerida"}),specifiqueAdecuate:Ae().optional().nullable()}).refine(s=>!(s.adequate==="false"&&!s.specifiqueAdecuate),{message:"Si la referencia fue inadecuada, debe especificar",path:["specifiqueAdecuate"]});function Jd({queryId:s,idFile:a,emergency:r,name:t,patientId:n,diag:i}){const[l,o]=x.useState(!1),[c,d]=x.useState(!1),[u,m]=x.useState(null),[j,p]=x.useState(!1),f=O(),[N,q]=x.useState(!1),A=J({resolver:W(Wd),defaultValues:{unitName:"",recommendationsPatient:"",recommendationsUnit:"",dx:"",adequate:"true",specifiqueAdecuate:""}});x.useEffect(()=>{N&&(console.log("Invalidating query"),f.invalidateQueries({queryKey:["querieBase",s]}),f.prefetchQuery(Se))},[N]);const{data:R}=T(Se);async function k(S){p(!0),o(!1),d(!0);const M={queryId:s,idFile:a,emergency:r,name:t,patientId:n,diag:i};try{if(R){const ne=await Yd(S,M,R);m(ne)}}catch(ne){console.error("Error generating PDF:",ne),m(null)}finally{p(!1)}}const g=()=>j?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):u?e.jsx("iframe",{src:u,width:"100%",height:"600px",title:"Previsualización del PDF"}):e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{open:N,onOpenChange:q,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"flex items-center",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Contrarreferencia"]})}),e.jsxs(Q,{className:"max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx(X,{children:"Generar Contrarreferencia"}),e.jsx("div",{className:"",children:e.jsx(ee,{...A,children:e.jsxs("form",{onSubmit:A.handleSubmit(k),className:" grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"mb-4 p-4 bg-muted rounded-md",children:e.jsxs("p",{className:"text-sm",children:["Expediente: ",a,e.jsx("br",{}),"Emergencia: ",r?"Sí":"No",e.jsx("br",{}),"Nombre: ",t,e.jsx("br",{}),"Diagnóstico: ",i]})}),e.jsx(w,{control:A.control,name:"unitName",render:({field:S})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Nombre de la Unidad"}),e.jsx(v,{children:e.jsx(I,{className:"w-full",placeholder:"Ingrese el nombre de la unidad",...S})}),e.jsx(C,{})]})}),e.jsx(w,{control:A.control,name:"recommendationsPatient",render:({field:S})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Recomendaciones para el Paciente"}),e.jsx(v,{children:e.jsx(G,{placeholder:"Ingrese las recomendaciones para el paciente",className:"min-h-[100px] w-full",...S})}),e.jsx(C,{})]})}),e.jsx(w,{control:A.control,name:"recommendationsUnit",render:({field:S})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Recomendaciones para la Unidad"}),e.jsx(v,{children:e.jsx(G,{placeholder:"Ingrese las recomendaciones para la unidad",className:"min-h-[100px] w-full",...S})}),e.jsx(C,{})]})}),e.jsx(w,{control:A.control,name:"dx",render:({field:S})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Dx"}),e.jsx(v,{children:e.jsx(I,{className:"w-full",placeholder:"Ingrese el Dx",...S})}),e.jsx(C,{})]})}),e.jsx(w,{control:A.control,name:"adequate",render:({field:S})=>e.jsxs(b,{className:"w-full space-y-3",children:[e.jsx(y,{children:"¿La referencia fue adecuada?"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:S.onChange,defaultValue:S.value,className:"flex flex-col space-y-1",children:[e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"true"})}),e.jsx(y,{className:"font-normal",children:"Sí"})]}),e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"false"})}),e.jsx(y,{className:"font-normal",children:"No"})]})]})}),e.jsx(C,{})]})}),A.watch("adequate")==="false"&&e.jsx(w,{control:A.control,name:"specifiqueAdecuate",render:({field:S})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Especifique por qué la referencia fue inadecuada"}),e.jsx(v,{children:e.jsx(G,{placeholder:"Especifique por qué la referencia fue inadecuada",className:"min-h-[100px] w-full",onChange:S.onChange,value:S.value??""})}),e.jsx(C,{})]})}),e.jsx(E,{type:"submit",children:"Generar Contrarreferencia"})]})})})]})]}),e.jsx(Ve,{open:c,onOpenChange:d,children:e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:g()})})})]})}const _a=ce("/doctor/_doctor/queries")({async validateSearch({querieId:s}){return s},component:Zd});function Zd(){const{querieId:s}=_a.useSearch(),{data:a}=_a.useRouteContext(),{data:r,isLoading:t}=T({queryKey:["querieBase",s],queryFn:async()=>{if(!s)return null;const c=await(await D.queries.base.$get({query:{querieId:s}})).json();return c.success||P("Error al cargar la consulta"),c.data}}),{data:n,isLoading:i}=T({queryKey:["query",s],queryFn:async()=>{if(!s)return null;const c=await(await D.queries.data.$get({query:{querieId:s}})).json();return c.success||P("Error al cargar la consulta"),c.data}}),{data:l}=T({queryKey:["groups",s],queryFn:async()=>{const c=await(await D.queries.grups.$get({query:{querieId:s}})).json();return!c.success||!c.data||c.data===void 0?null:c.data}});return e.jsxs("div",{className:"relative min-h-screen",children:[e.jsxs("div",{className:"w-full ",children:[i&&e.jsx("div",{children:"Cargando consulta..."}),!i&&n&&e.jsx("section",{className:"p-6 sm:m-8 m-4",children:e.jsxs("div",{className:"flex  justify-center sm:space-x-8 items-center  text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center space-x-2 ",children:[e.jsxs("div",{className:"mr-4 flex items-end",children:[e.jsx(or,{patientId:n.patientId,patientName:n.name}),e.jsx(Ca,{patientName:n.name,patientId:n.patientId,size:"24"})]}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Paciente:"}),e.jsx("span",{className:"block text-xl font-semibold",children:n.name})]})]}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Expediente:"}),e.jsx("span",{className:"block text-xl font-semibold",children:n.idFile})]}),n.emergency&&e.jsx("div",{className:"",children:e.jsx(de,{className:"mt-6 inline-block bg-destructive text-lg font-semibold py-1 px-3 rounded-full",children:"Emergencia"})})]})}),e.jsxs("section",{className:"sm:space-y-5 mt-5 space-y-3 sm:m-8 m-4",children:[t&&e.jsxs("div",{className:"grid sm:grid-cols-3 grid-cols-1 gap-2",children:[e.jsx(Ee,{}),e.jsx(Ee,{}),e.jsx(Ee,{})]}),r&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsxs("div",{className:"gap-2",children:[e.jsx(Ie,{querieId:r.querieId,fieldValue:r.reason,label:"Motivo de la consulta:",autoType:"reason"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.history,label:"Historia de la Enfermedad Actual:",autoType:"history"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.interrogation,label:"Interrogatorio por aparatos y sistemas:",autoType:"interrogation"})]}),e.jsx(Bd,{querieId:r.querieId})]}),e.jsx("div",{className:"w-full",children:n&&e.jsx(ut,{isView:!1,querieId:n.id})}),e.jsxs("div",{children:[i&&e.jsx("div",{children:"Cargando consulta..."}),!i&&n&&e.jsx(nr,{isView:!1,specialtie:a==null?void 0:a.doctor.specialtie,querieId:n.id})]}),t&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(je,{}),e.jsx(je,{})]}),r&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(Ie,{querieId:r.querieId,fieldValue:r.aspects,label:"Aspecto General:",autoType:"aspects"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.skin,label:"Piel y mucosas:",autoType:"skin"})]}),e.jsxs("div",{className:"grid sm:gap-4 gap-2 sm:grid-cols-2 grid-cols-1",children:[n&&e.jsx(st,{isView:!1,querieId:n.id,data:JSON.stringify(l==null?void 0:l.head)}),n&&e.jsx(at,{isView:!1,querieId:n.id,data:JSON.stringify(l==null?void 0:l.torax)})]}),t&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{}),e.jsx(je,{})]}),r&&e.jsxs("div",{className:"grid pt-4 sm:grid-cols-2 grid-cols-1 gap-2 border border-customborder p-4 rounded-sm",children:[e.jsx(Ie,{querieId:r.querieId,fieldValue:r.abd,label:"Abdomen y Pelvis:",autoType:"abd"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.anus,label:"Ano y recto (cuando aplique el caso):",autoType:"anus"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.exSup,label:"Extremidades superiores:",autoType:"exSup"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.exInf,label:"Extremidades inferiores:",autoType:"exInf"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.genitu,label:"Genitourinario (cuando aplique el caso):",autoType:"gen"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.neuro,label:"Examen neurológico:",autoType:"neu"})]}),t&&e.jsxs("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:[e.jsx(je,{}),e.jsx(je,{})]}),r&&e.jsxs("div",{className:"mt-4 grid sm:gap-4 gap-2 sm:grid-cols-2 grid-cols-1",children:[e.jsx(Ie,{querieId:r.querieId,fieldValue:r.observations,label:"Observaciones y Análisis:",autoType:"obs"}),e.jsx(Ie,{querieId:r.querieId,fieldValue:r.diag,label:"Diagnósticos o Problemas:",autoType:"diag"})]}),n&&e.jsxs("div",{className:"border border-customborder p-4 rounded-sm ",children:[e.jsx("p",{className:"text-lg font-semibold",children:"Planes"}),e.jsx(tt,{isView:!1,querieId:n.id,patientName:n.name}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 flex items-center justify-between ",children:[e.jsx("p",{className:"text-lg font-semibold ",children:"Contrarreferencia"}),r&&s&&e.jsx(Jd,{queryId:s,idFile:n.idFile,emergency:n.emergency,name:n.name,patientId:n.patientId,diag:r.diag??""})]})]})]})]}),n&&e.jsx(Qd,{querieId:n==null?void 0:n.id,patientName:n==null?void 0:n.name})]})}const It=["SOLTERO","SOLTERA","CASADO","CASADA","DIVORCIADO","DIVORCIADA","VIUDO","VIUDA"],Ft=["MADRE","PADRE","HIJO","HIJA","ESPOSO","ESPOSA","TIA","TIO","HERMANO","HERMANA","ABUELO","ABUELA","CUÑADO","CUÑADA","SUEGRO","SUEGRA"],Xd=h.object({country:h.string(),countryCode:h.number(),flag:h.string()}),eu=h.object({name:h.string({required_error:"Este campo es requerido"}).min(10,{message:"Nombre incorrecto"}).max(130,{message:"Nombre incorrecto"}),phone:h.string({required_error:"Este campo es requerido"}).max(8,{message:"Teléfono incorrecto"}).min(8,{message:"Teléfono incorrecto"}),nationality:Xd,DNI:h.string({required_error:"Este campo es requerido"}).max(16,{message:"Cédula incorrecta"}).min(16,{message:"Cédula incorrecta"}),relation:h.enum(Ft,{required_error:"Este campo es requerido"}),civilStatus:h.enum(It,{required_error:"Este campo es requerido"}),patientId:h.string()}),mr=x.forwardRef(({className:s,containerClassName:a,...r},t)=>e.jsx(Zl,{ref:t,containerClassName:F("flex items-center gap-1 has-[:disabled]:opacity-50",a),className:F("disabled:cursor-not-allowed",s),...r}));mr.displayName="InputOTP";const Cs=x.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:F("flex items-center",s),...a}));Cs.displayName="InputOTPGroup";const he=x.forwardRef(({index:s,className:a,...r},t)=>{const n=x.useContext(Xl),{char:i,hasFakeCaret:l,isActive:o}=n.slots[s];return e.jsxs("div",{ref:t,className:F("relative flex h-8 w-8 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",o&&"z-10 ring-1 ring-ring",a),...r,children:[i,l&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});he.displayName="InputOTPSlot";const su=x.forwardRef(({...s},a)=>e.jsx("div",{ref:a,role:"separator",...s,children:e.jsx(Ji,{})}));su.displayName="InputOTPSeparator";function Rt({onMunicipalityChange:s,onDateChange:a,onFullIdChange:r,onErrorChange:t,value:n}){const i=d=>{if(d.length!==6)return null;const u=parseInt(d.slice(0,2),10),m=parseInt(d.slice(2,4),10)-1,j=parseInt(d.slice(4),10);if(m<0||m>11||u<1||u>31)return null;const f=j>=30?j+1900:j+2e3,N=new Date(f,m,u);return fs(N)?N:null},[l,o]=x.useState(window.innerWidth>=768?"8":"4");x.useEffect(()=>{const d=()=>{o(window.innerWidth>=768?"8":"6")};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]);const c=d=>{r(d);const u=d.split("");let m="",j=null;u.length<=3?(m=u.join(""),s(m)):(u.length<=9||u.length<=14)&&(m=u.slice(0,3).join(""),j=u.slice(3,9).join(""),s(m));const p=j?i(j):null;if(j&&p===null){t("Cédula incorrecta");return}a(p),t(null)};return e.jsxs(mr,{pattern:eo,maxLength:14,value:n??"",onChange:c,children:[e.jsxs(Cs,{children:[e.jsx(he,{className:`w-${l} h-${l}`,index:0}),e.jsx(he,{className:`w-${l} h-${l}`,index:1}),e.jsx(he,{className:`w-${l} h-${l}`,index:2})]}),e.jsxs(Cs,{children:[e.jsx(he,{className:`w-${l} h-${l}`,index:3}),e.jsx(he,{className:`w-${l} h-${l}`,index:4}),e.jsx(he,{className:`w-${l} h-${l}`,index:5}),e.jsx(he,{className:`w-${l} h-${l}`,index:6}),e.jsx(he,{className:`w-${l} h-${l}`,index:7}),e.jsx(he,{className:`w-${l} h-${l}`,index:8})]}),e.jsxs(Cs,{children:[e.jsx(he,{className:`w-${l} h-${l}`,index:9}),e.jsx(he,{className:`w-${l} h-${l}`,index:10}),e.jsx(he,{className:`w-${l} h-${l}`,index:11}),e.jsx(he,{className:`w-${l} h-${l}`,index:12}),e.jsx(he,{className:`w-${l} h-${l}`,index:13})]})]})}function xr({onSelect:s}){const a={country:"Nicaragua",countryCode:505,flag:"https://flagcdn.com/ni.svg"},[r,t]=x.useState(!1),[n,i]=x.useState(a),[l,o]=x.useState(""),{data:c=[],isFetching:d}=T({queryKey:["countries",l],queryFn:async()=>l===""?[]:(await(await D.locations.countries.$get({query:{q:l}})).json()).countries,staleTime:5*60*1e3});return e.jsxs(Us,{open:r,onOpenChange:t,children:[e.jsx(Qs,{asChild:!0,children:e.jsxs(E,{variant:"outline",role:"combobox","aria-expanded":r,className:"w-full justify-between",children:[n?e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:n.flag,alt:`${n.country} flag`,className:"mr-2 h-4 w-4"}),n.country]}):"Nacionalidad...",e.jsx(Ua,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ms,{className:"w-full p-0",children:e.jsxs(ya,{children:[e.jsx("div",{className:"m-3",children:e.jsx(I,{placeholder:"Buscar",value:l,onChange:u=>o(u.target.value)})}),e.jsxs(tr,{children:[d&&e.jsx("div",{className:"w-5 flex m-auto h-5",children:e.jsx(ia,{})}),e.jsx(ba,{children:"Sin resultados"}),e.jsx(va,{children:c.map(u=>e.jsxs(Na,{value:u.countryCode.toString(),onSelect:()=>{i(u),s(u),t(!1)},children:[e.jsx("img",{src:u.flag,alt:`${u.country} flag`,className:"mr-2 h-4 w-4"}),u.country,e.jsx(gs,{className:F("ml-auto h-4 w-4",(n==null?void 0:n.countryCode)===u.countryCode?"opacity-100":"opacity-0")})]},u.countryCode))})]})]})})]})}function hr({id:s}){const a=O(),[r,t]=x.useState(!1),[n,i]=x.useState(null),l={country:"Nicaragua",countryCode:505,flag:"https://flagcdn.com/ni.svg"},o=J({resolver:W(eu),defaultValues:{patientId:s,name:"",DNI:"",civilStatus:"SOLTERA",relation:"MADRE",phone:"",nationality:l}}),c=$({mutationFn:async p=>{const N=await(await D.file.relative.$post({json:p})).json();if(!N.success)throw new Error(N.error);return P.success("El familiar se agregó correctamente"),a.invalidateQueries({queryKey:["relativeList",p.patientId]}),t(!1),N},onError:p=>{P.error(p.message)}}),d=p=>{c.mutate(p)},u=p=>{p?o.setError("DNI",{type:"custom",message:p}):o.clearErrors("DNI")},m=p=>{i(p);const f=p.slice(-1).toUpperCase(),N=p.slice(0,-1)+f,q=`${N.slice(0,3)}-${N.slice(3,9)}-${N.slice(9)}`;o.setValue("DNI",q)},j=o.watch("nationality");return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",children:e.jsx(Be,{})})})}),e.jsx(V,{children:"Nuevo familiar"})]})}),e.jsxs(Q,{className:"",children:[e.jsx(ie,{children:e.jsx(X,{children:"Agregar un familiar"})}),e.jsx("div",{className:"w-full ",children:e.jsx(ee,{...o,children:e.jsxs("form",{className:"w-full",onSubmit:o.handleSubmit(d),children:[e.jsx(w,{control:o.control,name:"name",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre y apellidos"}),e.jsx(v,{children:e.jsx(I,{...p,type:"text"})}),e.jsx(C,{})]})}),e.jsx(w,{control:o.control,name:"DNI",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Cédula de identidad"}),e.jsx(v,{children:(j==null?void 0:j.country)==="Nicaragua"?e.jsx(Rt,{value:n??"",onMunicipalityChange:()=>{},onDateChange:()=>{},onFullIdChange:m,onErrorChange:u}):e.jsx(I,{value:o.watch("DNI")??"",placeholder:"Cédula",onChange:f=>{o.setValue("DNI",f.target.value)}})}),e.jsx(C,{})]})}),e.jsx(w,{control:o.control,name:"nationality",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nacionalidad"}),e.jsx(v,{children:e.jsx(xr,{onSelect:f=>p.onChange(f)})}),e.jsx(C,{})]})}),e.jsx(w,{control:o.control,name:"phone",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Teléfono"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"+"+(j==null?void 0:j.countryCode)}),e.jsx(I,{...p,type:"text",pattern:"^[0-9]+$",maxLength:8,className:"w-full"})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:o.control,name:"relation",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Familiaridad"}),e.jsx(v,{children:e.jsxs(pe,{...p,onValueChange:f=>p.onChange(f),children:[e.jsx(me,{className:"w-full",children:e.jsx(fe,{placeholder:"Seleccione la familiaridad"})}),e.jsx(xe,{children:e.jsxs(Cr,{children:[e.jsx(Ma,{children:"Familiaridad"}),Ft.map(f=>e.jsx(te,{value:f,children:f},f))]})})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:o.control,name:"civilStatus",render:({field:p})=>e.jsxs(b,{children:[e.jsx(y,{children:"Estado civil"}),e.jsx(v,{children:e.jsxs(pe,{...p,onValueChange:f=>p.onChange(f),children:[e.jsx(me,{className:"w-full",children:e.jsx(fe,{placeholder:"Seleccione el estado civil"})}),e.jsx(xe,{children:e.jsxs(Cr,{children:[e.jsx(Ma,{children:"Estado Civil"}),It.map(f=>e.jsx(te,{value:f,children:f},f))]})})]})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"flex justify-end pt-4",children:e.jsx(_,{loading:c.isPending,type:"submit",children:"Guardar"})})]})})})]})]})}const au=h.object({gesta:h.string().max(300,"error").nullable().optional(),para:h.string().max(300,"error").nullable().optional(),aborto:h.string().max(300,"error").nullable().optional(),cesarea:h.string().max(300,"error").nullable().optional(),fum:h.string().max(300,"error").nullable().optional(),abortosInfo:h.string().max(300,"error").nullable().optional(),cesareaMotivos:h.string().max(300,"error").nullable().optional(),cesareaLugar:h.string().max(300,"error").nullable().optional(),cpnInfo:h.string().max(300,"error").nullable().optional(),enfermedadesPrevias:h.string().max(300,"error").nullable().optional(),enfermedadesEmbarazo:h.string().max(300,"error").nullable().optional(),medicacionEmbarazo:h.string().max(300,"error").nullable().optional(),hospitalizaciones:h.string().max(300,"error").nullable().optional()}),ru=h.object({lugarAtencionParto:h.string({required_error:"Este campo es requerido"}),horaNacimiento:h.date({required_error:"Este campo es requerido"}),duracionParto:h.string({required_error:"Este campo es requerido"}),edadGestacional:h.number({required_error:"Este campo es requerido"}).min(22,"La edad gestacional debe ser al menos 22 semanas").max(42,"La edad gestacional no puede exceder 42 semanas"),atencionParto:h.string({required_error:"Este campo es requerido"}),viaParto:h.enum(["Vaginal","Cesárea"],{errorMap:()=>({message:"Debe seleccionar la vía del parto (Vaginal o Cesárea)"})}),presentacion:h.string().optional().nullable(),eventualidades:h.string().optional()}),nu=h.object({apgar1:h.string({required_error:"APGAR 1° es requerido"}).min(1),apgar5:h.string({required_error:"APGAR 5° es requerido"}).min(1),peso:h.string({required_error:"Peso es requerido"}).min(1),talla:h.string({required_error:"Talla es requerida"}).min(1),asfixia:h.boolean(),asfixiaEspecifique:h.string().optional().nullable(),alojamientoConjunto:h.boolean(),tiempoJuntoMadre:h.enum(["Permanente","Transitorio"]).optional(),horasJuntoMadre:h.string().optional(),hospitalizacion:h.string().optional()}).refine(s=>!(s.asfixia&&!s.asfixiaEspecifique),{message:"Si presenta asfixia, debe especificar",path:["asfixiaEspecifique"]}).refine(s=>!(s.alojamientoConjunto&&!s.tiempoJuntoMadre),{message:"Si se da alojamiento conjunto, debe especificar el tiempo junto a la madre",path:["tiempoJuntoMadre"]}).refine(s=>!(s.tiempoJuntoMadre==="Transitorio"&&!s.horasJuntoMadre),{message:"Si el tiempo junto a la madre es Transitorio, debe especificar las horas",path:["horasJuntoMadre"]}),tu=h.object({exclusiveBreastfeeding:h.boolean({required_error:"Este campo es requerido"}),mixedFeeding:h.boolean({required_error:"Este campo es requerido"}),exclusiveBreastfeedingDuration:h.string().optional(),mixedFeedingDuration:h.string().optional(),weaning:h.string().optional()}),iu=h.object({fixedGaze:h.boolean().optional(),fixedGazeAge:h.number().int().min(0).optional(),heldHeadUp:h.boolean().optional(),heldHeadUpAge:h.number().int().min(0).optional(),smiled:h.boolean().optional(),smiledAge:h.number().int().min(0).optional(),satUp:h.boolean().optional(),satUpAge:h.number().int().min(0).optional(),crawled:h.boolean().optional(),crawledAge:h.number().int().min(0).optional(),walked:h.boolean().optional(),walkedAge:h.number().int().min(0).optional(),projected:h.boolean().optional(),projectedAge:h.number().int().min(0).optional()}),lu=iu.superRefine((s,a)=>{["fixedGaze","heldHeadUp","smiled","satUp","crawled","walked","projected"].forEach(t=>{s[t]===!0&&s[`${t}Age`]===void 0&&a.addIssue({code:h.ZodIssueCode.custom,message:"Por favor, complete la edad",path:[`${t}Age`]})})}),ou=h.object({infections:h.string().optional(),chronicDiseases:h.string().optional(),surgeries:h.string().optional(),hospitalizations:h.string().optional(),others:h.string().optional()});function cu({fileId:s,data:a}){const r=[{key:"fixedGaze",ageKey:"fixedGazeAge",title:"Fijó la mirada"},{key:"heldHeadUp",ageKey:"heldHeadUpAge",title:"Sostuvo la cabeza"},{key:"smiled",ageKey:"smiledAge",title:"Se sonrió"},{key:"satUp",ageKey:"satUpAge",title:"Se sentó"},{key:"crawled",ageKey:"crawledAge",title:"Gateó"},{key:"walked",ageKey:"walkedAge",title:"Caminó"},{key:"projected",ageKey:"projectedAge",title:"Se proyectó"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{children:"Desarrollo Psicomotor"}),e.jsx(du,{fileId:s,defaultValues:a})]}),e.jsx("div",{className:"grid sm:grid-cols-6 grid-cols-3 gap-2",children:r.map(({title:t,key:n,ageKey:i})=>{const l=(a==null?void 0:a[n])??void 0,o=(a==null?void 0:a[i])??void 0;return l!==void 0?e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{className:"text-sm font-medium",children:t})}),e.jsx(be,{className:"p-0 pt-1",children:e.jsx("p",{className:"text-sm",children:l?e.jsxs(e.Fragment,{children:["Sí",o!==void 0&&` (${o} ${o===1?"mes":"meses"})`]}):"No"})})]},n):null})})]})}function du({fileId:s,defaultValues:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(lu),defaultValues:a||{fixedGaze:void 0,fixedGazeAge:void 0,heldHeadUp:void 0,heldHeadUpAge:void 0,smiled:void 0,smiledAge:void 0,satUp:void 0,satUpAge:void 0,crawled:void 0,crawledAge:void 0,walked:void 0,walkedAge:void 0,projected:void 0,projectedAge:void 0}}),l=$({mutationFn:async d=>{(await(await fetch(`/api/file/pediatric/${s}/apnp/psico`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json()).success||P.error("Error al guardar"),n.invalidateQueries({queryKey:["apnp"]}),P.success("Guardado correctamente"),t(!1)}});async function o(d){const u=Object.fromEntries(Object.entries(d).filter(([m,j])=>j!==void 0));l.mutate(u),t(!1)}const c=[{name:"fixedGaze",label:"Fijó la mirada"},{name:"heldHeadUp",label:"Sostuvo la cabeza"},{name:"smiled",label:"Se sonrió"},{name:"satUp",label:"Se sentó"},{name:"crawled",label:"Gateó"},{name:"walked",label:"Caminó"},{name:"projected",label:"Se proyectó"}];return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",onClick:()=>t(!0),children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Desarrollo Psicomotor"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx("div",{}),e.jsx("div",{className:"font-semibold text-center",children:"Sí/No"}),e.jsx("div",{className:"font-semibold text-center",children:"Edad (meses)"})]}),c.map(d=>e.jsxs("div",{className:"grid grid-cols-3 gap-1 items-center",children:[e.jsx(y,{children:d.label}),e.jsx(w,{control:i.control,name:d.name,render:({field:u})=>e.jsx(b,{className:"flex items-center justify-center space-x-2",children:e.jsx(v,{children:e.jsx(hs,{checked:u.value===!0,onCheckedChange:m=>u.onChange(m===!0?!0:void 0)})})})}),e.jsx(w,{control:i.control,name:`${d.name}Age`,render:({field:u})=>{var m;return e.jsxs(b,{children:[e.jsx(v,{children:e.jsx(I,{type:"number",onChange:j=>{const p=j.target.value;u.onChange(p===""?void 0:parseInt(p,10))},value:((m=u.value)==null?void 0:m.toString())??"",disabled:!i.watch(d.name)})}),e.jsx(C,{})]})}})]},d.name)),e.jsx(oe,{children:e.jsx(_,{type:"submit",loading:i.formState.isSubmitting,children:"Guardar"})})]})})]})]})}function uu({fileId:s,data:a}){const r=[{title:"Gesta:",key:"gesta"},{title:"Para:",key:"para"},{title:"Abortos (No. e intervalos):",key:"aborto"},{title:"Cesárea:",key:"cesarea"},{title:"FUM:",key:"fum"}],t=[{title:"Abortos:",key:"abortosInfo"},{title:"Cesáreas (motivos):",key:"cesareaMotivos"},{title:"Lugar de la/s cesárea/s: ",key:"cesareaLugar"},{title:"Lugar y No. de CPN:",key:"cpnInfo"},{title:"Enf. Previas y/o crónicas de la madre:",key:"enfermedadesPrevias"},{title:"Enf. De la madre durante el embarazo:",key:"enfermedadesEmbarazo"},{title:"Medicación durante el embarazo:",key:"medicacionEmbarazo"},{title:"Hospitalizaciones y complicaciones durante el embarazo:",key:"hospitalizaciones"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between my-2",children:[e.jsx("p",{children:"Antecedentes prenatales"}),e.jsx(mu,{fileId:s,defaultValues:a})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("div",{className:"grid sm:grid-cols-5 grid-cols-3 gap-2",children:a&&r.map(({title:n,key:i})=>{const l=a[i];return l?e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{children:n})}),e.jsx(be,{className:"p-0",children:l.split(`
`).map((o,c)=>e.jsx("p",{className:"mb-2 last:mb-0 whitespace-pre-wrap text-sm",children:o},c))})]},i):null})}),e.jsx("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-2",children:a&&t.map(({title:n,key:i})=>{const l=a[i];return l?e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{children:n})}),e.jsx(be,{className:"p-0",children:l.split(`
`).map((o,c)=>e.jsx("p",{className:"mb-2 last:mb-0 whitespace-pre-wrap text-sm",children:o},c))})]},i):null})})]})]})}function mu({fileId:s,defaultValues:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(au),defaultValues:a===null?{}:a});function l(c){o.mutate(c)}const o=$({mutationFn:async c=>{(await(await fetch(`/api/file/pediatric/${s}/apnp/prenatales`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json()).success||P.error("Error al guardar"),n.invalidateQueries({queryKey:["apnp"]}),P.success("Guardado correctamente"),t(!1)}});return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",children:e.jsx(Be,{})})}),e.jsxs(Q,{className:"sm:max-w-[600px] md:max-w-[800px] lg:max-w-[1000px] xl:max-w-[1200px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Antecendentes Prenatales"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(l),className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(w,{control:i.control,name:"gesta",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Gesta"}),e.jsx(v,{children:e.jsx(I,{type:"number",onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"para",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Para"}),e.jsx(v,{children:e.jsx(I,{type:"number",onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"aborto",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Aborto"}),e.jsx(v,{children:e.jsx(I,{type:"number",onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"cesarea",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Cesárea"}),e.jsx(v,{children:e.jsx(I,{type:"number",onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"fum",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"FUM (fecha)"}),e.jsx(v,{children:e.jsx(I,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"grid sm:grid-cols-4 gap-3",children:[e.jsx(w,{control:i.control,name:"abortosInfo",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Abortos (Número e intervalos)"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"cesareaMotivos",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Cesáreas (Motivos)"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"cesareaLugar",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Lugar de la/s cesárea/s"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"cpnInfo",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Lugar y Número de CPN"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"enfermedadesPrevias",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Enfermedades previas y/o crónicas de la madre"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"enfermedadesEmbarazo",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Enfermedades de la madre durante el embarazo"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"medicacionEmbarazo",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Medicación durante el embarazo"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"hospitalizaciones",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Hospitalizaciones y complicaciones durante el embarazo"}),e.jsx(v,{children:e.jsx(G,{onChange:c.onChange,value:c.value??""})}),e.jsx(C,{})]})})]}),e.jsx(oe,{children:e.jsx(_,{type:"submit",children:"Guardar"})})]})})]})]})}function xu({fileId:s,data:a}){const r=[{title:"Lugar de la atención del parto:",key:"lugarAtencionParto"},{title:"Fecha y hora del nacimiento:",key:"horaNacimiento"},{title:"Duración del parto:",key:"duracionParto"},{title:"Edad gestacional:",key:"edadGestacional"},{title:"Atención del parto:",key:"atencionParto"},{title:"Vía:",key:"viaParto"},{title:"Presentación:",key:"presentacion"},{title:"Eventualidades durante el parto:",key:"eventualidades"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between my-2",children:[e.jsx("p",{children:"Antecedentes del parto"}),a!==void 0?null:e.jsx(hu,{fileId:s})]}),e.jsx("div",{className:"gap-2 grid grid-cols-2 ",children:a&&r.map(({title:t,key:n})=>{const i=a[n];if(typeof i=="string"&&n!="horaNacimiento")return e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{children:t})}),e.jsx(be,{className:"p-0",children:i.split(`
`).map((l,o)=>e.jsx("p",{className:"mb-2 last:mb-0 whitespace-pre-wrap text-sm",children:l},o))})]},n);if(typeof i=="string"&&n==="horaNacimiento")return e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{children:t})}),e.jsx(be,{className:"p-0",children:i.split(`
`).map((l,o)=>e.jsx("p",{className:"mb-2 last:mb-0 whitespace-pre-wrap text-sm",children:Y(new Date(l),"dd/MM/yyyy HH:mm a")},o))})]},n)})})]})}function hu({fileId:s}){const[a,r]=x.useState(!1),t=O(),n=J({resolver:W(ru),defaultValues:{}}),i=$({mutationFn:async o=>{const d=await(await fetch(`/api/file/pediatric/${s}/apnp/parto`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();d.success||P.error(d.error),t.invalidateQueries({queryKey:["apnp"]}),P.success("Guardado correctamente"),r(!1)}});function l(o){i.mutate(o)}return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",children:e.jsx(Be,{})})}),e.jsxs(Q,{className:"sm:max-w-[750px]",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Antecentes del parto"}),e.jsx(Ce,{children:"Completa los datos relacionados con el parto"})]}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(l),children:[e.jsxs("div",{className:"gap-4 grid sm:grid-cols-3",children:[e.jsx(w,{control:n.control,name:"lugarAtencionParto",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Lugar de Atención del Parto"}),e.jsx(v,{children:e.jsx(I,{...o})}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"duracionParto",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Duración del Parto"}),e.jsx(v,{children:e.jsx(I,{placeholder:"",...o})}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"horaNacimiento",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Hora de Nacimiento"}),e.jsx(v,{children:e.jsx(Vs,{hourCycle:12,granularity:"minute",date:o.value,onChange:o.onChange})}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"edadGestacional",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Edad Gestacional (semanas)"}),e.jsx(v,{children:e.jsx(I,{type:"number",...o,onChange:c=>o.onChange(parseInt(c.target.value))})}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"atencionParto",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Atención del Parto"}),e.jsx(Fe,{onValueChange:o.onChange,className:"grid grid-cols-2 gap-2",children:["médico","enfermero","partera","otros"].map(c=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:c,id:c}),e.jsx(de,{htmlFor:c,children:c})]}))}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"viaParto",render:({field:o})=>e.jsxs(b,{className:"space-y-3",children:[e.jsx(y,{children:"Vía del Parto"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:o.onChange,className:"flex",children:[e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"Vaginal"})}),e.jsx(y,{className:"font-normal",children:"Vaginal"})]}),e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"Cesárea"})}),e.jsx(y,{className:"font-normal",children:"Cesárea"})]})]})}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"presentacion",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Presentación"}),e.jsx(G,{onChange:o.onChange,value:o.value??""}),e.jsx(C,{})]})}),e.jsx(w,{control:n.control,name:"eventualidades",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Eventualidades"}),e.jsx(v,{children:e.jsx(G,{onChange:o.onChange,value:o.value??""})}),e.jsx(C,{})]})})]}),e.jsx(oe,{children:e.jsx(_,{loading:i.isPending,type:"submit",children:"Guardar"})})]})})]})]})}function ju({fileId:s,data:a}){const r=[{title:"APGAR: 1º:",key:"apgar1"},{title:"APGAR: 5º:",key:"apgar5"},{title:"Peso (gr):",key:"peso"},{title:"Talla (cm):",key:"talla"},{title:"Datos de Asfixia",key:"asfixia"},{title:"Especificacion de Asfixia",key:"asfixiaEspecifique"},{title:"Alojamiento conjunto:",key:"alojamientoConjunto"},{title:"Tiempo junto a su madre: ",key:"tiempoJuntoMadre"},{title:"Hospitalización (Lugar/Tiempo):",key:"hospitalizacion"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{children:"Antecedentes postnatales:"}),e.jsx(pu,{fileId:s,data:a})]}),e.jsx("div",{className:"gap-2 grid grid-cols-2",children:a&&r.map(({title:t,key:n})=>{const i=a[n];if(typeof i=="string")return e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{children:t})}),e.jsx(be,{className:"p-0",children:i.split(`
`).map((l,o)=>e.jsx("p",{className:"mb-2 last:mb-0 whitespace-pre-wrap text-sm",children:l},o))})]},n)})})]})}function pu({fileId:s,data:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(nu),defaultValues:a===void 0?{}:a});function l(c){o.mutate(c)}const o=$({mutationFn:async c=>{(await(await fetch(`/api/file/pediatric/${s}/apnp/postnatales`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json()).success||P.error("Error al guardar"),n.invalidateQueries({queryKey:["apnp"]}),P.success("Guardado correctamente"),t(!1)}});return x.useEffect(()=>{i.watch("alojamientoConjunto")||i.setValue("tiempoJuntoMadre",void 0)},[i.watch("alojamientoConjunto")]),x.useEffect(()=>{i.watch("asfixia")||i.setValue("asfixiaEspecifique",void 0)},[i.watch("asfixia")]),e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",children:e.jsx(Be,{})})}),e.jsxs(Q,{className:"",children:[e.jsx(ie,{children:e.jsx(X,{children:"Antecendentes Postnatales"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(l),className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:i.control,name:"apgar1",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"APGAR: 1°"}),e.jsx(v,{children:e.jsx(I,{...c})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"apgar5",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"5°"}),e.jsx(v,{children:e.jsx(I,{...c})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:i.control,name:"peso",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Peso (gr):"}),e.jsx(v,{children:e.jsx(I,{...c,type:"number"})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"talla",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Talla (cm):"}),e.jsx(v,{children:e.jsx(I,{...c,type:"number"})}),e.jsx(C,{})]})})]}),e.jsx(w,{control:i.control,name:"asfixia",render:({field:c})=>e.jsxs(b,{className:"space-y-3",children:[e.jsx(y,{children:"Datos de Asfixia"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:d=>c.onChange(d==="true"),defaultValue:c.value?"true":"false",className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"true",id:"asfixia-si"}),e.jsx(y,{htmlFor:"asfixia-si",className:"text-sm font-normal",children:"Sí"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"false",id:"asfixia-no"}),e.jsx(y,{htmlFor:"asfixia-no",className:"text-sm font-normal",children:"No"})]})]})})]})}),i.watch("asfixia")&&e.jsx(w,{control:i.control,name:"asfixiaEspecifique",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Especifique:"}),e.jsx(v,{children:e.jsx(I,{value:c.value??"",onChange:c.onChange})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"alojamientoConjunto",render:({field:c})=>e.jsxs(b,{className:"space-y-3",children:[e.jsx(y,{children:"Alojamiento conjunto"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:d=>c.onChange(d==="true"),defaultValue:c.value?"true":"false",className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"true",id:"alojamiento-si"}),e.jsx(y,{htmlFor:"alojamiento-si",className:"text-sm font-normal",children:"Sí"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"false",id:"alojamiento-no"}),e.jsx(y,{htmlFor:"alojamiento-no",className:"text-sm font-normal",children:"No"})]})]})})]})}),i.watch("alojamientoConjunto")&&e.jsx(w,{control:i.control,name:"tiempoJuntoMadre",render:({field:c})=>e.jsxs(b,{className:"space-y-3",children:[e.jsx(y,{children:"Tiempo junto a su madre:"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:c.onChange,defaultValue:c.value,className:"flex flex-col space-y-1",children:[e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"Permanente"})}),e.jsx(y,{className:"font-normal",children:"Permanente"})]}),e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"Transitorio"})}),e.jsx(y,{className:"font-normal",children:"Transitorio"})]})]})}),e.jsx(C,{})]})}),i.watch("alojamientoConjunto")&&i.watch("tiempoJuntoMadre")==="Transitorio"&&e.jsx(w,{control:i.control,name:"horasJuntoMadre",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Horas:"}),e.jsx(v,{children:e.jsx(I,{...c,type:"number"})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"hospitalizacion",render:({field:c})=>e.jsxs(b,{children:[e.jsx(y,{children:"Hospitalización (Lugar/Tiempo):"}),e.jsx(v,{children:e.jsx(G,{...c})}),e.jsx(C,{})]})}),e.jsx(oe,{children:e.jsx(_,{type:"submit",children:"Guardar"})})]})})]})]})}function fu({fileId:s,data:a}){const r=[{title:"Lactancia Materna Exclusiva:",key:"exclusiveBreastfeeding"},{title:"Lactancia Mixta:",key:"mixedFeeding"},{title:"Duración de lactancia exclusiva:",key:"exclusiveBreastfeedingDuration"},{title:"Duración de lactancia mixta:",key:"mixedFeedingDuration"},{title:"Ablactación",key:"weaning"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{children:"Alimentación:"}),e.jsx(gu,{fileId:s,data:a})]}),e.jsx("div",{className:"gap-2 grid grid-cols-2",children:a&&r.map(({title:t,key:n})=>{const i=a[n];return i!==void 0?e.jsxs(ge,{className:"p-2",children:[e.jsx(ve,{className:"p-0",children:e.jsx(we,{className:"text-sm font-medium",children:t})}),e.jsx(be,{className:"p-0 pt-1",children:typeof i=="boolean"?e.jsx("p",{className:"text-sm",children:i?"Sí":"No"}):i.split(`
`).map((l,o)=>e.jsx("p",{className:"mb-2 last:mb-0 whitespace-pre-wrap text-sm",children:l},o))})]},n):null})})]})}function gu({fileId:s,data:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(tu),defaultValues:a===void 0?{}:a});x.useEffect(()=>{i.watch("exclusiveBreastfeeding")?i.setValue("mixedFeedingDuration",void 0):i.setValue("exclusiveBreastfeedingDuration",void 0)},[i.watch("exclusiveBreastfeeding"),i.watch("mixedFeeding")]);const l=$({mutationFn:async u=>{const j=await(await fetch(`/api/file/pediatric/${s}/apnp/feeding`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).json();if(!j.success)throw new Error("Error al guardar");return j},onSuccess:()=>{n.invalidateQueries({queryKey:["apnp"]}),P.success("Guardado correctamente"),t(!1)},onError:()=>{P.error("Error al guardar")}});function o(u){l.mutate(u)}const c=i.watch("exclusiveBreastfeeding"),d=i.watch("mixedFeeding");return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Alimentación"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{control:i.control,name:"exclusiveBreastfeeding",render:({field:u})=>e.jsxs(b,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(hs,{checked:u.value,onCheckedChange:m=>{u.onChange(m),m&&(i.setValue("mixedFeeding",!1),i.setValue("mixedFeedingDuration",""))}})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(y,{children:"Lactancia Materna Exclusiva"})})]})}),c&&e.jsx(w,{control:i.control,name:"exclusiveBreastfeedingDuration",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Duración de lactancia exclusiva"}),e.jsx(v,{children:e.jsx(I,{...u})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"mixedFeeding",render:({field:u})=>e.jsxs(b,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(hs,{checked:u.value,onCheckedChange:m=>{u.onChange(m),m&&(i.setValue("exclusiveBreastfeeding",!1),i.setValue("exclusiveBreastfeedingDuration",""))}})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(y,{children:"Lactancia Mixta"})})]})}),d&&e.jsx(w,{control:i.control,name:"mixedFeedingDuration",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Duración de lactancia mixta"}),e.jsx(v,{children:e.jsx(I,{...u})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"weaning",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Ablactación"}),e.jsx(v,{children:e.jsx(I,{...u})}),e.jsx(C,{})]})})]}),e.jsx(_,{loading:l.isPending,type:"submit",children:"Guardar"})]})})]})]})}function yu({fileId:s}){const{data:a}=T({queryKey:["apnp"],queryFn:async()=>{const t=await(await D.file.apnp.$get({query:{fileId:s}})).json();return t.data===null?null:t.data}});return e.jsxs(Bn,{defaultValue:"pre",className:"w-full bg-background",children:[e.jsxs(ar,{className:"sm:mb-0 mb-10 sm:bg-muted bg-transparent flex flex-wrap justify-start gap-2 sm:grid sm:grid-cols-5",children:[e.jsx(Ye,{className:"flex-grow sm:flex-grow-0",value:"pre",children:"Prenatales"}),e.jsx(Ye,{className:"flex-grow sm:flex-grow-0",value:"par",children:"Parto"}),e.jsx(Ye,{className:"flex-grow sm:flex-grow-0",value:"post",children:"Posnatales"}),e.jsx(Ye,{className:"flex-grow sm:flex-grow-0",value:"ali",children:"Alimentación"}),e.jsx(Ye,{className:"flex-grow sm:flex-grow-0",value:"psi",children:"Psicomotor"})]}),e.jsx(We,{value:"pre",children:e.jsx(uu,{fileId:s,data:a==null?void 0:a.prenatales})}),e.jsx(We,{value:"par",children:e.jsx(xu,{fileId:s,data:a==null?void 0:a.parto})}),e.jsx(We,{value:"post",children:e.jsx(ju,{fileId:s,data:a==null?void 0:a.postnatales})}),e.jsx(We,{value:"ali",children:e.jsx(fu,{fileId:s,data:a==null?void 0:a.feeding})}),e.jsx(We,{value:"psi",children:e.jsx(cu,{fileId:s,data:a==null?void 0:a.psico})})]})}function jr({id:s}){const{data:a,isPending:r}=T({queryFn:async()=>(await(await D.file.relative.$get({query:{id:s}})).json()).data,queryKey:["relativeList",s]});return r?e.jsx("div",{children:"Loading..."}):e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Nombre"}),e.jsx(ae,{children:"Parentesco"}),e.jsx(ae,{children:"Estado Civil"}),e.jsx(ae,{children:"Cédula"}),e.jsx(ae,{children:"Teléfono"})]})}),e.jsx(Te,{children:a&&a.map(t=>e.jsxs(le,{children:[e.jsx(z,{children:t.name}),e.jsx(z,{children:e.jsx(Ge,{children:t.relation})}),e.jsx(z,{children:e.jsx(Ge,{children:t.civilStatus})}),e.jsx(z,{children:t.dni}),t.phone&&e.jsx(z,{children:ls(t.phone)}),e.jsx(z,{children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(Pa,{id:s})})})]}))})]})}async function bu(s,a,r){const t=new es;let n=0;n=await as(t,r,"Historial de prescripciones"),re(t,{startY:n,head:[["Datos del Paciente",""]],body:[["Paciente:",s.name],["Expediente:",s.fileId]],theme:"grid",headStyles:{fillColor:[200,200,200],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:10},columnStyles:{0:{cellWidth:40},1:{cellWidth:"auto"}}}),n=t.lastAutoTable.finalY+10;const i={};for(const[u,m]of Object.entries(a))for(const j of m){const p=Y(_s(j.createdAt),"yyyy-MM-dd");i[p]||(i[p]=[]),i[p].push(j)}const l=Object.keys(i).sort((u,m)=>m.localeCompare(u));for(const u of l){const m=i[u];t.setFontSize(14),t.text(`Fecha: ${Y(_s(u),"dd/MM/yyyy")}`,14,n),n+=10,re(t,{startY:n,head:[["Medicamento","Nombre Genérico","Presentación","Indicaciones"]],body:m.map(j=>[j.tradeName,j.genericName||"",j.presentation,j.indications]),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:10},columnStyles:{0:{cellWidth:40},1:{cellWidth:40},2:{cellWidth:40},3:{cellWidth:"auto"}}}),n=t.lastAutoTable.finalY+10,n>t.internal.pageSize.height-20&&(t.addPage(),n=20)}const o=t.internal.pageSize,c=t.getNumberOfPages();for(let u=1;u<=c;u++){t.setPage(u),t.setFontSize(10),t.setTextColor(0,0,0);const m=o.height?o.height:o.getHeight();t.text(`Página ${u} de ${c}`,190,m-10,{align:"right"})}const d=t.output("blob");return URL.createObjectURL(d)}function Mt({patientId:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(null),[i,l]=x.useState(!1),o=O(),{data:c,refetch:d,isLoading:u,isError:m}=T({queryKey:["pdfPrescriptions",s],queryFn:async()=>{const N=await(await D.pdf.prescriptions.$get({query:{patientId:s}})).json();if(!N.success)throw new Error("Error");return N.data},enabled:!1});x.useEffect(()=>{a&&(d(),o.prefetchQuery(Se))},[a,d]);const{data:j}=T(Se);x.useEffect(()=>{c&&j&&(l(!0),bu(c.patient,c.prescriptions,j).then(f=>{n(f),l(!1)}).catch(()=>{n(null),l(!1)}))},[c]);const p=()=>u||i?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):m?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):!c||!t?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:t,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsxs(E,{children:[e.jsx(Hs,{className:"h-5 w-5 mr-2"}),"Listado de prescripciones"]})})}),e.jsx(V,{children:"Generar un documento PDF"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:p()})})]})}function vu(){const s=O(),[a,r]=x.useState(!1),t=J({resolver:W(Yn)}),n=$({mutationFn:async l=>{const c=await(await D.doctors.diases[":diase"].$patch({param:{diase:"infecto"},json:{name:l.name}})).json();c.success||P.error(c.error),P.success("Se agrego correctamente"),s.invalidateQueries({queryKey:["allDiases"]}),r(!1)}}),i=l=>{n.mutate(l)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:"outline",children:"Nueva"})})}),e.jsx(V,{children:"Agregar una enfermedad Infecto contagiosa"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Agregar una enfermedad infecto contagiosa"})}),e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(i),children:[e.jsx(w,{control:t.control,name:"name",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Enfermedad"}),e.jsx(v,{children:e.jsx(I,{...l,disabled:n.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:n.isPending,type:"submit",children:"Guardar"})})]})})]})]})}const Nu=ks({infecto:jn(Ae()).min(1,"Debes seleccionar al menos una enfermedad").max(10,"No puedes seleccionar mas de 10 enfermedades")});function wu({fileId:s,allInfecto:a}){const r=O(),[t,n]=x.useState(!1),i=J({resolver:W(Nu),defaultValues:{infecto:[]}}),l=async d=>{if((await(await D.file.infecto[":fileId"].$patch({param:{fileId:s},json:d})).json()).success)r.invalidateQueries({queryKey:["diases"]});else throw new Error},o=$({mutationFn:async d=>P.promise(l(d),{success:()=>"Guardado con éxito",error:"Error al guardar el registro"})}),c=d=>{n(!1),P.custom(u=>e.jsxs("div",{className:"p-4 bg-destructive text-destructive-foreground border rounded-sm",children:[e.jsx("div",{className:"w-full",children:"¿Está seguro de que deseas agregar estas enfermedades?"}),e.jsx("div",{className:"my-2 font-semibold text-lg",children:e.jsx("p",{children:d.infecto.join(", ")})}),e.jsxs("div",{className:"flex gap-2 justify-end mt-2",children:[e.jsx(E,{variant:"secondary",onClick:()=>P.dismiss(u),children:"No"}),e.jsx(E,{onClick:()=>{P.dismiss(u),o.mutate(d)},children:"Si"})]})]}),{duration:1/0})};return e.jsxs(Z,{open:t,onOpenChange:n,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",children:e.jsx(Be,{className:"h-4 w-4"})})})}),e.jsx(V,{children:"Define Enfermedades Infecto - Contagiosas"})]})}),e.jsxs(Q,{className:"max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Enfermedades Infecto - Contagiosas:"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(c),className:"space-y-4",children:[e.jsx(w,{control:i.control,name:"infecto",render:({field:d})=>e.jsxs(b,{children:[e.jsx(v,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.map((u,m)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{id:`infecto-${m}`,checked:d.value.includes(u),onCheckedChange:j=>{const p=j?[...d.value,u]:d.value.filter(f=>f!==u);d.onChange(p)}}),e.jsx(de,{htmlFor:`infecto-${m}`,children:u})]},m))})}),e.jsx(C,{})]})}),e.jsxs(oe,{children:[e.jsx(vu,{}),e.jsx(E,{type:"submit",disabled:o.isPending,children:o.isPending?"Guardando...":"Guardar"})]})]})})]})]})}function Cu(){const s=O(),[a,r]=x.useState(!1),t=J({resolver:W(Yn)}),n=$({mutationFn:async l=>{const c=await(await D.doctors.diases[":diase"].$patch({param:{diase:"hereditary"},json:{name:l.name}})).json();c.success||P.error(c.error),P.success("Se agrego correctamente"),s.invalidateQueries({queryKey:["allDiases"]}),r(!1)}}),i=l=>{n.mutate(l)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:"outline",children:"Nueva"})})}),e.jsx(V,{children:"Agregar una enfermedad hereditaria"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Agregar una enfermedad hereditaria"})}),e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(i),children:[e.jsx(w,{control:t.control,name:"name",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Enfermedad"}),e.jsx(v,{children:e.jsx(I,{...l,disabled:n.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:n.isPending,type:"submit",children:"Guardar"})})]})})]})]})}const Su=ks({hereditary:jn(Ae()).min(1,"Debes seleccionar al menos una enfermedad").max(10,"No puedes seleccionar mas de 10 enfermedades")});function Pu({fileId:s,allHereditary:a}){const r=O(),[t,n]=x.useState(!1),i=J({resolver:W(Su),defaultValues:{hereditary:[]}}),l=async d=>{if((await(await D.file.hereditary[":fileId"].$patch({param:{fileId:s},json:d})).json()).success)r.invalidateQueries({queryKey:["diases"]});else throw new Error},o=$({mutationFn:async d=>P.promise(l(d),{loading:"Guardando...",success:()=>"Guardado con éxito",error:"Error al guardar el registro"})}),c=d=>{n(!1),P.custom(u=>e.jsxs("div",{className:"p-4 bg-destructive text-destructive-foreground border rounded-sm",children:[e.jsx("div",{className:"w-full",children:"¿Está seguro de que deseas agregar estas enfermedades?"}),e.jsx("div",{className:"my-2 font-semibold text-lg",children:e.jsx("p",{children:d.hereditary.join(", ")})}),e.jsxs("div",{className:"flex gap-2 justify-end mt-2",children:[e.jsx(E,{variant:"secondary",onClick:()=>P.dismiss(u),children:"No"}),e.jsx(E,{onClick:()=>{P.dismiss(u),o.mutate(d)},children:"Si"})]})]}),{duration:1/0})};return e.jsxs(Z,{open:t,onOpenChange:n,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",children:e.jsx(Be,{className:"h-4 w-4"})})})}),e.jsx(V,{children:"Define Enfermedades Hereditarias"})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Enfermedades Hereditarias:"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(c),className:"space-y-4",children:[e.jsx(w,{control:i.control,name:"hereditary",render:({field:d})=>e.jsxs(b,{children:[e.jsx(v,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.map((u,m)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{id:`hereditary-${m}`,checked:d.value.includes(u),onCheckedChange:j=>{const p=j?[...d.value,u]:d.value.filter(f=>f!==u);d.onChange(p)}}),e.jsx(de,{htmlFor:`hereditary-${m}`,children:u})]},m))})}),e.jsx(C,{})]})}),e.jsxs(oe,{children:[e.jsx(Cu,{}),e.jsx(E,{type:"submit",disabled:o.isPending,children:o.isPending?"Guardando...":"Guardar"})]})]})})]})]})}function Tt({fileId:s}){var i,l;const{data:a,isPending:r,error:t}=T({queryKey:["diases",s],queryFn:async()=>{const c=await(await D.file.diases.$get({query:{fileId:s}})).json();if(!c.success)throw new Error("Error inesperado");return c.data}}),{data:n}=T({queryKey:["allDiases"],queryFn:async()=>{const c=await(await D.doctors.diases.$get()).json();return c.success?c.data:(console.log("error al cargar las enfermedades"),{hereditary:[],infecto:[]})}});return t?e.jsx("div",{children:t.message}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ge,{children:[e.jsx(ve,{className:"space-y-0 my-2 py-0",children:e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Enfermedades Hereditarias:"}),e.jsx(Pu,{fileId:s,allHereditary:(n==null?void 0:n.hereditary)||[]})]})})}),e.jsx(be,{children:r?e.jsx(je,{}):e.jsx("div",{className:"gap-1  flex flex-wrap",children:(i=a==null?void 0:a.hereditary)==null?void 0:i.map((o,c)=>e.jsx("div",{className:"bg-accent p-1 font-semibold rounded-sm",children:o},c))})})]}),e.jsxs(ge,{children:[e.jsx(ve,{className:"space-y-0 my-2 py-0",children:e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Enfermedades Infecto – contagiosas:"}),e.jsx(wu,{fileId:s,allInfecto:(n==null?void 0:n.infecto)||[]})]})})}),e.jsx(be,{children:r?e.jsx(je,{}):e.jsx("div",{className:"gap-1  flex flex-wrap",children:(l=a==null?void 0:a.infecto)==null?void 0:l.map((o,c)=>e.jsx("div",{className:"bg-accent p-1 font-semibold rounded-sm",children:o},c))})})]})]})}const ds=Zi,us=Xi,ms=el;function $t({fileId:s}){const{data:a,isPending:r}=T({queryKey:["app"],queryFn:async()=>{const i=await(await D.file.app.$get({query:{fileId:s}})).json();return i.success?i.data:null}}),t=[{title:"Infecciones",key:"infections"},{title:"Enfermedades Crónicas",key:"chronicDiseases"},{title:"Cirugías",key:"surgeries"},{title:"Hospitalizaciones",key:"hospitalizations"},{title:"Otros",key:"others"}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2",children:!r&&e.jsx(Au,{fileId:s,data:a??null})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a&&t.map(({title:n,key:i})=>{const l=a[i];return l?e.jsxs(ge,{className:"shadow-sm rounded-lg overflow-hidden border",children:[e.jsx(ve,{children:e.jsx(we,{children:n})}),e.jsx(be,{children:l.split(`
`).map((o,c)=>e.jsxs(cs.Fragment,{children:[o,e.jsx("br",{})]},c))})]},i):null})})]})}function Au({fileId:s,data:a}){const[r,t]=x.useState(!1),n=O(),i=J({resolver:W(ou),defaultValues:{infections:(a==null?void 0:a.infections)??void 0,chronicDiseases:(a==null?void 0:a.chronicDiseases)??void 0,surgeries:(a==null?void 0:a.surgeries)??void 0,hospitalizations:(a==null?void 0:a.hospitalizations)??void 0,others:(a==null?void 0:a.others)??void 0}}),l=$({mutationFn:async c=>{(await(await D.file.app[":fileId"].$patch({param:{fileId:s},json:c})).json()).success||P.error("Ocurrió un error"),n.invalidateQueries({queryKey:["app"]}),P.success("Se actualizó correctamente"),t(!1)}});function o(c){l.mutate(c)}return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(U,{asChild:!0,children:e.jsx(E,{children:"Agregar nuevo"})}),e.jsxs(Q,{className:"sm:max-w-[1000px]",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Antecedentes Personales Patológicos"}),e.jsx(Ce,{children:"Por favor, complete la siguiente información."})]}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["infections","chronicDiseases","surgeries","hospitalizations","others"].map(c=>e.jsx(w,{control:i.control,name:c,render:({field:d})=>e.jsxs(b,{children:[e.jsx(y,{children:Eu(c)}),e.jsx(v,{children:e.jsx(G,{...d})}),e.jsx(C,{})]})},c))}),e.jsx(oe,{children:e.jsx(E,{type:"submit",children:"Guardar"})})]})})]})]})}function Eu(s){return{infections:"Infecciones",chronicDiseases:"Enfermedades crónicas",surgeries:"Cirugías",hospitalizations:"Hospitalizaciones",others:"Otros"}[s]||s}async function qu(s,a,r,t){const n=new es;let i=await as(n,t,"Consentimiento informado");const l=(d,u)=>(re(n,{startY:u,body:[[d]],styles:{fontSize:14,textColor:[0,0,0],font:"Helvetica"},pageBreak:"auto",theme:"plain"}),n.lastAutoTable.finalY+10);i=l("Según lo dispuesto en la Ley No 423, Ley General de Salud, en el artículo 8, numerales 4, 8 y 9; el Decreto No. 001 – 2003 y el Reglamento de la Ley General de Salud, en el artículo 7, numerales 8, 11 y 12; y en el artículo 9, numeral 1: es un derecho de los y las pacientes a ser informado/a de manera completa y continua, en términos razonables de comprensión y considerando el estado psíquico, sobre su proceso de atención incluyendo nombre del facultativo, diagnóstico, pronóstico y alternativa de tratamiento, y a recibir la consejería por personal capacitado antes y después de la realización de los exámenes y procedimientos establecidos en los protocolos y reglamentos. El usuario tiene derecho, frente a la obligación correspondiente del médico que se le debe asignar,de que se le comunique todo aquello que sea necesario para que su consentimiento esté plenamente informado en forma previa a cualquier procedimiento o tratamiento, de tal manera que pueda evaluar y conocer el procedimiento o tratamiento alternativo o específico, los riesgos médicos asociados y la probable duración de la discapacidad. El consentimiento deberá constar por escrito por parte del usuario. Por tanto, con el presente   documento escrito se pretende informar a usted y a su familia acerca del procedimiento que se le practicará, y lasposibles complicaciones que se pueden presentar, por lo que solicitamos llene de su puño y letra clara los espacios en blanco que se le indiquen",i-5),i=l("Información del Paciente",i),re(n,{startY:i,styles:{fontSize:14},body:[["Nombres y Apellidos",s.name],["Número de cédula",s.dni||"N/A"],["Número de teléfono",s.phone||"N/A"],["Nacionalidad",s.origin||"N/A"],["Dirección",s.address||"N/A"]],theme:"plain"}),i=n.lastAutoTable.finalY+10,i=l("Información del Familiar o Representante Legal",i),re(n,{startY:i,styles:{fontSize:14},body:[["Nombres y Apellidos",a.name],["Relación",a.relation],["Número de cédula",a.dni||"N/A"],["Número de teléfono",a.phone&&ls(a.phone)||"N/A"]],theme:"plain"}),i=n.lastAutoTable.finalY+10,i=l(`Manifiestan: Que el profesional de la salud ${t.doctorName}, con código del MINSA ${t.doctorCredential}, y médico de Clínica de Especialidades FAMED me ha explicado la siguiente información sobre los procedimientos diagnósticos o terapéuticos y tratamientos que se me realizarán:`,i),i=l("Detalles del Consentimiento",i),re(n,{startY:i,styles:{fontSize:14},body:[[{content:"Procedimiento/s diagnósticos o terapéutico y tratamientos",styles:{fontStyle:"bold"}}],[r.procedures],[{content:"1- Definición del procedimiento terapéutico, diagnóstico y/o tratamiento (de acuerdo a normas,protocolos, guías o manuales nacionales o literatura internacional)",styles:{fontStyle:"bold"}}],[r.proceduresDefinition],[{content:"2- Este(os) procedimiento(s) se me debe(n) practicar debido a las condiciones actuales de mi salud, y en este momento no existe una mejor alternativa que ofrezca mayores garantías para mi bienestar y mejoría de mi estado. En mi caso particular, las indicaciones de este(os) procedimiento(s) son:",styles:{fontStyle:"bold"}}],[r.proceduresReason],[{content:"3- Este(os) procedimiento(s) no está libre de complicaciones, por lo tanto se me ha explicado que puedo presentar una o más de las siguientes complicaciones que son frecuentes (escribir todas):",styles:{fontStyle:"bold"}}],[r.complications],[{content:"4- Otras complicaciones menos frecuentes",styles:{fontStyle:"bold"}}],[r.otherComplications||"N/A"],[{content:"5- Otras complicaciones menos frecuentes pero que también se presentan son (escribir todas)",styles:{fontStyle:"bold"}}],[r.conditions||"N/A"],[{content:"6- Si en el transcurso de llevarse a cabo el(los) procedimiento(s) ocurriese una complicación, autorizo al médico y su equipo a realizar todas las medidas y procedimientos necesarios y adicionales para preservar mi vida y estado de salud; estos incluyen:",styles:{fontStyle:"bold"}}],[r.authorizationForActions]],theme:"plain"}),i=n.lastAutoTable.finalY+20,i=l("Manifiestan que:",i),i=l("• Se me ha informado en un lenguaje claro y sencillo sobre el(los) procedimiento(s) diagnóstico(s) o terapéutico y tratamiento",i),i=l("• El doctor/a me ha permitido realizar todas las observaciones y preguntas al respecto",i-5),i=l("• Comprendo que, en cualquier momento y sin necesidad de dar ninguna explicación, puedo revocar este consentimiento",i-5),i=l("• Se me han explicado otros métodos alternativos y acepto el presente como el más adecuado en las actuales circunstancias",i-5),i=l("Por ello, manifiesto que estoy satisfecho/a con la información recibida y que comprendo el alcance y los riesgosexplicados. En tales condiciones, ACEPTO que se me realice(n) el(los) procedimiento(s) antes descritos.",i-5),i=l("Firma del usuario, familiar o representante legal: ________________________",i-5),i=l("Nombre y Firma testigo: __________________ / ___________________",i-5),i=l("Nombre y Firma testigo: __________________ / ___________________",i-5),i=l(`Firma del médico: ____________ Código: ${t.doctorCredential} Sello: ________________`,i-5);const o=Y(new Date,"dd/MM/yyyy hh:mm a");i=l(`Lugar y fecha: ________________, ${o}`,i-5);const c=n.output("blob");return URL.createObjectURL(c)}const ku=ks({procedures:Ae({required_error:"Requerido"}).min(1,"Los procedimientos son requeridos"),proceduresDefinition:Ae({required_error:"Requerido"}).min(1,"La definición de procedimientos es requerida"),proceduresReason:Ae({required_error:"Requerido"}).min(1,"El motivo de los procedimientos es requerido"),complications:Ae({required_error:"Requerido"}).min(1,"Las complicaciones son requeridas"),otherComplications:Ae().optional(),conditions:Ae({required_error:"Requerido"}).optional(),authorizationForActions:Ae({required_error:"Requerido"}).min(1,"La autorización para acciones es requerida"),selectedRelative:Ae({required_error:"Requerido"}).min(1,"Debe seleccionar un familiar")});function Du({patientId:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(!1),[i,l]=x.useState(null),[o,c]=x.useState(!1),d=O(),{data:u,refetch:m,isLoading:j,isError:p}=T({queryKey:["pdfCONST",s],queryFn:async()=>{const S=await(await D.pdf.con.$get({query:{patientId:s}})).json();if(console.log(S),!S.success)throw new Error("Error");return S.data}}),[f,N]=x.useState(!1),q=J({resolver:W(ku),defaultValues:{}});x.useEffect(()=>{t&&(m(),d.prefetchQuery(Se))},[t]);const{data:A}=T(Se);async function R(g){c(!0),r(!1),n(!0);try{if(A&&u){const S=u.relatives.find(ne=>ne.name===g.selectedRelative);if(!S)throw new Error("Relative not found");const M=await qu(u.patient,S,{procedures:g.procedures,proceduresDefinition:g.proceduresDefinition,proceduresReason:g.proceduresReason,complications:g.complications,otherComplications:g.otherComplications,conditions:g.conditions,authorizationForActions:g.authorizationForActions},A);l(M)}}catch(S){console.error("Error generating PDF:",S),l(null)}finally{c(!1)}}const k=()=>o?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):i?e.jsx("iframe",{src:i,width:"100%",height:"600px",title:"Previsualización del PDF"}):e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{open:f,onOpenChange:N,children:[e.jsx(U,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"flex items-center",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Consentimiento informado"]})}),e.jsxs(Q,{className:"max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx(X,{children:"Generar Consentimiento informado"}),e.jsx("div",{className:"",children:e.jsx(ee,{...q,children:e.jsxs("form",{onSubmit:q.handleSubmit(R),className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"mb-4 p-4 bg-muted rounded-md",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Datos del Paciente:"}),e.jsx("br",{}),"Nombre: ",u==null?void 0:u.patient.name,e.jsx("br",{}),"Sexo: ",u==null?void 0:u.patient.sex,e.jsx("br",{}),"DNI: ",(u==null?void 0:u.patient.dni)||"-",e.jsx("br",{}),"Teléfono: ",(u==null?void 0:u.patient.phone)||"-",e.jsx("br",{})]})}),e.jsx(w,{control:q.control,name:"procedures",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Procedimientos"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese los procedimientos",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"proceduresDefinition",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Definición de Procedimientos"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese la definición de los procedimientos",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"proceduresReason",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Motivo de los Procedimientos"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese el motivo de los procedimientos",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"complications",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Complicaciones de los Procedimientos"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese las complicaciones de los procedimientos",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"otherComplications",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Otras Complicaciones"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese otras complicaciones (opcional)",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"conditions",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Condiciones"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese las condiciones (opcional)",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"authorizationForActions",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Autorización para Acciones en Caso de Complicaciones"}),e.jsx(v,{children:e.jsx(G,{className:"w-full",placeholder:"Ingrese la autorización para acciones en caso de complicaciones",...g})}),e.jsx(C,{})]})}),e.jsx(w,{control:q.control,name:"selectedRelative",render:({field:g})=>e.jsxs(b,{className:"w-full",children:[e.jsx(y,{children:"Familiar"}),e.jsxs(pe,{onValueChange:g.onChange,defaultValue:g.value,children:[e.jsx(v,{children:e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione un familiar"})})}),e.jsx(xe,{children:u==null?void 0:u.relatives.map((S,M)=>e.jsxs(te,{value:S.name,children:[S.name," - ",S.relation]},M))})]}),e.jsx(C,{})]})}),e.jsx(E,{type:"submit",children:"Generar"})]})})})]})]}),e.jsx(Ve,{open:t,onOpenChange:n,children:e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:k()})})})]})}function Iu({id:s,old:a,fileId:r}){const t=O(),[n,i]=x.useState(!1),l=h.object({address:xt.shape.address}),o=J({resolver:W(l),defaultValues:{address:a}}),c=$({mutationFn:async u=>{const j=await(await D.patients.address[":id"].$patch({param:{id:s},json:u})).json();if(!j.success)throw new Error;return P.success("Actualiado correctamente"),t.invalidateQueries({queryKey:["file",r]}),i(!1),j},onError:()=>{P.error("Error al actualizar")}}),d=u=>{c.mutate(u)};return e.jsxs(Z,{open:n,onOpenChange:i,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{size:"icon",className:"ml-2",variant:"ghost",children:e.jsx(ua,{className:"w-5 h-5"})})})}),e.jsx(V,{children:"Actualizar dirección"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Acualizar dirección"})}),e.jsx(ee,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(d),children:[e.jsx(w,{control:o.control,name:"address",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Dirección"}),e.jsx(v,{children:e.jsx(G,{...u,disabled:c.isPending})}),e.jsx(C,{})]})}),e.jsx(oe,{className:"mt-2",children:e.jsx(_,{loading:c.isPending,type:"submit",children:"Guardar"})})]})})]})]})}async function pr(s,a,r,t){const i=[["Paciente:",a.name],["Sexo:",a.sex],["Edad:",`${Bo(new Date(a.date))}`],["Fecha de Nacimiento:",Y(a.date,"dd/MM/yyyy")],["Nacionalidad:",a.origin.nationality],["Origen:",a.origin.department+", "+a.origin.municipality],["Dirección:",a.origin.address]];if(r==="GENERAL"&&"phone"in a&&"dni"in a&&(i.push(["Teléfono:",a.phone?ls(a.phone):""]),i.push(["Cédula:",a.dni])),re(s,{startY:t,theme:"plain",styles:{fontSize:11,font:"helvetica"},columnStyles:{0:{cellWidth:40},1:{cellWidth:"auto"}},body:i,tableWidth:120,didParseCell:function(N){N.column.index>0&&(N.cell.styles.fontStyle="bold")}}),a.image===null)return console.log("No hay imagen para mostrar"),s.lastAutoTable.finalY+10;const l=await Tc(a.image);if(l===null)return s.lastAutoTable.finalY+10;const o=s.getImageProperties(l),c=50,d=40,u=c/o.width,m=d/o.height,j=Math.min(u,m),p=o.width*j,f=o.height*j;return s.addImage(l,"JPEG",140,t,p,f),s.lastAutoTable.finalY+10}async function Fu(s,a,r,t){const n=new es;let i=0;i=await as(n,t,`Expediente pediátrico #${r.fileId}`),i=await pr(n,r,"PEDIATRIC",i),Ze(n,i,"Familiares"),i=Ru(n,a,i+10),Ze(n,i,"Antecedentes familiares patológicos"),i=Mu(n,s,i+10),Ze(n,i,"Antecedentes Personales no Patológicos"),ts(n,i+10,"Antecedentes Prenatales"),i=Tu(n,s,i+15),ts(n,i+5,"Antecedentes del Parto"),i=$u(n,s,i+10),ts(n,i+5,"Antecedentes Postnatales"),i=zu(n,s,i+10),ts(n,i+5,"Alimentación"),i=Ou(n,s,i+10),ts(n,i+5,"Desarrollo psicomotor"),i=_u(n,s,i+10),Ze(n,i,"Antecedentes Personales Patológicos"),i=Lu(n,s,i+15);const l=n.output("blob");return URL.createObjectURL(l)}function Ru(s,a,r){const t=a.length>0?a.map(n=>[n.name||"N/A",n.relation||"N/A",n.civilStatus||"N/A",n.dni||"N/A",n.phone?ls(n.phone):""]):[[{content:"No hay datos para mostrar",colSpan:5,styles:{halign:"center"}}]];return re(s,{startY:r,head:[["Nombre","Parentesco","Estado Civil","Cédula","Teléfono"]],body:t,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"striped",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Mu(s,a,r){return re(s,{startY:r,head:[["Enfermedades Infecto – contagiosas:","Enfermedades Hereditarias:"]],body:[[a.infecto.join(", ")||"N/A",a.hereditary.join(", ")||"N/A"]],styles:{fontSize:10,cellPadding:1,font:"helvetica"},theme:"grid",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Tu(s,a,r){const{prenatales:t}=a,n=[{title:"Gesta:",key:"gesta"},{title:"Para:",key:"para"},{title:"Abortos (No. e intervalos):",key:"aborto"},{title:"Cesárea:",key:"cesarea"},{title:"FUM:",key:"fum"},{title:"Abortos:",key:"abortosInfo"},{title:"Cesáreas (motivos):",key:"cesareaMotivos"},{title:"Lugar de la/s cesárea/s:",key:"cesareaLugar"},{title:"Lugar y No. de CPN:",key:"cpnInfo"},{title:"Enf. Previas y/o crónicas de la madre:",key:"enfermedadesPrevias"},{title:"Enf. De la madre durante el embarazo:",key:"enfermedadesEmbarazo"},{title:"Medicación durante el embarazo:",key:"medicacionEmbarazo"},{title:"Hospitalizaciones y complicaciones durante el embarazo:",key:"hospitalizaciones"}],i=[];return n.some(o=>t[o.key]&&t[o.key]!=="")?i.push(...n.filter(o=>t[o.key]&&t[o.key]!=="").map(o=>[{content:o.title,styles:{halign:"left"}},{content:t[o.key],styles:{halign:"left"}}])):i.push([{content:"No hay datos para mostrar",colSpan:2,styles:{halign:"center"}}]),re(s,{startY:r,head:[["Aspecto","Descripción"]],body:i,styles:{fontSize:10,cellPadding:1,font:"helvetica"},theme:"grid",pageBreak:"auto",columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"}}}),s.lastAutoTable.finalY+10}function $u(s,a,r){const t=[{title:"Lugar de la atención del parto:",key:"lugarAtencionParto"},{title:"Fecha y hora del nacimiento:",key:"horaNacimiento"},{title:"Duración del parto:",key:"duracionParto"},{title:"Edad gestacional:",key:"edadGestacional"},{title:"Atención del parto:",key:"atencionParto"},{title:"Vía:",key:"viaParto"},{title:"Presentación:",key:"presentacion"},{title:"Eventualidades durante el parto:",key:"eventualidades"}],{parto:n}=a,i=[];return t.some(o=>n[o.key]&&n[o.key]!=="")?i.push(...t.filter(o=>n[o.key]&&n[o.key]!=="").map(o=>[{content:o.title,styles:{halign:"left"}},{content:o.key==="horaNacimiento"?Y(new Date(n[o.key]),"dd/MM/yyyy hh:mm a"):n[o.key],styles:{halign:"left"}}])):i.push([{content:"No hay datos para mostrar",colSpan:2,styles:{halign:"center"}}]),re(s,{startY:r,head:[["Aspecto","Descripción"]],body:i,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"grid",pageBreak:"auto",columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"}}}),s.lastAutoTable.finalY+10}function zu(s,a,r){const t=[{title:"APGAR: 1º:",key:"apgar1"},{title:"APGAR: 5º:",key:"apgar5"},{title:"Peso (gr):",key:"peso"},{title:"Talla (cm):",key:"talla"},{title:"Datos de Asfixia",key:"asfixia"},{title:"Especificación de Asfixia",key:"asfixiaEspecifique"},{title:"Alojamiento conjunto:",key:"alojamientoConjunto"},{title:"Tiempo junto a su madre:",key:"tiempoJuntoMadre"},{title:"Hospitalización (Lugar/Tiempo):",key:"hospitalizacion"}],{postnatales:n}=a,i=[];return t.some(o=>n[o.key]!==null&&n[o.key]!==void 0&&n[o.key]!=="")?i.push(...t.filter(o=>n[o.key]!==null&&n[o.key]!==void 0&&n[o.key]!=="").map(o=>{const c=n[o.key];let d="";return typeof c=="boolean"?d=c?"Sí":"No":typeof c=="string"?d=c:d="N/A",[{content:o.title,styles:{halign:"left"}},{content:d,styles:{halign:"left"}}]})):i.push([{content:"No hay datos para mostrar",colSpan:2,styles:{halign:"center"}}]),re(s,{startY:r,head:[["Aspecto","Descripción"]],body:i,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"grid",pageBreak:"auto",columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"}}}),s.lastAutoTable.finalY+10}function Ou(s,a,r){const t=[{title:"Lactancia Materna Exclusiva:",key:"exclusiveBreastfeeding"},{title:"Lactancia Mixta:",key:"mixedFeeding"},{title:"Duración de lactancia exclusiva:",key:"exclusiveBreastfeedingDuration"},{title:"Duración de lactancia mixta:",key:"mixedFeedingDuration"},{title:"Ablactación",key:"weaning"}],{feeding:n}=a;let i=t.length>0?t.map(l=>{const o=n[l.key];return typeof o=="boolean"?[l.title,o?"Sí":"No"]:o&&typeof o=="string"?[l.title,o]:null}).filter(l=>l!==null):[{content:"No hay datos de alimentación registrados.",colSpan:2,styles:{halign:"center"}}];return re(s,{startY:r,head:[["Alimentación","Valor"]],body:i,styles:{fontSize:10,cellPadding:1,font:"helvetica"},theme:"grid",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function _u(s,a,r){const t=[{key:"fixedGaze",ageKey:"fixedGazeAge",title:"Fijó la mirada"},{key:"heldHeadUp",ageKey:"heldHeadUpAge",title:"Sostuvo la cabeza"},{key:"smiled",ageKey:"smiledAge",title:"Se sonrió"},{key:"satUp",ageKey:"satUpAge",title:"Se sentó"},{key:"crawled",ageKey:"crawledAge",title:"Gateó"},{key:"walked",ageKey:"walkedAge",title:"Caminó"},{key:"projected",ageKey:"projectedAge",title:"Se proyectó"}],{psico:n}=a,i=t.length>0?t.map(l=>{const o=n[l.key],c=n[l.ageKey];return[l.title,typeof o=="boolean"?o?"Sí":"No":null,c!==void 0?c.toString():null]}).filter(l=>l[1]!==null||l[2]!==null):[{content:"No hay desarrollo psicomotor registrado.",colSpan:3,styles:{halign:"center"}}];return re(s,{startY:r,head:[["Habilidad","Logrado","Edad"]],body:i,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"grid",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Lu(s,a,r){const{app:t}=a,n=[{title:"Infecciones",key:"infections"},{title:"Enfermedades Crónicas",key:"chronicDiseases"},{title:"Cirugías",key:"surgeries"},{title:"Hospitalizaciones",key:"hospitalizations"},{title:"Otros",key:"others"}],i=n.length>0?n.map(({title:l,key:o})=>t[o]?[l,t[o]]:null).filter(l=>l!==null):[{content:"No hay antecedentes personales patológicos registrados.",colSpan:2,styles:{halign:"center"}}];return re(s,{startY:r,head:[["Antecedente","Descripción"]],body:i,styles:{fontSize:10,cellPadding:1,font:"helvetica"},theme:"grid",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Vu({patientId:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(null),[i,l]=x.useState(!1),o=O(),{data:c,refetch:d,isLoading:u,isError:m}=T({queryKey:["pdfPediatricFile",s],queryFn:async()=>{const N=await(await D.pdf.pediatric.$get({query:{patientId:s}})).json();if(!N.success)throw new Error("Error");return N.data},enabled:!1});x.useEffect(()=>{a&&(d(),o.prefetchQuery(Se))},[a,d]);const{data:j}=T(Se);x.useEffect(()=>{c&&j&&(l(!0),Fu(c.patientData,c.relatives,c.patient,j).then(f=>{n(f),l(!1)}).catch(()=>{n(null),l(!1)}))},[c,j]);const p=()=>u||i?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):m?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):!c||!t?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:t,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsx(E,{size:"icon",variant:"ghost",children:e.jsx(Hs,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Generar documento PDF: Expediente"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:p()})})]})}async function Ku(s,a,r,t){const n=new es;let i=0;i=await as(n,t,`Expediente #${r.fileId}`),i=await pr(n,r,"GENERAL",i),Ze(n,i,"Familiares"),i=Hu(n,a,i+10),Ze(n,i,"Antecedentes familiares patológicos"),i=Gu(n,s,i+10),Ze(n,i,"Antecedentes Personales no Patológicos"),i=Bu(n,s,i+15),i=Uu(n,s,i+15),i=Qu(n,s,i+15),Ze(n,i,"Antecedentes Personales Patológicos"),i=Yu(n,s,i+15);const l=n.output("blob");return URL.createObjectURL(l)}function Hu(s,a,r){const t=a.length>0?a.map(n=>[n.name||"N/A",n.relation||"N/A",n.civilStatus||"N/A",n.dni||"N/A",n.phone?ls(n.phone):""]):[[{content:"No hay datos para mostrar",colSpan:5,styles:{halign:"center"}}]];return re(s,{startY:r,head:[["Nombre","Parentesco","Estado Civil","Cédula","Teléfono"]],body:t,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"striped",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Gu(s,a,r){return re(s,{startY:r,head:[["Enfermedades Infecto – contagiosas:","Enfermedades Hereditarias:"]],body:[[a.infecto.join(", ")||"N/A",a.hereditary.join(", ")||"N/A"]],styles:{fontSize:10,cellPadding:1,font:"helvetica"},theme:"grid",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Bu(s,a,r){const{Tabaco:t}=a;if(!t)return r;const i=[{title:"Tipo de tabaco:",key:"tobaccoType"},{title:"Cantidad consumida:",key:"consumptionAmount"},{title:"Frecuencia:",key:"consumptionFrequency"},{title:"Edad de inicio:",key:"startAge"},{title:"Duración del hábito:",key:"duration"}].filter(l=>t[l.key]&&t[l.key]!=="").map(l=>[{content:l.title,styles:{halign:"left"}},{content:t[l.key].value||"N/A",styles:{halign:"left"}}]);return i.length===0?r:(ts(s,r,"Tabaco"),re(s,{startY:r+5,head:[["Aspecto","Detalle"]],body:i,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"striped",pageBreak:"auto",columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"}}}),s.lastAutoTable.finalY+10)}function Uu(s,a,r){const{Alcohol:t}=a;if(!t)return r;const i=[{title:"Tipo de Alcohol:",key:"alcoholType"},{title:"Cantidad consumida:",key:"consumptionAmount"},{title:"Frecuencia:",key:"consumptionFrequency"},{title:"Edad de inicio:",key:"startAge"},{title:"Duración del hábito:",key:"duration"}].filter(l=>t[l.key]&&t[l.key]!=="").map(l=>[{content:l.title,styles:{halign:"left"}},{content:t[l.key].value||"N/A",styles:{halign:"left"}}]);return i.length===0?r:(ts(s,r,"Alcohol"),re(s,{startY:r+5,head:[["Aspecto","Detalle"]],body:i,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"striped",pageBreak:"auto",columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"}}}),s.lastAutoTable.finalY+10)}function Qu(s,a,r){const{Drogas:t}=a;if(!t)return r;const i=[{title:"Tipo de drogas",key:"drugType"},{title:"Cantidad consumida:",key:"consumptionAmount"},{title:"Frecuencia:",key:"consumptionFrequency"},{title:"Edad de inicio:",key:"startAge"},{title:"Duración del hábito:",key:"duration"}].filter(l=>t[l.key]&&t[l.key]!=="").map(l=>[{content:l.title,styles:{halign:"left"}},{content:t[l.key].value||"N/A",styles:{halign:"left"}}]);return i.length===0?r:(ts(s,r,"drogas"),re(s,{startY:r+5,head:[["Aspecto","Detalle"]],body:i,styles:{fontSize:10,font:"helvetica",cellPadding:1},theme:"striped",pageBreak:"auto",columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"}}}),s.lastAutoTable.finalY+10)}function Yu(s,a,r){const{app:t}=a,n=[{title:"Infecciones",key:"infections"},{title:"Enfermedades Crónicas",key:"chronicDiseases"},{title:"Cirugías",key:"surgeries"},{title:"Hospitalizaciones",key:"hospitalizations"},{title:"Otros",key:"others"}],i=n.length>0?n.map(({title:l,key:o})=>t[o]?[l,t[o]]:null).filter(l=>l!==null):[{content:"No hay antecedentes personales patológicos registrados.",colSpan:2,styles:{halign:"center"}}];return re(s,{startY:r,head:[["Antecedente","Descripción"]],body:i,styles:{fontSize:10,cellPadding:1,font:"helvetica"},theme:"grid",pageBreak:"auto"}),s.lastAutoTable.finalY+10}function Wu({patientId:s}){const[a,r]=x.useState(!1),[t,n]=x.useState(null),[i,l]=x.useState(!1),o=O(),{data:c,refetch:d,isLoading:u,isError:m}=T({queryKey:["pdfGeneralFile",s],queryFn:async()=>{const N=await(await D.pdf.general.$get({query:{patientId:s}})).json();if(!N.success)throw new Error("Error");return N.data},enabled:!1}),{data:j}=T(Se);x.useEffect(()=>{a&&(d(),o.prefetchQuery(Se))},[a,d,o]),x.useEffect(()=>{c&&j&&(l(!0),Ku(c.patientData,c.relatives,c.patient,j).then(f=>{n(f),l(!1)}).catch(()=>{n(null),l(!1)}))},[c,j]);const p=()=>u||i?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):m?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):!c||!t?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:t,width:"100%",height:"600px",title:"Previsualización del PDF"});return e.jsxs(Ve,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsx(E,{size:"icon",variant:"ghost",children:e.jsx(Hs,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Generar documento PDF: Expediente"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:p()})})]})}function zt({value:s}){return e.jsx("span",{className:"text-primary font-semibold",children:s})}function Ju({sex:s}){const a=s.toLowerCase()==="masculino",r=a?"bg-blue-100 dark:bg-blue-900":"bg-pink-100 dark:bg-pink-900",t=a?"text-blue-600 dark:text-blue-300":"text-pink-600 dark:text-pink-300";return e.jsxs("section",{className:"w-full",children:[e.jsx("p",{className:"text-sm text-foreground/50 font-semibold dark:text-muted-foreground-dark",children:"Sexo"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`p-1 rounded-full ${r}`,children:a?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:`w-4 h-4 ${t}`,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M10 14m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),e.jsx("path",{d:"M19 5l-5.4 5.4"}),e.jsx("path",{d:"M19 5h-5"}),e.jsx("path",{d:"M19 5v5"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:`w-4 h-4 ${t}`,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12 9m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),e.jsx("path",{d:"M12 14v7"}),e.jsx("path",{d:"M9 18h6"})]})}),e.jsx(zt,{value:s})]})]})}function fr({patient:s,isLoading:a,error:r,isPediatric:t,isAssistant:n}){return a?e.jsx(Zu,{}):r||!s?e.jsx("div",{className:"w-full bg-destructive/10 dark:bg-destructive/20 p-4 rounded-lg",children:e.jsx("div",{className:"text-center text-destructive dark:text-destructive-foreground",children:r?r.message:"Error al cargar el expediente"})}):e.jsxs("div",{className:"w-full bg-zinc-50 border  dark:bg-zinc-900 text-card-foreground  dark:text-card-dark-foreground rounded-sm",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b dark:border-b-gray-700",children:[e.jsxs("h2",{className:"text-2xl font-semibold",children:["Expediente: ",s.fileId]}),t?e.jsx("div",{className:"flex",children:e.jsxs("section",{className:"grid gap-2",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(Fl,{className:"w-7 h-7 text-ring"})}),e.jsx("div",{className:"flex justify-center",children:s&&n===!1&&e.jsx(Vu,{patientId:s.id})})]})}):e.jsx("div",{className:"flex",children:e.jsxs("section",{className:"grid gap-2",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(Rl,{className:"w-7 h-7 text-ring"})}),e.jsx("div",{className:"flex justify-center",children:s&&n===!1&&e.jsx(Wu,{patientId:s.id})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 p-6",children:[e.jsx(os,{label:"Paciente",value:s.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ca,{patientName:s.name,patientId:s.id,size:"10"}),e.jsx(or,{patientId:s.id,patientName:s.name})]}),e.jsx(Ju,{sex:s.sex}),e.jsx(os,{label:"Edad",value:s.age}),e.jsx(os,{label:"Fecha de Nacimiento",value:Y(new Date(s.date),"dd/MM/yyyy")}),e.jsxs("div",{className:"flex",children:[e.jsx(os,{label:"Dirección",value:s.address}),e.jsx(Iu,{id:s.id,old:s.address,fileId:s.fileId})]}),e.jsx(os,{label:"Nacionalidad",value:s.country}),e.jsx(os,{label:"Departamento, Municipio",value:`${s.dapartment}, ${s.municipaly}`}),!t&&e.jsxs(e.Fragment,{children:[e.jsx(os,{label:"Teléfono",value:s.phone?ls(s.phone):""}),e.jsx(os,{label:"Cédula",value:s.dni||""})]})]}),e.jsx("div",{className:"m-4",children:e.jsx(Du,{patientId:s.id})})]})}function os({label:s,value:a}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-foreground/50 font-semibold dark:text-muted-foreground-dark",children:s}),e.jsx(zt,{value:a})]})}function Zu(){return e.jsxs("div",{className:"w-full bg-card text-card-foreground dark:bg-card-dark dark:text-card-dark-foreground shadow-lg rounded-lg animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b dark:border-b-gray-700",children:[e.jsx("div",{className:"h-8 w-1/3 bg-muted dark:bg-muted-dark rounded"}),e.jsx("div",{className:"h-8 w-8 bg-muted dark:bg-muted-dark rounded-full"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 p-6",children:Array(10).fill(0).map((s,a)=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 w-20 bg-muted dark:bg-muted-dark rounded"}),e.jsx("div",{className:"h-5 w-full bg-muted dark:bg-muted-dark rounded"})]},a))})]})}async function Xu(s,a,r,t,n){const i=new es;let l=0;l=await as(i,n,`Consulta #${a.fileId}`),l=await pr(i,a,s,l),l=am(i,t,l,s),l=await rm(i,t,l),l=await nm(i,r,l),l=im(i,l,t),l=tm(i,l,t);const o=i.output("blob");return URL.createObjectURL(o)}function em(s){const a={FC:"Frecuencia cardíaca",FR:"Frecuencia respiratoria",T:"Temperatura",PA:"Presión arterial"};return s==="PEDIATRIC"&&(a.SA="Silverman Andersen"),a}function sm(s){const a={IMC:"Indice de masa (IMC)",w:"Peso",TL:"Talla",ASC:"Área superficial corporal (ASC)"};return s==="PEDIATRIC"&&(a.PC="Perímetro cefálico",a.PRA="Perímetro abdominal",a.PT="Perímetro torácico"),a}function am(s,a,r,t){const n=em(t),i=sm(t);re(s,{startY:r,columnStyles:{0:{minCellWidth:s.internal.pageSize.getWidth()/2-20},1:{minCellWidth:s.internal.pageSize.getWidth()/2-20}},styles:{fontSize:12},head:[["Motivo de la consulta:","Historia de la Enfermedad Actual:"]],body:[[a.reason,a.history]]}),r=s.lastAutoTable.finalY+5,re(s,{startY:r,styles:{fontSize:12},head:[["Interrogatorio por aparatos y sistemas:"]],body:[[a.interrogation]]}),r=s.lastAutoTable.finalY+5;const l=a.vitals;r+=10;const o=Object.entries(n).map(([m,j])=>{var p,f;return m==="PA"?[j,l!=null&&l.PA?`${((p=l.PA)==null?void 0:p.a)??""}/${((f=l.PA)==null?void 0:f.b)??""}`:""]:[j,(l==null?void 0:l[m])!=null?`${l[m]}`:""]});re(s,{startY:r,theme:"grid",head:[["Signos vitales:","Valores"]],styles:{fontSize:12},body:o}),r=s.lastAutoTable.finalY+5;const c=a.antropometrics,d=Object.entries(i).map(([m,j])=>{const p=c==null?void 0:c[m];return p!=null?m==="w"?[j,`${p} kg`]:m==="ASC"?[j,`${p} m²`]:m==="IMC"?[j,`${p} kg/m²`]:[j,`${p} cm`]:[j,""]});re(s,{startY:r,theme:"grid",head:[["Datos antropométricos:","Valores"]],styles:{fontSize:12},body:d}),r=s.lastAutoTable.finalY+5;const u=[["Aspecto General:",a.aspects],["Piel y mucosas:",a.skin],["Abdomen y Pelvis:",a.abd]];return re(s,{startY:r,theme:"grid",styles:{fontSize:12},body:u}),s.lastAutoTable.finalY+10}async function rm(s,a,r){const t=a.resources||[];if(Ze(s,r+10,"Archivos adjuntos"),!t.length)return r;const n=[],i=[];for(const l of t)try{const o=await fetch(l.id);if(o.ok){const c=await o.arrayBuffer();let u=new Uint8Array(c).reduce((N,q)=>N+String.fromCharCode(q),"");const m=btoa(u),j=o.headers.get("Content-Type")||"image/jpeg",p=`data:${j};base64,${m}`;u="",["image/jpeg","image/png","image/webp"].includes(j)?n.push({data:p,type:j.split("/")[1].toUpperCase(),name:l.name}):i.push(l.name)}else console.error("Error al obtener el recurso:",o.status),i.push(l.name)}catch(o){console.error("Error al procesar el recurso:",o),i.push(l.name)}if(i.length>0&&(re(s,{startY:r+20,pageBreak:"auto",head:[["Detalle"]],body:i.map(l=>[l]),styles:{fontSize:12}}),r=s.lastAutoTable.finalY+10),n.length>0){let c=10;for(const d of n)re(s,{startY:r+c,theme:"plain",head:[[""]],body:[[d.name]],pageBreak:"always",styles:{fontSize:12},tableWidth:"wrap",columnStyles:{0:{cellWidth:180}},didDrawCell:function(u){if(u.section==="body"){const m=u.cell.getTextPos(),j=s.getImageProperties(d.data),p=150/j.width,f=150/j.height,N=Math.min(p,f),q=j.width*N,A=j.height*N,R=(150-q)/2,k=(150-A)/2;s.addImage(d.data,d.type,m.x+R,m.y+5+k,q,A)}}}),c=c+180;r=r+c}return re(s,{startY:r,pageBreak:"always",theme:"plain",body:[[""]],styles:{fontSize:12}}),s.lastAutoTable.finalY+10}async function nm(s,a,r){return a.length>0&&(Ze(s,r,"Prescripción"),r+=10,re(s,{startY:r,head:[["Medicamento","Nombre Genérico","Presentación","Indicaciones"]],body:a.map(t=>[t.tradeName,t.genericName,t.presentation,t.indications]),theme:"grid",headStyles:{fillColor:[200,200,200],textColor:[0,0,0],fontStyle:"bold"},styles:{fontSize:10},columnStyles:{0:{cellWidth:40},1:{cellWidth:40},2:{cellWidth:40},3:{cellWidth:"auto"}}})),s.lastAutoTable.finalY+10}function tm(s,a,r){const t=[["Extremidades inferiores:",r.exInf],["Extremidades superiores:",r.exSup],["Ano y recto:",r.anus],["Genitourinario:",r.genitu],["Examen neurológico:",r.neuro],["Observaciones y Análisis:",r.observations],["Diagnósticos o Problemas:",r.diag]];return re(s,{startY:a,theme:"grid",styles:{fontSize:12},body:t}),s.lastAutoTable.finalY+10}function im(s,a,r){const t=r.head,n=r.torax;return re(s,{startY:a,theme:"grid",columnStyles:{0:{minCellWidth:s.internal.pageSize.getWidth()/2-20},1:{minCellWidth:s.internal.pageSize.getWidth()/2-20}},head:[["Cabeza y Cuello","Tórax"]],body:[[{content:"Cráneo y cuero cabelludo",styles:{fontStyle:"bold"}},{content:"Caja torácica",styles:{fontStyle:"bold"}}],[(t==null?void 0:t.craneo)||"",(n==null?void 0:n.caja)||""],[{content:"Ojos",styles:{fontStyle:"bold"}},{content:"Mamas",styles:{fontStyle:"bold"}}],[(t==null?void 0:t.ojos)||"",(n==null?void 0:n.mamas)||""],[{content:"Orejas y oídos",styles:{fontStyle:"bold"}},{content:"Cardíaco",styles:{fontStyle:"bold"}}],[(t==null?void 0:t.orejas)||"",(n==null?void 0:n.cardiaco)||""],[{content:"Nariz",styles:{fontStyle:"bold"}},{content:"Campos Pulmonares",styles:{fontStyle:"bold"}}],[(t==null?void 0:t.nariz)||"",(n==null?void 0:n.pulmonares)||""],[{content:"Boca",styles:{fontStyle:"bold"}},{content:""}],[(t==null?void 0:t.boca)||"",""],[{content:"Cuello",styles:{fontStyle:"bold"}},{content:""}],[(t==null?void 0:t.cuello)||"",""]],styles:{cellPadding:2,fontSize:10}}),a=s.lastAutoTable.finalY+10,a}function lm({queryId:s,speciality:a}){const[r,t]=x.useState(!1),[n,i]=x.useState(null),[l,o]=x.useState(!1),[c,d]=x.useState(null),u=O(),{data:m,refetch:j,isLoading:p,isError:f}=T({queryKey:["pdfQuery",s],queryFn:async()=>{const R=await(await D.pdf.query.$get({query:{queryId:s}})).json();if(!R.success)throw new Error("Error");return R.data},enabled:!1});x.useEffect(()=>{r&&(j(),u.prefetchQuery(Se))},[r,j]);const{data:N}=T(Se);x.useEffect(()=>{m&&N&&(o(!0),d(null),Xu(a,m.patient,m.details,m.query,N).then(A=>{i(A),o(!1)}).catch(()=>{i(null),o(!1),d("Error al generar el PDF.")}))},[m,N]);const q=()=>p||l?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx(ss,{})}):f?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:"Ocurrió un error al cargar el documento."})}):c?e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"bg-destructive p-2 rounded-sm",children:c})}):!m||!n?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("p",{className:"text-center text-gray-500",children:"No hay PDF disponible"})}):e.jsx("iframe",{src:n,width:"100%",height:"600px",title:"Previsualización del PDF",role:"document"});return e.jsxs(Ve,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsx(E,{size:"icon",variant:"ghost",children:e.jsx(Hs,{className:"h-5 w-5"})})})}),e.jsx(V,{children:"Generar documento PDF: Consulta"})]})}),e.jsx(Ke,{className:"w-full h-full",children:e.jsx("div",{className:"mt-2 px-4",children:q()})})]})}const ea=mi(),om=s=>[ea.accessor("createdAt",{cell:a=>new Date(a.getValue()).toLocaleString(),header:"Fecha"}),ea.accessor("emergency",{cell:a=>a.getValue()?"Sí":"No",header:"Emergencia"}),ea.accessor("reason",{cell:a=>a.getValue()??"",header:"Motivo"}),ea.accessor("queryId",{cell:a=>e.jsx(cm,{info:a.getValue(),speciality:s}),header:"Acciones"})],cm=({info:s,speciality:a})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(qe,{to:`/doctor/view?id=${s}`,children:e.jsx(E,{variant:"ghost",size:"icon",children:e.jsx(Ml,{})})})}),e.jsx(V,{children:"Ver Consulta"})]})}),e.jsx(lm,{queryId:s,speciality:a}),e.jsx(nt,{querieId:s})]});function Ot({fileId:s,speciality:a}){const[r,t]=x.useState({pageIndex:0,pageSize:10}),{data:n,isPending:i,error:l}=T({queryKey:["queryList",s,r.pageIndex,r.pageSize],placeholderData:qs,queryFn:async()=>{const d=await(await D.file.queryList.$get({query:{fileId:s,page:r.pageIndex+1,pageSize:r.pageSize}})).json();if(!d.success)throw new Error(d.error||"Error al cargar el expediente");return d},enabled:!!s});if(i)return e.jsx("div",{children:"Cargando..."});if(l)return e.jsxs("div",{children:["Error: ",l.message]});const o=om(a);return e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Lista de Consultas"}),e.jsx(Ts,{columns:o,data:(n==null?void 0:n.data)??[],pageCount:(n==null?void 0:n.pagination.totalPages)??0,onPaginationChange:c=>{t(c)}})]})}const _t=ce("/doctor/_doctor/pediatric")({async validateSearch({id:s}){return s},component:dm});function dm(){const{id:s}=_t.useSearch(),{data:a,isLoading:r,error:t}=T({queryKey:["file",s],queryFn:async()=>{const i=await(await D.patients.file.$get({query:{id:s}})).json();if(!i.success)throw new Error("Error al cargar el expediente");return i.data}});return r?e.jsx("div",{children:"Loading..."}):t||!a?e.jsx("div",{children:t==null?void 0:t.message}):e.jsx("div",{className:"px-4 pb-4 md:px-6 md:pb-6 lg:px-8 lg:pb-8",children:e.jsxs("div",{className:"mt-5 grid gap-6",children:[e.jsx(fr,{isPediatric:!0,isAssistant:!1,patient:a,isLoading:r,error:t}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg",children:"Familiares"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsxs("section",{className:"",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(de,{children:"Familiares"}),e.jsx(hr,{id:a.id})]}),e.jsx(jr,{id:a.id})]})})]}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg",children:"Antecedentes Familiares Patológicos"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsx(Tt,{fileId:a.fileId})})]}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg ",children:"Antecedentes Personales no Patológicos"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsx(yu,{fileId:a.fileId})})]}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg ",children:"Antecedentes Personales Patológicos"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsx($t,{fileId:a.fileId})})]}),e.jsx(Ot,{fileId:a.fileId,speciality:"PEDIATRIC"}),e.jsx("div",{className:"my-2 sm:my-5 flex justify-end",children:e.jsx(Mt,{patientId:a.id})})]})})}const Lt=s=>{const a=[{accessorKey:"name",header:({column:r})=>e.jsxs(E,{variant:"ghost",onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),children:["Nombre",e.jsx(Os,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"sex",header:"Sexo"},{accessorKey:"origin",header:"Origen"},{accessorKey:"date",header:"Edad",cell:({row:r})=>mm(r)},{accessorKey:"date",header:"Nacimiento",cell:({row:r})=>um(r)},{accessorKey:"address",header:"Dirección"}];return s==="general"&&(a.push({accessorKey:"phone",header:"Teléfono",cell:({row:r})=>{const t=r.original.phone;return t?ls(t.toString()):e.jsx("div",{})}}),a.push({accessorKey:"dni",header:"Cédula"})),a.push({id:"id",header:"Acciones",cell:({row:r})=>xm(r,s)}),a};function um(s){const r=new Date(s.getValue("date")).toLocaleDateString();return e.jsx("div",{className:"font-medium",children:r})}function mm(s){const a=new Date(s.getValue("date")),r=new Date;let t=r.getFullYear()-a.getFullYear();return(r.getMonth()<a.getMonth()||r.getMonth()===a.getMonth()&&r.getDate()<a.getDate())&&t--,t}function xm(s,a){return e.jsxs("div",{className:"flex space-x-2",children:[hm(s,a),jm(s),e.jsx(Pa,{id:s.original.id})]})}function hm(s,a){const r=s.original;return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{children:e.jsx(qe,{to:`/doctor/${a}?id=${r.fileId}`,children:e.jsx(E,{variant:"outline",size:"icon",children:e.jsx(xn,{})})})}),e.jsx(V,{children:"Ver Expediente"})]})})}function jm(s){const a=s.original;return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{children:e.jsx(qe,{to:`/doctor/dates?id=${a.id}`,children:e.jsx(E,{variant:"outline",size:"icon",children:e.jsx(hn,{})})})}),e.jsx(V,{children:"Agendar una cita"})]})})}const pm=Lt("pediatric"),fm=Lt("general"),Vt={country:"Nicaragua",countryCode:505,flag:"https://flagcdn.com/ni.svg"},Kt=[{value:"Boaco",label:"Boaco"},{value:"Carazo",label:"Carazo"},{value:"Chinandega",label:"Chinandega"},{value:"Chontales",label:"Chontales"},{value:"Estelí",label:"Estelí"},{value:"Granada",label:"Granada"},{value:"Jinotega",label:"Jinotega"},{value:"León",label:"León"},{value:"Madriz",label:"Madriz"},{value:"Managua",label:"Managua"},{value:"Masaya",label:"Masaya"},{value:"Matagalpa",label:"Matagalpa"},{value:"Nueva Segovia",label:"Nueva Segovia"},{value:"Río San Juan",label:"Río San Juan"},{value:"Rivas",label:"Rivas"},{value:"Atlántico Norte",label:"Atlántico Norte"},{value:"Atlántico Sur",label:"Atlántico Sur"}];function Ht(){const s=_e(),a=O(),r=J({resolver:W(Bc),defaultValues:{nationality:Vt,department:"Matagalpa",municipality:"441",name:"",address:"",action:null,sex:"FEMENINO"}}),t=r.watch("nationality"),n=r.watch("department"),[i,l]=x.useState(null),[o,c]=x.useState(null),d=async A=>{if(r.watch("nationality").countryCode===505){const g=await(await D.locations.find[":code"].$get({param:{code:A}})).json();g.department!=null&&g.municipality!=null&&(r.setValue("department",g.department),l(g.municipality))}},u=A=>{console.log(A,"handleDateChange"),A!==null&&(r.setValue("date",A),r.setValue("dateDni",A))},m=A=>{c(A);const R=A.slice(-1).toUpperCase(),k=A.slice(0,-1)+R,g=`${k.slice(0,3)}-${k.slice(3,9)}-${k.slice(9)}`;r.setValue("Dni",g),i!==null&&(t==null?void 0:t.country)==="Nicaragua"&&r.setValue("municipality",i.code)},j=A=>{A?r.setError("Dni",{type:"custom",message:A}):r.clearErrors("Dni")},p=A=>{f.mutate(A)},f=$({mutationFn:async A=>{if(A.nationality.countryCode===505&&A.dateDni!=null){const g=new Date(A.dateDni),S=new Date(A.date);if(!(g.getFullYear()===S.getFullYear()&&g.getMonth()===S.getMonth()&&g.getDate()===S.getDate())){P.error("La fecha de la Cédula no coincide con la fecha de nacimiento");return}}const R=await D.patients.general.$post({json:A});if(R===void 0){P.error("Error al agregar paciente");return}const k=await R.json();if(k.success){r.reset(),c(null),a.invalidateQueries({queryKey:["listPatients"]}),P.success("Paciente agregado correctamente");const g=k.patientId;k.action==="date"?s({to:`/doctor/dates?id=${g}`}):k.action}else throw new Error(k.error)},onError:A=>{P.error(`Error: ${A.message}`)}}),{data:N=[{name:"Matagalpa",code:"441"}],isPending:q}=T({queryKey:["municipalities",n],queryFn:async()=>{if(!n)return[];const R=await(await D.locations.municipalities.$get({query:{department:n}})).json();return Array.isArray(R)?R:[]},enabled:!!n,staleTime:5*60*1e3});return e.jsx(ee,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(p),className:"mt-4 mx-3 sm:mx-5 border sm:p-5 p-4 rounded-lg",children:[e.jsx(de,{className:"text-lg font-medium",children:"Agregar paciente general"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-5 gap-2 ",children:[e.jsx(w,{control:r.control,name:"name",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Nombres y Apellidos"}),e.jsx(v,{children:e.jsx(I,{type:"text",value:A.value,placeholder:"Nombre y apellidos",onChange:A.onChange})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"sex",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Sexo"}),e.jsx(v,{children:e.jsx(Fe,{value:A.value,onValueChange:A.onChange,defaultValue:A.value,children:e.jsxs("div",{className:"flex justify-center space-x-2 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"FEMENINO"}),e.jsx(y,{children:"FEMENINO"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"MASCULINO"}),e.jsx(y,{children:"MASCULINO"})]})]})})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"nationality",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Nacionalidad"}),e.jsx(v,{children:e.jsx("div",{children:e.jsx(xr,{...A,onSelect:R=>{R.countryCode!==505&&(r.setValue("department",""),r.setValue("municipality","")),A.onChange(R)}})})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"department",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Departamento"}),e.jsx(v,{children:(t==null?void 0:t.country)==="Nicaragua"?e.jsxs(pe,{onValueChange:A.onChange,value:A.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione un departamento"})}),e.jsx(xe,{children:Kt.map(R=>e.jsx(te,{value:R.value,children:R.label},R.value))})]}):e.jsx(I,{...A,placeholder:"Departamento"})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"municipality",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Municipio"}),e.jsx(v,{children:(t==null?void 0:t.country)==="Nicaragua"?e.jsx("div",{children:!q&&e.jsxs(pe,{onValueChange:A.onChange,value:A.value,defaultValue:"441",children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione un municipio"})}),e.jsx(xe,{children:N.map(R=>e.jsx(te,{value:R.code,children:R.name},R.code))})]})}):e.jsx(I,{onChange:A.onChange,value:A.value,placeholder:"Municipio"})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"address",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1 ",children:[e.jsx(y,{children:"Dirección"}),e.jsx(v,{children:e.jsx(G,{value:A.value,onChange:A.onChange})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"date",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Fecha de nacimiento"}),e.jsx(v,{children:e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(Ys,{granularity:"day",locale:ze,weekStartsOn:0,placeholder:"Fecha de nacimiento",displayFormat:{hour24:"dd/MM/yyyy"},onChange:R=>{R!=null&&A.onChange(R)},value:A.value})})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"Dni",render:()=>e.jsxs(b,{className:"my-1 sm:my1 md:col-span-2",children:[e.jsx(y,{children:"Cédula"}),e.jsx(v,{children:(t==null?void 0:t.country)==="Nicaragua"?e.jsx(Rt,{value:o??"",onMunicipalityChange:d,onDateChange:u,onFullIdChange:m,onErrorChange:j}):e.jsx(I,{value:r.watch("foreign")??"",placeholder:"Cédula",onChange:A=>{r.setValue("Dni",null),r.setValue("foreign",A.target.value)}})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"phone",render:({field:A})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1 ",children:[e.jsx(y,{children:"Teléfono"}),e.jsx(v,{children:e.jsx("div",{className:"flex gap-1 items-center",children:e.jsxs(mr,{onChange:R=>{A.onChange(R)},value:A.value??"",pattern:"^[0-9]*$",maxLength:8,type:"text",children:[e.jsxs(Cs,{children:[e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:0}),e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:1}),e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:2}),e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:3})]}),e.jsxs(Cs,{children:[e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:4}),e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:5}),e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:6}),e.jsx(he,{className:"w-8 h-8",inputMode:"numeric",index:7})]})]})})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(_,{type:"submit",children:"Guardar"}),e.jsx(w,{control:r.control,name:"action",render:({field:A})=>e.jsxs(b,{className:"space-y-3",children:[e.jsx(v,{children:e.jsx(Fe,{onValueChange:A.onChange,className:"flex",children:e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"date"})}),e.jsx(y,{className:"font-normal",children:"Agendar cita"})]})})}),e.jsx(C,{})]})})]})]})})}function Gt(){const s=_e(),a=O(),r=J({resolver:W(xt),defaultValues:{nationality:Vt,department:"Matagalpa",municipality:"441",name:"",address:"",action:null,sex:"FEMENINO"}}),t=$({mutationFn:async c=>{const d=await D.patients.pediatric.$post({json:c});if(d===void 0){P.error("Error al agregar paciente");return}const u=await d.json();if(u.success){r.reset(),a.invalidateQueries({queryKey:["listPatients"]}),P.success("Paciente agregado correctamente");const m=u.patientId;u.action==="date"?s({to:`/doctor/dates?id=${m}`}):u.action}else throw new Error(u.error)},onError:c=>{P.error(`Error: ${c.message}`)}}),n=c=>{t.mutate(c)},i=r.watch("nationality"),l=r.watch("department");x.useEffect(()=>{},[l]);const{data:o=[]}=T({queryKey:["municipalities",l],queryFn:async()=>{if(!l)return[];const d=await(await D.locations.municipalities.$get({query:{department:l}})).json();return Array.isArray(d)?d:[]},enabled:!!l,staleTime:5*60*1e3});return e.jsx(ee,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(n),className:"mt-4 mx-3 sm:mx-5 border sm:p-5 rounded-lg",children:[e.jsx(de,{className:"text-lg font-medium",children:"Agregar Paciente Pediátricos"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-5 gap-2 ",children:[e.jsx(w,{control:r.control,name:"name",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Nombres y Apellidos"}),e.jsx(v,{children:e.jsx(I,{type:"text",value:c.value,placeholder:"Nombre y apellidos",onChange:c.onChange})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"sex",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Sexo"}),e.jsx(v,{children:e.jsx(Fe,{value:c.value,onValueChange:c.onChange,defaultValue:c.value,children:e.jsxs("div",{className:"flex justify-center space-x-2 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"FEMENINO"}),e.jsx(y,{children:"FEMENINO"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"MASCULINO"}),e.jsx(y,{children:"MASCULINO"})]})]})})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"nationality",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Nacionalidad"}),e.jsx(v,{children:e.jsx("div",{children:e.jsx(xr,{...c,onSelect:d=>c.onChange(d)})})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"department",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Departamento"}),e.jsx(v,{children:(i==null?void 0:i.country)==="Nicaragua"?e.jsxs(pe,{onValueChange:c.onChange,value:c.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione un departamento"})}),e.jsx(xe,{children:Kt.map(d=>e.jsx(te,{value:d.value,children:d.label},d.value))})]}):e.jsx(I,{...c,placeholder:"Departamento"})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"municipality",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Municipio"}),e.jsx(v,{children:(i==null?void 0:i.country)==="Nicaragua"?e.jsxs(pe,{onValueChange:c.onChange,value:c.value,defaultValue:c.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Seleccione un municipio"})}),e.jsx(xe,{children:o.map(d=>e.jsx(te,{value:d.code,children:d.name},d.code))})]}):e.jsx(I,{...c,placeholder:"Municipio"})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"address",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1 ",children:[e.jsx(y,{children:"Dirección"}),e.jsx(v,{children:e.jsx(G,{value:c.value,onChange:c.onChange})}),e.jsx(C,{})]})}),e.jsx(w,{control:r.control,name:"date",render:({field:c})=>e.jsxs(b,{className:"my-1 sm:my1 col-span-1",children:[e.jsx(y,{children:"Fecha de nacimiento"}),e.jsx(v,{children:e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(Ys,{granularity:"day",locale:ze,weekStartsOn:0,placeholder:"Fecha de nacimiento",displayFormat:{hour24:"dd/MM/yyyy"},onChange:d=>{d!=null&&c.onChange(d)},value:c.value})})}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(_,{type:"submit",children:"Guardar"}),e.jsx(w,{control:r.control,name:"action",render:({field:c})=>e.jsxs(b,{className:"space-y-3",children:[e.jsx(v,{children:e.jsx(Fe,{onValueChange:c.onChange,className:"flex",children:e.jsxs(b,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(v,{children:e.jsx(ye,{value:"date"})}),e.jsx(y,{className:"font-normal",children:"Agendar cita"})]})})}),e.jsx(C,{})]})})]})]})})}const gm=ce("/doctor/_doctor/patients")({component:ym});function ym(){var d,u,m;const{data:s,isLoading:a,isError:r}=T(js),[t,n]=x.useState({pageIndex:0,pageSize:10}),{data:i,isLoading:l,isError:o}=T({queryKey:["listPatients",t.pageIndex,t.pageSize,(d=s==null?void 0:s.doctor)==null?void 0:d.specialtie],placeholderData:qs,queryFn:async()=>{const p=await(await D.patients.all.$get({query:{page:t.pageIndex+1,pageSize:t.pageSize}})).json();if(!p.success)throw new Error("Error al cargar la lista de pacientes");return p.data},enabled:!!s});if(a||l)return e.jsxs("div",{className:"p-8 space-y-4",children:[e.jsx(se,{className:"h-12 w-64"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-full"}),e.jsx(se,{className:"h-4 w-3/4"})]});if(r||o)return e.jsx(e.Fragment,{children:"Ha ocurrido un error al cargar los datos. Por favor, intenta de nuevo más tarde."});const c=((u=s==null?void 0:s.doctor)==null?void 0:u.specialtie)==="GENERAL"?fm:pm;return e.jsxs(e.Fragment,{children:[((m=s==null?void 0:s.doctor)==null?void 0:m.specialtie)==="GENERAL"?e.jsx(Ht,{}):e.jsx(Gt,{}),e.jsx("div",{className:"mt-4 mx-3 sm:mx-5",children:e.jsx(Ts,{columns:c,data:(i==null?void 0:i.data)??[],pageCount:(i==null?void 0:i.pagination.totalPages)??0,onPaginationChange:j=>{n(j)}})}),e.jsx("div",{className:"mx-10 mb-20"})]})}const bm=h.object({tobaccoType:h.string({required_error:"Este campo es requerido"}).min(4,"Complete este campo"),consumptionAmount:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),consumptionFrequency:h.string({required_error:"Este campo es requerido"}).min(4,"Complete este campo"),startAge:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),duration:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo")}),vm=h.object({alcoholType:h.string({required_error:"Este campo es requerido"}).min(4,"Complete este campo"),consumptionAmount:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),consumptionFrequency:h.string({required_error:"Este campo es requerido"}).min(4,"Complete este campo"),startAge:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),duration:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo")}),Nm=h.object({drugType:h.string({required_error:"Este campo es requerido"}).min(4,"Complete este campo"),consumptionAmount:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),consumptionFrequency:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),startAge:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo"),duration:h.string({required_error:"Este campo es requerido"}).min(1,"Complete este campo")});h.object({num:h.string({required_error:"Este campo es requerido"}),posology:h.string({required_error:"Este campo es requerido"})});function wm({fileId:s}){const[a,r]=x.useState(!1),t=O(),n=J({resolver:W(vm),defaultValues:{alcoholType:"",consumptionAmount:"",consumptionFrequency:"",startAge:"",duration:""}}),i=o=>{l.mutate(o)},l=$({mutationFn:async o=>{const d=await(await fetch(`/api/file/general/apnp/${s}/alcohol`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();d.success||P.error(d.error),P.success("Información actualizada"),r(!1),t.invalidateQueries({queryKey:["apnp"]})}});return e.jsxs(Z,{onOpenChange:r,open:a,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{children:"Consumo de Alcohol"})})}),e.jsxs(V,{children:["Describe el consumo de Alcohol del paciente"," "]})]})}),e.jsxs(Q,{className:"w-full",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Consumo de Alcohol"}),e.jsx(Ce,{children:"Describe el consumo de Alcohol del paciente."})]}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(i),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"alcoholType",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Tipo de Alcohol"}),e.jsx(v,{children:e.jsx(I,{type:"text",...o})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"consumptionAmount",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"consumptionAmount",children:"Cantidad consumida"}),e.jsx(v,{children:e.jsx(I,{id:"consumptionAmount",...o,disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"consumptionFrequency",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"consumptionFrequency",children:"Frecuencia"}),e.jsx(v,{children:e.jsxs(pe,{onValueChange:o.onChange,defaultValue:o.value,value:o.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Selecciona la frecuencia"})}),e.jsxs(xe,{children:[e.jsx(te,{value:"diario",children:"Diario"}),e.jsx(te,{value:"semanal",children:"Semanal"}),e.jsx(te,{value:"mensual",children:"Mensual"}),e.jsx(te,{value:"ocasional",children:"Ocasional"})]})]})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"startAge",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"startAge",children:"Edad de inicio"}),e.jsx(v,{children:e.jsx(I,{...o,id:"startAge",type:"number",disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"duration",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"duration",children:"Duración del hábito"}),e.jsx(v,{children:e.jsx(I,{...o,id:"duration",disabled:l.isPending})}),e.jsx(C,{})]})})})]}),e.jsx(oe,{children:e.jsx(_,{type:"submit",className:"",children:"Guardar"})})]})})]})]})}function Cm({fileId:s}){const[a,r]=x.useState(!1),t=O(),n=J({resolver:W(bm),defaultValues:{tobaccoType:"",consumptionAmount:"",consumptionFrequency:"",startAge:"",duration:""}}),i=o=>{l.mutate(o),console.log(o)},l=$({mutationFn:async o=>{const d=await(await fetch(`/api/file/general/apnp/${s}/tobaco`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();d.success||P.error(d.error),P.success("Información actualizada"),r(!1),t.invalidateQueries({queryKey:["apnp"]})}});return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{children:"Consumo de Tabaco"})})}),e.jsxs(V,{children:["Describe el consumo de Tabaco del paciente"," "]})]})}),e.jsxs(Q,{className:"w-full",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Consumo de Tabaco"}),e.jsx(Ce,{children:"Describe el consumo de tabaco del paciente."})]}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(i),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"tobaccoType",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Tipo de tabaco"}),e.jsx(v,{children:e.jsxs(pe,{onValueChange:o.onChange,defaultValue:o.value,value:o.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Selecciona el tipo de tabaco"})}),e.jsxs(xe,{children:[e.jsx(te,{value:"cigarrillos",children:"Cigarrillos"}),e.jsx(te,{value:"puros",children:"Puros"}),e.jsx(te,{value:"pipas",children:"Pipas"}),e.jsx(te,{value:"tabaco-sin-humo",children:"Tabaco sin humo"})]})]})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"consumptionAmount",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"consumptionAmount",children:"Cantidad consumida"}),e.jsx(v,{children:e.jsx(I,{id:"consumptionAmount",...o,disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"consumptionFrequency",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"consumptionFrequency",children:"Frecuencia"}),e.jsx(v,{children:e.jsxs(pe,{onValueChange:o.onChange,defaultValue:o.value,value:o.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Selecciona la frecuencia"})}),e.jsxs(xe,{children:[e.jsx(te,{value:"diario",children:"Diario"}),e.jsx(te,{value:"semanal",children:"Semanal"}),e.jsx(te,{value:"mensual",children:"Mensual"}),e.jsx(te,{value:"ocasional",children:"Ocasional"})]})]})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"startAge",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"startAge",children:"Edad de inicio"}),e.jsx(v,{children:e.jsx(I,{...o,id:"startAge",type:"number",disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"duration",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"duration",children:"Duración del hábito"}),e.jsx(v,{children:e.jsx(I,{...o,id:"duration",disabled:l.isPending})}),e.jsx(C,{})]})})})]}),e.jsx(oe,{children:e.jsx(_,{type:"submit",className:"",children:"Guardar"})})]})})]})]})}function Sm({fileId:s}){const[a,r]=x.useState(!1),t=O(),n=J({resolver:W(Nm),defaultValues:{drugType:"",consumptionAmount:"",consumptionFrequency:"",startAge:"",duration:""}}),i=o=>{l.mutate(o)},l=$({mutationFn:async o=>{const d=await(await fetch(`/api/file/general/apnp/${s}/drogas`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();d.success||P.error(d.error),P.success("Información actualizada"),r(!1),t.invalidateQueries({queryKey:["apnp"]})}});return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{children:"Consumo de drogas"})})}),e.jsxs(V,{children:["Describe el consumo de Drogas ilegales del paciente"," "]})]})}),e.jsxs(Q,{className:"w-full",children:[e.jsxs(ie,{children:[e.jsx(X,{children:"Consumo de drogas"}),e.jsx(Ce,{children:"Describe el consumo de drogas del paciente."})]}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(i),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"drugType",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{children:"Tipo de drogas"}),e.jsx(v,{children:e.jsx(I,{...o,disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"consumptionAmount",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"consumptionAmount",children:"Cantidad consumida"}),e.jsx(v,{children:e.jsx(I,{id:"consumptionAmount",...o,disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"consumptionFrequency",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"consumptionFrequency",children:"Frecuencia"}),e.jsx(v,{children:e.jsxs(pe,{onValueChange:o.onChange,defaultValue:o.value,value:o.value,children:[e.jsx(me,{children:e.jsx(fe,{placeholder:"Selecciona la frecuencia"})}),e.jsxs(xe,{children:[e.jsx(te,{value:"diario",children:"Diario"}),e.jsx(te,{value:"semanal",children:"Semanal"}),e.jsx(te,{value:"mensual",children:"Mensual"}),e.jsx(te,{value:"ocasional",children:"Ocasional"})]})]})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"startAge",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"startAge",children:"Edad de inicio"}),e.jsx(v,{children:e.jsx(I,{...o,id:"startAge",type:"number",disabled:l.isPending})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"",children:e.jsx(w,{control:n.control,name:"duration",render:({field:o})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"duration",children:"Duración del hábito"}),e.jsx(v,{children:e.jsx(I,{...o,id:"duration",disabled:l.isPending})}),e.jsx(C,{})]})})})]}),e.jsx(oe,{children:e.jsx(_,{type:"submit",className:"",children:"Guardar"})})]})})]})]})}function Pm({fileId:s}){const{data:a}=T({queryKey:["apnp"],queryFn:async()=>(await(await D.file.apnp.$get({query:{fileId:s}})).json()).data});return e.jsxs("div",{children:[e.jsxs("div",{className:" flex gap-2",children:[e.jsx(wm,{fileId:s}),e.jsx(Cm,{fileId:s}),e.jsx(Sm,{fileId:s})]}),a&&e.jsx(Em,{antecedentes:a})]})}const Am=({title:s,data:a})=>e.jsxs("div",{className:"border bg-background rounded-sm sm:p-3 p-2 border-customborder",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("h2",{className:"text-sm font-bold mb-2",children:s.toUpperCase()})}),e.jsx("ul",{children:Object.entries(a).map(([r,{value:t,label:n}])=>e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-sm font-semibold",children:n}),e.jsxs("span",{className:"text-sm",children:[":  ",t]})]},r))})]}),Em=({antecedentes:s})=>{let[a,r]=x.useState(null);return e.jsx("div",{className:F("grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 my-2"),children:Object.entries(s).map(([t,n],i)=>e.jsxs("div",{className:"relative group block p-1 h-full w-full",onMouseEnter:()=>r(i),onMouseLeave:()=>r(null),children:[e.jsx(Ue,{children:a===i&&e.jsx(ue.span,{className:"absolute inset-0 h-full w-full bg-accent block rounded-md",layoutId:"hoverBackground",initial:{opacity:0},animate:{opacity:1,transition:{duration:.15}},exit:{opacity:0,transition:{duration:.15,delay:.2}}})}),e.jsx("div",{className:"z-20 overflow-hidden relative",children:e.jsx(Am,{title:t,data:n},t)})]},t))})},La=ce("/doctor/_doctor/general")({async validateSearch({id:s}){return s},component:qm});function qm(){const{id:s}=La.useSearch(),{data:a}=La.useRouteContext();if((a==null?void 0:a.doctor.specialtie)!=="GENERAL")return e.jsx("div",{children:"Not allowed"});const{data:t,isLoading:n,error:i}=T({queryKey:["file",s],queryFn:async()=>{const o=await(await D.patients.file.$get({query:{id:s}})).json();if(!o.success)throw new Error("Error al cargar el expediente");return o.data}});return n?e.jsx("div",{children:"Loading..."}):i||!t?e.jsx("div",{children:i==null?void 0:i.message}):e.jsx("div",{className:"px-4 pb-4 md:px-6 md:pb-6 lg:px-8 lg:pb-8",children:e.jsxs("div",{className:"mt-5 grid gap-6",children:[e.jsx(fr,{isPediatric:!1,patient:t,isAssistant:!1,isLoading:n,error:i}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg",children:"Familiares"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsxs("section",{className:"",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(de,{children:"Familiares"}),e.jsx(hr,{id:t.id})]}),e.jsx(jr,{id:t.id})]})})]}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg",children:"Antecedentes Familiares Patológicos"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsx(Tt,{fileId:t.fileId})})]}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg ",children:"Antecedentes Personales no Patológicos"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsx(Pm,{fileId:t.fileId})})]}),e.jsxs(ds,{className:"bg-background rounded-lg border",children:[e.jsxs(us,{className:"flex items-center justify-between px-6 py-4 cursor-pointer",children:[e.jsx("h2",{className:"text-lg ",children:"Antecedentes Personales Patológicos"}),e.jsx(Je,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(ms,{className:"p-6",children:e.jsx($t,{fileId:t.fileId})})]}),e.jsx(Ot,{speciality:"GENERAL",fileId:t.fileId}),e.jsx("div",{className:"my-2 sm:my-5 flex justify-end",children:e.jsx(Mt,{patientId:t.id})})]})})}const km=s=>new Date(s).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"}),Dm=async()=>{const a=await(await D.services.expensesAssistant.$get()).json();if(a.success===!1)throw new Error(a.error);return a.data??[]};function Bt({role:s}){const{data:a,isLoading:r,error:t}=T({queryKey:["expensesAssistant"],queryFn:Dm});if(r)return e.jsx("div",{children:"Cargando..."});if(t)return e.jsx("div",{children:t.message});const n=a==null?void 0:a.reduce((l,o)=>(l.cordobas+=o.cordobas,l.dollars+=o.dollars,l.total+=o.total,l),{cordobas:0,dollars:0,total:0}),i=s!=="DOCTOR"?"":"Gastos del día registrados por mi asistente";return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-lg m-3 font-medium",children:[i," "]}),e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Descripción"}),e.jsx(ae,{children:"Fecha"}),e.jsx(ae,{children:"Córdobas"}),e.jsx(ae,{children:"Dólares"}),e.jsx(ae,{children:"Total"})]})}),e.jsx(Te,{children:a==null?void 0:a.map((l,o)=>e.jsxs(le,{children:[e.jsx(z,{children:l.description}),e.jsx(z,{children:km(l.date)}),e.jsx(z,{children:L(l.cordobas)}),e.jsx(z,{children:Ne(l.dollars)}),e.jsx(z,{children:L(l.total)})]},o))}),e.jsx(Sa,{children:e.jsxs(le,{children:[e.jsx(z,{colSpan:2,children:"Total"}),e.jsx(z,{children:L((n==null?void 0:n.cordobas)??0)}),e.jsx(z,{children:Ne((n==null?void 0:n.dollars)??0)}),e.jsx(z,{children:L((n==null?void 0:n.total)??0)})]})})]})]})}function Im({cordobas:s,dollars:a}){const[r,t]=x.useState(!1),n=ks({description:Ae({required_error:"Descripción es requerida"}).min(4,"Mínimo 4 caracteres"),cordobas:ra().max(s,"La cantidad supera el monto disponible").default(0),dollars:ra().max(a,"La cantidad supera el monto disponible").default(0)}),i=J({resolver:W(n),defaultValues:{description:"",cordobas:0,dollars:0}}),l=O(),o=$({mutationFn:async u=>{const j=await(await D.services.expencesDoctor.$post({json:{description:u.description,cordobas:u.cordobas,dollars:u.dollars}})).json();if(!j.success){P.error(j.message);return}P.success("Registrado correctamente"),l.invalidateQueries({queryKey:["expensesDoc"]}),l.invalidateQueries({queryKey:["money"]}),t(!1)}});function c(u){o.mutate(u)}const d=u=>{const m=u.target.value;if(/^\d*$/.test(m))return i.trigger(),parseInt(m)||0};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{children:"Nuevo Gasto"})})}),e.jsx(V,{children:e.jsx("p",{children:"Registrar un gasto"})})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Nuevo Gasto"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(c),className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:"Disponible"}),e.jsxs("div",{children:[e.jsxs("p",{children:["Cordobas: ",L(s)]}),e.jsxs("p",{children:["Dólares: ",Ne(a)]})]})]}),e.jsx(w,{control:i.control,name:"description",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Descripción"}),e.jsx(v,{children:e.jsx(G,{placeholder:"Descripción",...u})}),e.jsx(C,{})]})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:i.control,name:"cordobas",render:({field:u})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"cordobasReceived",children:"Córdobas C$"}),e.jsx(v,{children:e.jsx(I,{id:"cordobasReceived",type:"text",inputMode:"numeric",pattern:"\\d*",value:u.value??"",onChange:m=>{const j=d(m);u.onChange(j)},className:" text-sm px-2"})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"dollars",render:({field:u})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"dollarsReceived",children:"Dólares $"}),e.jsx(v,{children:e.jsx(I,{id:"dollarsReceived",type:"text",inputMode:"numeric",pattern:"\\d*",value:u.value??"",onChange:m=>{const j=d(m);u.onChange(j)},className:" text-sm px-2"})}),e.jsx(C,{})]})})]}),e.jsx(_,{loading:o.isPending,type:"submit",children:"Guardar"})]})})]})]})}const Fm=s=>new Date(s).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"});function Rm(){const{data:s,isPending:a,error:r}=T({queryKey:["expensesDoc"],queryFn:async()=>{const o=await(await D.services.expensesDoctor.$get({query:{q:new Date().toISOString()}})).json();if(o.success===!1)throw new Error("Error al obtener los gastos");return o.data??[]}}),t=s==null?void 0:s.reduce((l,o)=>(l.cordobas+=o.cordobas,l.dollars+=o.dollars,l.total+=o.total,l),{cordobas:0,dollars:0,total:0});if(r)return e.jsx("div",{children:r.message});const{data:n,isPending:i}=T({queryKey:["money"],queryFn:async()=>(await(await D.services.moneyDoctor.$get()).json()).data});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-lg m-3 font-medium",children:"Mis gastos"}),!i&&e.jsx(Im,{cordobas:(n==null?void 0:n.cordobas)??0,dollars:(n==null?void 0:n.dollars)??0})]}),e.jsxs(Re,{children:[e.jsx(Me,{children:e.jsxs(le,{children:[e.jsx(ae,{children:"Descripción"}),e.jsx(ae,{children:"Fecha"}),e.jsx(ae,{children:"Córdobas"}),e.jsx(ae,{children:"Dólares"}),e.jsx(ae,{children:"Total"})]})}),e.jsx(Te,{children:s==null?void 0:s.map((l,o)=>e.jsxs(le,{children:[e.jsx(z,{children:l.description}),e.jsx(z,{children:Fm(l.date)}),e.jsx(z,{children:L(l.cordobas)}),e.jsx(z,{children:Ne(l.dollars)}),e.jsx(z,{children:L(l.total)})]},o))}),e.jsx(Sa,{children:e.jsxs(le,{children:[e.jsx(z,{colSpan:2,children:"Total"}),e.jsx(z,{children:L((t==null?void 0:t.cordobas)??0)}),e.jsx(z,{children:Ne((t==null?void 0:t.dollars)??0)}),e.jsx(z,{children:L((t==null?void 0:t.total)??0)})]})})]})]})}const Mm=ce("/doctor/_doctor/expenses")({component:Tm});function Tm(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"m-4 sm:m-8",children:e.jsx(Bt,{role:"DOCTOR"})}),e.jsx("div",{className:"m-4 sm:m-8",children:e.jsx(Rm,{})})]})}const Ut=({data:s,onRemove:a})=>e.jsxs("div",{className:"flex items-center gap-1 px-2 bg-accent rounded h-10 my-1",children:[e.jsx("p",{className:"flex-1 text-sm font-semibold",children:s}),e.jsx(E,{variant:"destructive",size:"icon",className:"w-6 h-6",onClick:a,children:e.jsx(Ba,{className:"h-3 w-3"})})]}),$m=()=>{var m,j,p;const s=O(),[a,r]=x.useState(!1),[t,n]=x.useState(""),i=J({resolver:W(ir),defaultValues:{presentations:[]}}),l=()=>{if(t==="")return;const f=i.getValues("presentations");if(f.find(q=>q===t))return;const N=[...f,t.toLowerCase()];i.setValue("presentations",N),n("")},o=(f,N)=>{N.stopPropagation(),N.preventDefault();const A=i.getValues("presentations").filter(R=>R!==f);i.setValue("presentations",A)},c=f=>{f.key==="Enter"&&(f.preventDefault(),l())},d=$({mutationFn:async f=>{const q=await(await D.drugs.$post({json:f})).json();if(!q.success)if(q.error==="El fármaco ya existe"){i.setError("tradeName",{message:q.error});return}else throw new Error(q.error);return i.reset(),P.success("Fármaco agregado correctamente"),s.invalidateQueries({queryKey:["listdrugs"]}),r(!1),q},onError:f=>{P.error(`Error: ${f.message}`)}}),u=f=>{d.mutate(f)};return e.jsxs(Z,{open:a,onOpenChange:r,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsxs(E,{children:["Nuevo Fármaco",e.jsx(ma,{className:"ml-2"})]})})}),e.jsx(V,{children:"Agrega un nuevo fármaco"})]})}),e.jsxs(Q,{children:[e.jsx(X,{children:"Nuevo Fármaco"}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(u),children:[e.jsx(w,{control:i.control,name:"tradeName",render:({field:f})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre comercial"}),e.jsx(v,{children:e.jsx(I,{...f,disabled:d.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"genericName",render:({field:f})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre genérico"}),e.jsx(v,{children:e.jsx(I,{value:f.value??"",onChange:N=>{f.onChange(N.target.value)},disabled:d.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(y,{children:"Presentaciones"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{value:t,onChange:f=>n(f.target.value),disabled:d.isPending,type:"text",placeholder:"Nueva presentación",onKeyDown:c}),e.jsx(E,{type:"button",onClick:l,disabled:d.isPending,children:"Agregar"})]}),e.jsx(C,{children:(m=i.formState.errors.presentations)==null?void 0:m.message}),e.jsx("div",{className:"mt-2 flex justify-center",children:((j=i.watch("presentations"))==null?void 0:j.length)>0&&e.jsx(As,{className:"h-auto max-h-60 w-[350px] rounded-md border p-2",children:(p=i.watch("presentations"))==null?void 0:p.map((f,N)=>e.jsx(Ut,{data:f,onRemove:q=>o(f,q)},N))})})]}),e.jsx(_,{type:"submit",loading:d.isPending,className:"mt-2 w-full mr-2 inline-flex items-center",children:"Guardar"})]})})]})]})},zm=s=>{const a=O(),r=$({mutationFn:async()=>P.promise(D.drugs.change[":id"].$patch({param:{id:s.id}}).then(n=>n.json()),{loading:"Deshabilitando fármaco...",success:n=>{if(!n.success)throw new Error("Ocurrió un error");return a.invalidateQueries({queryKey:["listdrugs"]}),P.success("Cambios realizados"),"Fármaco deshabilitado"},error:"Error al deshabilitar el fármaco"}),onError:n=>{P.error(`${n.message}`)}}),t=()=>{P.custom(n=>e.jsxs("div",{className:"p-4 bg-destructive border rounded-sm  ",children:[e.jsxs("div",{className:"w-full",children:["¿Deseas deshabilitar este fármaco? ",e.jsx("br",{}),e.jsx("p",{className:"font-bold",children:s.tradeName})]}),e.jsxs("div",{className:"flex gap-2 justify-end mt-2",children:[e.jsx(E,{variant:"secondary",onClick:()=>P.dismiss(n),children:"No"}),e.jsx(E,{onClick:()=>{P.dismiss(n),r.mutate()},children:"Si"})]})]}),{duration:1/0})};return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{onClick:t,variant:"destructive",size:"icon",children:e.jsx(Tl,{})})}),e.jsx(V,{children:"Deshabilitar fármaco"})]})})},Om=s=>{var p,f;const[a,r]=x.useState(""),[t,n]=x.useState(!1),i=O(),l=J({resolver:W(ir),defaultValues:{tradeName:s.tradeName,genericName:s.genericName||"",presentations:s.presentations||[]}}),o=()=>{if(a==="")return;const N=l.getValues("presentations");if(N.find(A=>A===a))return;const q=[...N,a.toLowerCase()];l.setValue("presentations",q),r("")},c=(N,q)=>{q.stopPropagation(),q.preventDefault();const R=l.getValues("presentations").filter(k=>k!==N);l.setValue("presentations",R)},d=$({mutationFn:async N=>{const A=await(await D.drugs[":id"].$patch({param:{id:s.id},json:N})).json();A.success?(P.success("Fármaco actualizado correctamente"),i.invalidateQueries({queryKey:["listdrugs"]})):P.error(A.error),n(!1)}}),u=N=>{d.mutate(N)},m=N=>{N||l.reset({tradeName:s.tradeName,genericName:s.genericName,presentations:s.presentations}),n(N)},j=N=>{N.key==="Enter"&&(N.preventDefault(),o())};return e.jsxs(Z,{open:t,onOpenChange:m,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:"destructive",size:"icon",children:e.jsx($l,{})})})}),e.jsx(V,{children:"Actualizar fármaco"})]})}),e.jsxs(Q,{children:[e.jsxs(X,{children:["Actualizar fármaco:"," ",e.jsx("span",{className:"font-bold",children:s.tradeName})]}),e.jsx(ee,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(u),children:[e.jsx(w,{control:l.control,name:"genericName",render:({field:N})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre genérico"}),e.jsx(v,{children:e.jsx(I,{value:N.value??"",onChange:N.onChange,disabled:d.isPending,type:"text"})}),e.jsx(C,{})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(y,{children:"Presentaciones"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{value:a,onChange:N=>r(N.target.value),type:"text",placeholder:"Nueva presentación",disabled:d.isPending,onKeyDown:j}),e.jsx(E,{disabled:d.isPending,type:"button",onClick:o,children:"Agregar"})]}),e.jsx(C,{children:(p=l.formState.errors.presentations)==null?void 0:p.message}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(As,{className:"h-auto sm:w-[200px]  sm:p3",children:(f=l.watch("presentations"))==null?void 0:f.map((N,q)=>e.jsx(Ut,{data:N,onRemove:A=>c(N,A)},q))})})]}),e.jsx(oe,{children:e.jsx(_,{disabled:d.isPending,loading:d.isPending,type:"submit",children:"Actualizar"})})]})})]})]})};function _m({id:s,tradeName:a}){const r=O(),t=$({mutationFn:async()=>{const l=await(await D.drugs[":id"].$delete({param:{id:s}})).json();if(!l.success){P.error(l.error);return}P.success("Fármaco eliminado"),r.invalidateQueries({queryKey:["listdrugs"]})}}),n=()=>{P.custom(i=>e.jsxs("div",{className:"p-4 bg-destructive border rounded-sm  ",children:[e.jsx("div",{className:"w-full",children:"¿Está seguro de que deseas eliminar este fármaco?"}),e.jsx("div",{className:"my-2 font-semibold text-lg",children:e.jsx("p",{children:a})}),e.jsxs("div",{className:"flex gap-2 justify-end mt-2",children:[e.jsx(E,{variant:"secondary",onClick:()=>P.dismiss(i),children:"No"}),e.jsx(E,{onClick:()=>{P.dismiss(i),t.mutate()},children:"Si"})]})]}),{duration:1/0})};return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{onClick:n,size:"icon",variant:"destructive",children:e.jsx(Ja,{})})}),e.jsx(V,{children:"Borrar fármaco"})]})})}const Lm=[{accessorKey:"tradeName",header:({column:s})=>e.jsxs(E,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre Comercial",e.jsx(Os,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"genericName",header:({column:s})=>e.jsxs(E,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre Genérico",e.jsx(Os,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"presentations",header:"Presentaciones",cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"flex gap-1",children:a.presentations.map((r,t)=>e.jsx("p",{className:"text-sm bg-accent p-1 rounded-sm",children:r},t))})}},{accessorKey:"id",header:"",cell:({row:s})=>{const a=s.original;return e.jsxs("div",{className:"flex gap-2",children:[e.jsx(zm,{id:a.id,tradeName:a.tradeName}),e.jsx(Om,{id:a.id,tradeName:a.tradeName,genericName:a.genericName,presentations:a.presentations}),e.jsx(_m,{id:a.id,tradeName:a.tradeName})]})}}],Vm=ce("/doctor/_doctor/drugs")({component:Km});function Km(){const[s,a]=x.useState({pageIndex:0,pageSize:10}),{data:r}=T({queryKey:["listdrugs",s.pageIndex,s.pageSize],placeholderData:qs,queryFn:async()=>{const n=await(await D.drugs.$get({query:{page:s.pageIndex+1,pageSize:s.pageSize}})).json();if(!n.success)throw new Error("Error al cargar la lista de fármacos");return n.data}});return e.jsx("div",{children:e.jsx("section",{className:"flex mx-2 max-h-screen",children:e.jsxs("div",{className:"sm:mx-20 mx-5 w-full h-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-lg m-3 font-medium",children:"Fármacos"}),e.jsx($m,{})]}),e.jsx(Ts,{columns:Lm,data:(r==null?void 0:r.data)??[],pageCount:(r==null?void 0:r.pagination.totalPages)??0,onPaginationChange:t=>{a(t)}})]})})})}function Ss({customEvent:s,view:a}){return e.jsxs(Z,{children:[e.jsxs(U,{className:"w-full ",children:[a==="month"&&e.jsxs("div",{className:"flex items-center justify-between ",children:[e.jsx("span",{children:s.patient}),e.jsx(qa,{})]}),a==="week"&&e.jsx(E,{variant:"secondary",size:"icon",className:"flex items-center w-6 h-6 rounded-xs",children:e.jsx(qa,{className:"w-4 h-4 "})}),a==="day"&&e.jsx(E,{variant:"secondary",size:"icon",className:"flex items-center w-6 h-6 rounded-xs",children:e.jsx(qa,{className:"w-4 h-4 "})})]}),e.jsxs(Q,{className:"w-auto bg-card border-customborder text-lg",children:[e.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Es,{children:e.jsx(Gs,{className:"",children:e.jsx(zl,{})})}),e.jsx("div",{children:e.jsx("h4",{className:"font-semibold",children:s.patient})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ol,{className:"w-4 h-4 text-primary "}),e.jsx("span",{className:"text-primary",children:s.start?Y(new Date(s.start),"dd-MM-yyyy"):""})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground ",children:[e.jsx(_l,{className:"w-4 h-4 text-primary "}),e.jsx("span",{className:"text-primary",children:s.start&&s.end?`${Y(new Date(s.start),"hh:mm a")} - ${Y(new Date(s.end),"hh:mm a")}`:""})]})]}),a==="month"&&e.jsx("div",{children:e.jsx(Ls,{id:s.id})}),a==="week"&&e.jsx("div",{children:e.jsx(Ls,{id:s.id})})]})]})}function Hm({Events:s}){const[a,r]=x.useState("week"),[t,n]=x.useState(new Date),{setValue:i,watch:l}=da(),{theme:o}=er(),d=Fn({format:Y,parse:yn,startOfWeek:()=>"Sunday",getDay:bn,locales:{es:ze}});x.useEffect(()=>{const k=()=>{window.innerWidth<768?r("day"):r("week")};return window.addEventListener("resize",k),k(),()=>{window.removeEventListener("resize",k)}},[]);const u=k=>{switch(k){case"NEXT":n(g=>a==="month"?wn(g,1):a==="week"?Cn(g,1):Sn(g,1));break;case"PREV":n(g=>a==="month"?vn(g,1):a==="week"?Nn(g,1):xa(g,1));break;case"TODAY":n(new Date);break}},m=k=>{const g=new Date;new Date(k).setHours(0,0,0,0)>=g.setHours(0,0,0,0)&&n(new Date(k))};x.useEffect(()=>{const k=l("date");k&&n(new Date(k))},[l("date")]);const j=({event:k})=>{const g=k;return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center relative",children:[e.jsx("p",{className:"font-bold text-sm",children:g.patient}),e.jsxs("div",{className:"flex items-center gap-1 md:absolute md:right-0",children:[e.jsx(Ls,{id:g.id}),e.jsx(Ss,{customEvent:g,view:"day"})]})]})},p=({event:k})=>{const g=k;return e.jsx(Ss,{customEvent:g,view:"month"})},f=({event:k})=>{const g=k;return e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("div",{className:"w-3/8 text-xs font-bold",children:g.patient}),e.jsx("div",{className:"w-1/8",children:e.jsx(Ss,{customEvent:g,view:"week"})})]})},N=["#4E1511","#4E1325","#3D224E","#262A65","#003848","#0B3B2C","#1D3A24","#462100","#362B00","#29371D","#003A38"],q=["#FF977D","#FF949D","#D19DFF","#B1A9FF","#4CCCE6","#1FD8A4","#71D083","#FFA057","#F5E147","#BDE56C","#58D5BA"],A=k=>k[Math.floor(Math.random()*k.length)],R=()=>({style:{color:o==="dark"?"white":"black",backgroundColor:A(o==="dark"?N:q)}});return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"mt-4 w-full grid grid-rows-3 gap-3 mb-2 sm:flex sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"flex justify-center sm:justify-start",children:[e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>r("month"),children:"Mes"}),e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>r("week"),children:"Semana"}),e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>r("day"),children:"Día"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"font-bold",children:Y(t,"dd MMMM yyyy",{locale:ze})})}),e.jsx("div",{className:"flex justify-center sm:justify-end",children:e.jsx(B,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(E,{onClick:()=>u("PREV"),variant:"outline",size:"icon",children:[e.jsx(Qa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Ir a la fecha anterior"})]})}),e.jsx(V,{children:"Ir a la fecha anterior"})]}),e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(E,{onClick:()=>u("TODAY"),variant:"outline",children:"Hoy"})}),e.jsx(V,{children:"Ir a la fecha de hoy"})]}),e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(E,{onClick:()=>u("NEXT"),variant:"outline",size:"icon",children:[e.jsx(Ya,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Ir a la fecha siguiente"})]})}),e.jsx(V,{children:"Ir a la fecha siguiente"})]})]})})})]}),e.jsx(Rn,{view:a,events:s,localizer:d,style:{height:"100vh",zIndex:40},views:["month","week","day"],min:na(ta(new Date,0),6),max:na(ta(new Date,0),19),toolbar:!1,culture:"es",formats:{eventTimeRangeFormat:({start:k,end:g})=>`${Y(k,"p")} – ${Y(g,"p")}`,eventTimeRangeStartFormat:({start:k})=>`${Y(k,"h:mma")} – `,eventTimeRangeEndFormat:({end:k})=>Y(k,"h:mma"),timeGutterFormat:k=>Y(k,"h:mm a")},components:{day:{event:j},month:{event:p},week:{event:f}},date:t,selectable:!1,eventPropGetter:R,onSelectSlot:k=>k.start&&m(k.start),onNavigate:(k,g)=>{i("date",k),n(k),r(g)},onView:k=>r(k)})]})}function Qt({patient:s}){const{control:a,setValue:r,watch:t,handleSubmit:n}=da(),i=O();x.useEffect(()=>{s!=null&&r("patient",s)},[s]);const l=$({mutationFn:async u=>{const j=await(await D.dates.$post({json:u})).json();if(j.success)return P.success("Cita agendada correctamente"),i.invalidateQueries({queryKey:["listDates"]}),i.invalidateQueries({queryKey:["upcomingDates"]}),j;P.error(j.error)},onError:u=>{P.error(u.message)}}),o=u=>{const[m,j,p]=u.split(":"),f=new Date;return f.setHours(parseInt(m)),f.setMinutes(parseInt(j)),f.setSeconds(parseInt(p)),f.setMilliseconds(0),f},c=u=>{const m=u.getHours().toString().padStart(2,"0"),j=u.getMinutes().toString().padStart(2,"0"),p=u.getSeconds().toString().padStart(2,"0");return`${m}:${j}:${p}`},d=async u=>{l.mutate(u)};return e.jsxs("form",{onSubmit:n(d),className:"w-full sm:p-4 sm:my-2 flex flex-col sm:flex-row justify-center sm:gap-4 items-center",children:[e.jsx("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:e.jsx(w,{control:a,name:"patient",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Paciente:"}),e.jsx(v,{children:e.jsx(jt,{patient:s||null,onSelect:m=>{u.onChange({id:m.id,name:m.name,fileId:m.fileId})}})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:e.jsx(w,{control:a,name:"date",render:()=>e.jsxs(b,{children:[e.jsx(y,{children:"Día Seleccionado:"}),e.jsx(v,{children:e.jsx("div",{children:e.jsx(Ys,{granularity:"day",locale:ze,weekStartsOn:0,displayFormat:{hour24:"dd/MM/yyyy"},onChange:u=>{u!=null&&r("date",u)},value:t("date")})})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:e.jsx(w,{control:a,name:"start",render:()=>e.jsxs(b,{children:[e.jsx(y,{children:"Desde:"}),e.jsx(v,{children:e.jsx(Vs,{hourCycle:12,granularity:"minute",date:o(t("start")),onChange:u=>{if(u==null)return;c(u),r("start",c(u));const m=u;m.setHours(m.getHours()+1),r("end",c(m))}})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"w-full sm:w-auto mb-4 sm:mb-0",children:e.jsx(w,{control:a,name:"end",render:()=>e.jsxs(b,{children:[e.jsx(y,{children:"Hasta:"}),e.jsx(v,{children:e.jsx(Vs,{hourCycle:12,granularity:"minute",date:o(t("end")),onChange:u=>{u!=null&&r("end",c(u))}})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"mt-8 w-full sm:w-auto mb-4 sm:mb-0 flex justify-end",children:e.jsx(_,{type:"submit",className:"justify-end",children:"Agendar"})})]})}const Gm=h.object({id:h.string(),fileId:h.string(),name:h.string()}),Yt=h.object({date:h.date({required_error:"Este campo es requerido"}),start:h.string({required_error:"Este campo es requerido"}).time(),end:h.string({required_error:"Este campo es requerido"}).time(),patient:Gm}).refine(s=>{const{start:a,date:r}=s,t=new Date(r),[n,i,l]=a.split(":");return t.setHours(parseInt(n),parseInt(i),parseInt(l)),t>=new Date},{message:"Hora incorrecta",path:["start"]}).refine(s=>{const{start:a,end:r,date:t}=s,n=new Date(t),[i,l,o]=r.split(":");return n.setHours(parseInt(i),parseInt(l),parseInt(o)),n>=new Date},{message:"Hora incorrecta",path:["end"]}).refine(s=>{const{start:a,end:r}=s,[t,n,i]=a.split(":"),l=new Date;l.setHours(parseInt(t),parseInt(n),parseInt(i));const[o,c,d]=r.split(":"),u=new Date;return u.setHours(parseInt(o),parseInt(c),parseInt(d)),l<u},{message:"Horarios incorrectos",path:["end"]}).refine(s=>{const{date:a}=s,{start:r,end:t}=s,[n,i,l]=r.split(":");return a.setHours(parseInt(n),parseInt(i),parseInt(l)),a>new Date},{message:"Fecha incorrecta",path:["date"]}).refine(s=>{const{start:a,end:r}=s,[t,n,i]=a.split(":"),l=new Date;l.setHours(parseInt(t),parseInt(n),parseInt(i));const[o,c,d]=r.split(":"),u=new Date;u.setHours(parseInt(o),parseInt(c),parseInt(d));const m=u.getTime()-l.getTime(),j=Math.round(m/1e3/60);return j>=30&&j<=120},{message:"La duración debe ser de entre 30 y 120 minutos",path:["end"]}).refine(s=>{const{start:a}=s,[r,t,n]=a.split(":"),i=new Date;i.setHours(parseInt(r),parseInt(t),parseInt(n));const l=new Date;l.setHours(6);const o=new Date;return o.setHours(18),o.setMinutes(30),i>=l&&i<=o},{message:"6:00 AM - 6:30 PM",path:["start"]}).refine(s=>{const{end:a}=s,[r,t,n]=a.split(":"),i=new Date;i.setHours(parseInt(r),parseInt(t),parseInt(n));const l=new Date;l.setHours(6),l.setMinutes(30);const o=new Date;return o.setHours(19),o.setMinutes(0),i>=l&&i<=o},{message:"6:30 AM - 7:00 PM",path:["end"]}),Wt=ce("/doctor/_doctor/dates")({component:Bm,async validateSearch({id:s}){return s}});function Bm(){const{id:s}=Wt.useSearch(),{data:a=[],isLoading:r,isError:t}=T({queryKey:["listDates"],queryFn:async()=>{const o=await(await D.dates.$get()).json();if(!o.success)throw new Error("Error al cargar la lista de citas");return o.data.map(d=>({...d,start:new Date(d.start),end:new Date(d.end)}))}}),{data:n}=T({queryKey:["patientSearch",s],queryFn:async()=>{if(!s)return null;const o=await(await D.patients.id.$get({query:{id:s}})).json();return o.success?o.data:null},enabled:!!s}),i=J({resolver:W(Yt),defaultValues:{start:"08:00:00",end:"09:00:00",date:new Date}});return e.jsx(Wa,{...i,children:e.jsx("section",{className:"flex mx-2 max-h-screen",children:e.jsxs("div",{className:"w-full h-full mx-2",children:[e.jsxs("div",{className:"w-full   justify-center",children:[e.jsx("p",{className:"text-lg text-center font-medium",children:"Agendar una cita"}),e.jsx(Qt,{patient:n||null})]}),e.jsx("div",{className:"mb-20",children:r?e.jsx("p",{children:"Loading..."}):t?e.jsx("p",{children:"Error al cargar los eventos"}):e.jsx(Hm,{Events:a})}),e.jsx("div",{className:"mb-20"})]})})})}function Um({cordobas:s,dollars:a}){const[r,t]=x.useState(!1),n=ks({description:Ae().min(1,"La descripción es requerida"),cordobas:ra().max(s,"La cantidad supera el monto disponible").default(0),dollars:ra().max(a,"La cantidad supera el monto disponible").default(0)}),i=J({resolver:W(n),defaultValues:{description:"",cordobas:0,dollars:0}}),l=O(),o=$({mutationFn:async u=>{const j=await(await D.services.expencesAssistant.$post({json:{description:u.description,cordobas:u.cordobas,dollars:u.dollars}})).json();j.success||P.error(j.message),P.success("Registrado correctamente"),l.invalidateQueries({queryKey:["money"]}),l.invalidateQueries({queryKey:["expensesAssistant"]}),t(!1)}});function c(u){o.mutate(u)}const d=u=>{const m=u.target.value;if(/^\d*$/.test(m))return i.trigger(),parseInt(m)||0};return e.jsxs(Z,{open:r,onOpenChange:t,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{children:"Nuevo Gasto"})})}),e.jsx(V,{children:e.jsx("p",{children:"Registrar un gasto"})})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsx(ie,{children:e.jsx(X,{children:"Nuevo Gasto"})}),e.jsx(ee,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(c),className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:"Disponible"}),e.jsxs("div",{children:[e.jsxs("p",{children:["Cordobas: ",L(s)]}),e.jsxs("p",{children:["Dólares: ",Ne(a)]})]})]}),e.jsx(w,{control:i.control,name:"description",render:({field:u})=>e.jsxs(b,{children:[e.jsx(y,{children:"Descripción"}),e.jsx(v,{children:e.jsx(G,{placeholder:"Descripción",...u})}),e.jsx(C,{})]})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(w,{control:i.control,name:"cordobas",render:({field:u})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"cordobasReceived",children:"Córdobas C$"}),e.jsx(v,{children:e.jsx(I,{id:"cordobasReceived",type:"text",inputMode:"numeric",pattern:"\\d*",value:u.value??"",onChange:m=>{const j=d(m);u.onChange(j)},className:" text-sm px-2"})}),e.jsx(C,{})]})}),e.jsx(w,{control:i.control,name:"dollars",render:({field:u})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(y,{htmlFor:"dollarsReceived",children:"Dólares $"}),e.jsx(v,{children:e.jsx(I,{id:"dollarsReceived",type:"text",inputMode:"numeric",pattern:"\\d*",value:u.value??"",onChange:m=>{const j=d(m);u.onChange(j)},className:" text-sm px-2"})}),e.jsx(C,{})]})})]}),e.jsx(_,{loading:o.isPending,type:"submit",children:"Guardar"})]})})]})]})}const Qm=ce("/assistant/_assistant/services")({component:Ym});function Ym(){const{data:s}=T({queryKey:["money"],queryFn:async()=>(await(await D.services.moneyAssistant.$get()).json()).data}),a={initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5}},r=[{title:"Efectivo Total",value:L((s==null?void 0:s.total)??0)},{title:"Córdobas",value:L((s==null?void 0:s.cordobas)??0)},{title:"Dólares",value:Ne((s==null?void 0:s.dollars)??0)},{title:"Gastos del día",value:L((s==null?void 0:s.assitantExpenses)??0)}];return e.jsxs("div",{className:"mx-4 sm:mx-8",children:[e.jsx("div",{className:"grid gap-3  grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 my-6",children:r.map((t,n)=>e.jsx(ue.div,{...a,transition:{delay:n*.1},children:e.jsxs(ge,{className:"h-full",children:[e.jsx(ve,{className:"p-3",children:e.jsx(we,{className:"text-sm font-medium text-primary",children:t.title})}),e.jsx(be,{className:"p-3 pt-0",children:t.value!==void 0?e.jsx("p",{className:"text-lg font-semibold text-secondary-foreground",children:t.value}):e.jsx("p",{className:"text-lg font-semibold text-muted"})})]})},t.title))}),e.jsxs("div",{className:"w-full mt-20",children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold",children:"Pendientes"}),e.jsx(pt,{role:"ASSISTANT"})]}),e.jsxs("div",{className:"flex w-full mt-20 justify-between gap-2 ",children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold",children:"Gastos del día"}),e.jsx(Um,{cordobas:(s==null?void 0:s.cordobas)??0,dollars:(s==null?void 0:s.dollars)??0})]}),e.jsx("div",{className:"mb-20",children:e.jsx(Bt,{role:"ASSISTANT"})})]})}const Va=ce("/assistant/_assistant/queries")({component:Wm,async validateSearch({id:s}){return s}});function Wm(){const{querieId:s}=Va.useSearch(),{data:a}=Va.useRouteContext(),{data:r,isPending:t,error:n}=T({queryKey:["pediatricQuery",s],queryFn:async()=>{if(!s||a.assistant.specialtie!=="PEDIATRIA")return null;const l=await(await D.queries.data.$get({query:{querieId:s}})).json();if(!l.success)throw new Error(l.error);return l.data}});return a.assistant.specialtie!=="PEDIATRIA"?e.jsx("div",{className:" flex justify-center items-center",children:e.jsx("p",{className:"bg-destructive text-sm font-semibold p-4 rounded-sm",children:"No tienes acceso"})}):e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("p",{className:"text-2xl font-semibold",children:"Brindar Atención"})}),n&&e.jsx("div",{className:" flex justify-center items-center",children:e.jsx("p",{className:"bg-destructive text-sm font-semibold p-4 rounded-sm",children:"Error al cargar consulta"})}),t&&e.jsx("div",{children:"Cargando consulta..."}),!t&&r&&e.jsxs("section",{className:"p-6 sm:m-8 mx-6",children:[e.jsxs("div",{className:"flex  justify-center sm:space-x-8 items-center  text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center space-x-2 ",children:[e.jsx("div",{className:"mr-4 flex items-end",children:e.jsx(Ca,{patientName:r.name,patientId:r.patientId,size:"24"})}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Paciente:"}),e.jsx("span",{className:"block text-xl font-semibold",children:r.name})]})]}),e.jsxs("div",{className:"",children:[e.jsx(de,{className:"text-sm font-medium",children:"Expediente:"}),e.jsx("span",{className:"block text-xl font-semibold",children:r.idFile})]}),r.emergency&&e.jsx("div",{className:"",children:e.jsx(de,{className:"mt-6 inline-block bg-destructive text-lg font-semibold py-1 px-3 rounded-full",children:"Emergencia"})})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:r&&e.jsx(nr,{querieId:r.id})})]})]})}const Jt=s=>{const a=[{accessorKey:"name",header:({column:r})=>e.jsxs(E,{variant:"ghost",onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),children:["Nombre",e.jsx(Os,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"sex",header:"Sexo"},{accessorKey:"origin",header:"Origen"},{accessorKey:"date",header:"Edad",cell:({row:r})=>Zm(r)},{accessorKey:"date",header:"Nacimiento",cell:({row:r})=>Jm(r)},{accessorKey:"address",header:"Dirección"}];return s==="general"&&(a.push({accessorKey:"phone",header:"Teléfono",cell:({row:r})=>{const t=r.original.phone;return t?ls(t.toString()):e.jsx("div",{})}}),a.push({accessorKey:"dni",header:"Cédula"})),a.push({id:"id",header:"Acciones",cell:({row:r})=>Xm(r)}),a};function Jm(s){const r=new Date(s.getValue("date")).toLocaleDateString();return e.jsx("div",{className:"font-medium",children:r})}function Zm(s){const a=new Date(s.getValue("date")),r=new Date;let t=r.getFullYear()-a.getFullYear();return(r.getMonth()<a.getMonth()||r.getMonth()===a.getMonth()&&r.getDate()<a.getDate())&&t--,t}function Xm(s){return e.jsxs("div",{className:"flex space-x-2",children:[ex(s),sx(s),e.jsx(Pa,{id:s.original.id})]})}function ex(s){const a=s.original;return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{children:e.jsx(qe,{to:`/assistant/file?id=${a.fileId}`,children:e.jsx(E,{variant:"outline",size:"icon",children:e.jsx(xn,{})})})}),e.jsx(V,{children:"Ver Expediente"})]})})}function sx(s){const a=s.original;return e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{children:e.jsx(qe,{to:`/assistant/dates?id=${a.id}`,children:e.jsx(E,{variant:"outline",size:"icon",children:e.jsx(hn,{})})})}),e.jsx(V,{children:"Agendar una cita"})]})})}const ax=Jt("pediatric"),rx=Jt("general"),Zt=ce("/assistant/_assistant/patients")({component:nx});function nx(){const{data:s}=Zt.useRouteContext(),[a,r]=x.useState({pageIndex:0,pageSize:10}),t=(s==null?void 0:s.assistant.specialtie)==="GENERAL"?rx:ax,{data:n}=T({queryKey:["listPatients",a.pageIndex,a.pageSize],placeholderData:qs,queryFn:async()=>{const l=await(await D.patients.all.$get({query:{page:a.pageIndex+1,pageSize:a.pageSize}})).json();if(!l.success)throw new Error("Error al cargar la lista de pacientes");return l.data}});return e.jsxs(e.Fragment,{children:[(s==null?void 0:s.assistant.specialtie)==="GENERAL"?e.jsx(Ht,{}):e.jsx(Gt,{}),e.jsx("div",{className:"mt-4 mx-3 sm:mx-5",children:e.jsx(Ts,{columns:t,data:(n==null?void 0:n.data)??[],pageCount:(n==null?void 0:n.pagination.totalPages)??0,onPaginationChange:i=>{r(i)}})})]})}const Ka=ce("/assistant/_assistant/file")({component:tx,async validateSearch({id:s}){return s}});function tx(){const{id:s}=Ka.useSearch(),{data:a}=Ka.useRouteContext(),{data:r,isLoading:t,error:n}=T({queryKey:["file",s],queryFn:async()=>{const l=await(await D.patients.file.$get({query:{id:s}})).json();if(!l.success)throw new Error("Error al cargar el expediente");return l.data}});return n||!r?e.jsx("div",{children:n==null?void 0:n.message}):e.jsxs("div",{className:"grid gap-6 px-4 pb-4 md:px-6 md:pb-6 lg:px-8 lg:pb-8",children:[e.jsx(fr,{patient:r,isLoading:t,error:n,isAssistant:!0,isPediatric:(a==null?void 0:a.assistant.specialtie)!=="GENERAL"}),e.jsxs("div",{className:"sm:p-6 p-4 rounded-sm border border-customborder",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{children:"Familiares"}),e.jsx(hr,{id:r.id})]}),e.jsx("div",{children:e.jsx(jr,{id:r.id})})]})]})}function ix({Events:s}){const[a,r]=x.useState("week"),[t,n]=x.useState(new Date),{setValue:i,watch:l}=da(),{theme:o}=er(),d=Fn({format:Y,parse:yn,startOfWeek:()=>"Sunday",getDay:bn,locales:{es:ze}});x.useEffect(()=>{const k=()=>{window.innerWidth<768?r("day"):r("week")};return window.addEventListener("resize",k),k(),()=>{window.removeEventListener("resize",k)}},[]);const u=k=>{switch(k){case"NEXT":n(g=>a==="month"?wn(g,1):a==="week"?Cn(g,1):Sn(g,1));break;case"PREV":n(g=>a==="month"?vn(g,1):a==="week"?Nn(g,1):xa(g,1));break;case"TODAY":n(new Date);break}},m=k=>{const g=new Date;new Date(k).setHours(0,0,0,0)>=g.setHours(0,0,0,0)&&n(new Date(k))};x.useEffect(()=>{const k=l("date");k&&n(new Date(k))},[l("date")]);const j=({event:k})=>{const g=k;return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center relative",children:[e.jsx("p",{className:"font-bold text-sm",children:g.patient}),e.jsxs("div",{className:"flex items-center gap-1 md:absolute md:right-0",children:[e.jsx(Ls,{id:g.id}),e.jsx(Ss,{customEvent:g,view:"day"})]})]})},p=({event:k})=>{const g=k;return e.jsx(Ss,{customEvent:g,view:"month"})},f=({event:k})=>{const g=k;return e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("div",{className:"w-3/8 text-xs font-bold",children:g.patient}),e.jsx("div",{className:"w-1/8",children:e.jsx(Ss,{customEvent:g,view:"week"})})]})},N=["#4E1511","#4E1325","#3D224E","#262A65","#003848","#0B3B2C","#1D3A24","#462100","#362B00","#29371D","#003A38"],q=["#FF977D","#FF949D","#D19DFF","#B1A9FF","#4CCCE6","#1FD8A4","#71D083","#FFA057","#F5E147","#BDE56C","#58D5BA"],A=k=>k[Math.floor(Math.random()*k.length)],R=()=>({style:{color:o==="dark"?"white":"black",backgroundColor:A(o==="dark"?N:q)}});return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"mt-4 w-full grid grid-rows-3 gap-3 mb-2 sm:flex sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"flex justify-center sm:justify-start",children:[e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>r("month"),children:"Mes"}),e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>r("week"),children:"Semana"}),e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>r("day"),children:"Día"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"font-bold",children:Y(t,"dd MMMM yyyy")})}),e.jsxs("div",{className:"flex justify-center sm:justify-end",children:[e.jsx(E,{variant:"outline",size:"icon",className:"mx-1",onClick:()=>u("PREV"),children:e.jsx(Qa,{})}),e.jsx(E,{variant:"outline",className:"mx-1",onClick:()=>u("TODAY"),children:"Hoy"}),e.jsx(E,{variant:"outline",size:"icon",className:"mx-1",onClick:()=>u("NEXT"),children:e.jsx(Ya,{})})]})]}),e.jsx(Rn,{view:a,events:s,localizer:d,style:{height:"100vh",zIndex:40},views:["month","week","day"],min:na(ta(new Date,0),7),max:na(ta(new Date,0),18),toolbar:!1,culture:"es",formats:{eventTimeRangeFormat:({start:k,end:g})=>`${Y(k,"p")} – ${Y(g,"p")}`,eventTimeRangeStartFormat:({start:k})=>`${Y(k,"h:mma")} – `,eventTimeRangeEndFormat:({end:k})=>Y(k,"h:mma"),timeGutterFormat:k=>Y(k,"h:mm a")},components:{day:{event:j},month:{event:p},week:{event:f}},date:t,selectable:!1,eventPropGetter:R,onSelectSlot:k=>k.start&&m(k.start),onNavigate:(k,g)=>{i("date",k),n(k),r(g)},onView:k=>r(k)})]})}const Xt=ce("/assistant/_assistant/dates")({component:lx,async validateSearch({id:s}){return s}});function lx(){const{id:s}=Xt.useSearch(),{data:a=[],isLoading:r,isError:t}=T({queryKey:["listDates"],queryFn:async()=>{const o=await(await D.dates.$get()).json();if(!o.success)throw new Error("Error al cargar la lista de citas");return o.data.map(d=>({...d,start:new Date(d.start),end:new Date(d.end)}))}}),{data:n}=T({queryKey:["patientSearch",s],queryFn:async()=>{if(!s)return null;const o=await(await D.patients.id.$get({query:{id:s}})).json();return o.success?o.data:null},enabled:!!s}),i=J({resolver:W(Yt),defaultValues:{start:"08:00:00",end:"09:00:00",date:new Date}});return e.jsx(Wa,{...i,children:e.jsx("section",{className:"flex mx-2 max-h-screen",children:e.jsxs("div",{className:"w-full h-full mx-2",children:[e.jsxs("div",{className:"w-full   justify-center",children:[e.jsx("p",{className:"text-lg text-center font-medium",children:"Agendar una cita"}),e.jsx(Qt,{patient:n||null})]}),e.jsx("div",{className:"mb-20",children:r?e.jsx("p",{children:"Loading..."}):t?e.jsx("p",{children:"Error al cargar los eventos"}):e.jsx(ix,{Events:a})}),e.jsx("div",{className:"mb-20"})]})})})}function ox(){const[s,a]=x.useState(!1),r=O(),t=J({resolver:W(ws),defaultValues:{email:"",password:"",name:"",rol:"DOCTOR"}}),n=$({mutationFn:async l=>{const c=await(await D.users.register.$post({json:l})).json();if(!c.success)throw new Error(c.error);return c},onSuccess:()=>{P.success("Usuario agregado correctamente"),r.invalidateQueries({queryKey:["userList"]}),a(!1)},onError:l=>{P.error(`Error: ${l.message}`),r.invalidateQueries({queryKey:["userList"]}),a(!1)}}),i=l=>{n.mutate(l)};return e.jsxs(Z,{open:s,onOpenChange:a,children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsxs(E,{variant:"outline",children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Agregar usuario"]})})}),e.jsx(V,{children:"Agregar usuario"})]})}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(X,{children:"Agregar Usuario"})}),e.jsx(ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(i),children:[e.jsx("div",{className:"my-2",children:e.jsx(w,{control:t.control,name:"name",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nombre"}),e.jsx(v,{children:e.jsx(I,{...l,disabled:n.isPending,placeholder:"Nombres y Apellidos",type:"text"})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"my-2",children:e.jsx(w,{control:t.control,name:"email",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Email"}),e.jsx(v,{children:e.jsx(I,{...l,disabled:n.isPending,placeholder:"tu@email.com",type:"email"})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"my-2",children:e.jsx(w,{control:t.control,name:"password",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Clave"}),e.jsx(v,{children:e.jsx(I,{...l,disabled:n.isPending,placeholder:"******",type:"password"})}),e.jsx(C,{})]})})}),e.jsx("div",{className:"my-2",children:e.jsx(w,{control:t.control,name:"rol",render:({field:l})=>e.jsxs(b,{children:[e.jsx(y,{children:"Rol"}),e.jsx(v,{children:e.jsxs(Fe,{onValueChange:l.onChange,defaultValue:l.value,disabled:n.isPending,className:"flex gap-5",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"DOCTOR"}),e.jsx(y,{children:"Doctor"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{value:"ASSISTANT"}),e.jsx(y,{children:"Asistente"})]})]})})]})})}),e.jsx(_,{loading:n.isPending,children:"Guardar"})]})})]})]})}const cx=({user:s})=>{const a=O(),r=$({mutationFn:async({id:n,status:i})=>{const o=await(await D.users.change.$patch({json:{id:n,status:i}})).json();if(!o.success)throw new Error(o.error);return o},onSuccess:()=>{a.invalidateQueries({queryKey:["userList"]}),P.success("Estado actualizado correctamente")},onError:n=>{P.error(`Error: ${n.message}`)}}),t=n=>{n.preventDefault(),r.mutate({id:s.id,status:!s.status})};return e.jsxs(Z,{children:[e.jsx(B,{children:e.jsxs(K,{children:[e.jsx(H,{asChild:!0,children:e.jsx(U,{asChild:!0,children:e.jsx(E,{variant:s.status?"destructive":"default",size:"icon",children:s.status?e.jsx(Ll,{}):e.jsx(Vl,{})})})}),e.jsx(V,{children:s.status?"Deshabilitar usuario":"Habilitar usuario"})]})}),e.jsx(Q,{children:e.jsxs("form",{className:"my-5",onSubmit:t,children:[e.jsx(ie,{children:e.jsxs(X,{children:["¿Seguro que ",s.status?"deshabilitarás":"habilitarás"," al usuario ",e.jsx("strong",{children:s.name}),"?"]})}),e.jsx("p",{className:"my-5",children:s.status?"Al deshabilitar al usuario no tendrá acceso a la aplicación":"Al habilitar al usuario tendrá acceso nuevamente a la aplicación"}),e.jsx(oe,{children:e.jsx(_,{loading:r.isPending,children:s.status?"Deshabilitar":"Habilitar"})})]})})]})},dx=[{accessorKey:"name",header:({column:s})=>e.jsxs(E,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nombre",e.jsx(Os,{className:"ml-2 h-4 w-4"})]})},{accessorKey:"email",header:"Email"},{accessorKey:"role",header:"Rol",cell:({row:s})=>{const a=s.original;let r;return a.role==="ADMIN"&&(r="Administrador"),a.role==="DOCTOR"&&(r="Doctor"),a.role==="ASSISTANT"&&(r="Asistente"),e.jsx("p",{children:r})}},{id:"actions",cell:({row:s})=>{const a=s.original;return e.jsx(cx,{user:a})}}],ux=ce("/admin/_admin/users")({component:mx});function mx(){const[s,a]=x.useState({pageIndex:0,pageSize:10}),{isPending:r,error:t,data:n}=T({queryKey:["userList",s.pageIndex,s.pageSize],placeholderData:qs,queryFn:async()=>(await(await D.users.$get({query:{page:s.pageIndex+1,pageSize:s.pageSize}})).json()).data});return e.jsx("section",{className:"mb-20",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("div",{className:"w-1/2",children:e.jsx(de,{className:"mb-6 text-3xl font-bold",children:"Usuarios"})}),e.jsx("div",{className:"w-1/2 flex justify-end",children:e.jsx(ox,{})})]}),e.jsxs("div",{className:"my-4",children:[r&&e.jsx("div",{children:"Loading..."}),t&&e.jsxs("div",{children:["Error: ",t.message]}),n&&e.jsx(Ts,{columns:dx,data:n.data,pageCount:n.pagination.totalPages,onPaginationChange:i=>{a(i)}})]})]})})}function xx(){const s={maxFiles:1,multiple:!1},a=["application/gzip"],[r,t]=x.useState(null),n=$({mutationFn:async()=>{const l=new FormData;if(!r)return;if(!r.every(u=>a.includes(u.type))){P.error("Tipo de archivo no admitido");return}l.append("file",r[0]);const d=await(await fetch("/api/data/restore",{method:"POST",body:l})).json();console.log(d),d.success?(P.success("Archivos subidos con éxito"),t(null)):P.error(d.error)}}),i=()=>{n.mutate()};return e.jsxs(Z,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(_,{variant:"secondary",className:"w-full",children:[e.jsx(Kl,{className:"mr-2"}),"Restaurar Base de Datos"]})}),e.jsxs(Q,{children:[e.jsxs(ie,{children:[e.jsx(X,{className:"text-2xl font-bold",children:"Restaurar Base de Datos"}),e.jsx(Ce,{children:"Utiliza la ultima copia de seguridad de la base de datos. utiliza el archivo con extencion .dump.gz"})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-lg font-semibold mb-2",children:"Adjuntar archivos"}),e.jsxs(Ds,{value:r,onValueChange:t,dropzoneOptions:s,className:"w-full my-2",children:[e.jsx(Rs,{className:"h-[200px] w-full rounded-lg border-2 border-dashed border-muted-foreground/25 hover:border-muted-foreground/50 transition-colors",children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center space-y-2 text-center",children:[e.jsx(ue.div,{className:" p-4",animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:e.jsx(Ia,{className:"h-8 w-8 text-customborder"})}),e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-primary",children:"Haz clic para subir"})," o arrastra y suelta"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:".gzip"})]})}),e.jsx(Ue,{children:r&&r.length>0&&e.jsx(ue.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4",children:e.jsx(Is,{children:r.map((l,o)=>e.jsx(ue.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{delay:o*.1},children:e.jsx(Fs,{index:o,className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ia,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l.name})]})})},o))})})})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(_,{disabled:!r,loading:n.isPending,onClick:i,children:"Restaurar esta copia de la base de datos"})})]})]})]})}const hx=ce("/admin/_admin/settings")({component:jx});function jx(){const s=O(),{data:a}=T({queryKey:["sessionServiceAdmin"],queryFn:async()=>(await(await D.auth.whatsapp.$get()).json()).data,staleTime:1e3*60*20}),{data:r,isLoading:t}=T({queryKey:["quantitySessions",a],queryFn:async()=>a?(await(await fetch(Ns+"sessions",{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).json()).sessions:null,enabled:!!a});$({mutationFn:async()=>{if(!a)return console.log("No token"),null;if(!r)return P.error("No hay sesiones activas"),null;const o=await(await fetch(Ns+"delete",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).json();console.log(o),o.success?(s.invalidateQueries({queryKey:["quantitySessions"]}),P.success("Eliminadas correctamente")):P.error("Error al borrar las sesiones")}});const n=$({mutationFn:async()=>{(await(await D.data.backup.$post()).json()).success?P.success("Respaldada correctamente"):P.error("Error al respaldar la base de datos")}}),i=()=>{n.mutate()};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-8",children:"Panel de Mantenimiento"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:e.jsxs(ge,{children:[e.jsx(ve,{children:e.jsxs(we,{className:"flex items-center justify-center",children:[e.jsx(Ia,{className:"mr-2"}),"Base de Datos"]})}),e.jsxs(be,{className:"flex flex-col items-center space-y-4",children:[e.jsxs(_,{onClick:i,loading:n.isPending,className:"w-full",children:[e.jsx(Hs,{className:"mr-2"}),"Respaldar Base de Datos"]}),e.jsx(xx,{})]})]})})]})}const px=ce("/profile")(),fx=ce("/doctor")(),gx=ce("/assistant")(),yx=ce("/admin")(),ei=px.update({path:"/profile",getParentRoute:()=>Le}),si=fx.update({path:"/doctor",getParentRoute:()=>Le}),ai=gx.update({path:"/assistant",getParentRoute:()=>Le}),ri=yx.update({path:"/admin",getParentRoute:()=>Le}),bx=Tn.update({path:"/verify",getParentRoute:()=>Le}),vx=uo.update({path:"/restricted",getParentRoute:()=>Le}),Nx=Gn.update({path:"/reset",getParentRoute:()=>Le}),wx=So.update({path:"/login",getParentRoute:()=>Le}),Cx=Ao.update({path:"/forgot",getParentRoute:()=>Le}),Sx=qo.update({path:"/",getParentRoute:()=>Le}),ni=Io.update({id:"/_profile",getParentRoute:()=>ei}),Qe=To.update({id:"/_doctor",getParentRoute:()=>si}),$s=zo.update({id:"/_assistant",getParentRoute:()=>ai}),gr=Oo.update({id:"/_admin",getParentRoute:()=>ri}),Px=jc.update({path:"/me",getParentRoute:()=>ni}),Ax=Ta.update({path:"/view",getParentRoute:()=>Qe}),Ex=ad.update({path:"/upcoming",getParentRoute:()=>Qe}),qx=Hd.update({path:"/services",getParentRoute:()=>Qe}),kx=_a.update({path:"/queries",getParentRoute:()=>Qe}),Dx=_t.update({path:"/pediatric",getParentRoute:()=>Qe}),Ix=gm.update({path:"/patients",getParentRoute:()=>Qe}),Fx=La.update({path:"/general",getParentRoute:()=>Qe}),Rx=Mm.update({path:"/expenses",getParentRoute:()=>Qe}),Mx=Vm.update({path:"/drugs",getParentRoute:()=>Qe}),Tx=Wt.update({path:"/dates",getParentRoute:()=>Qe}),$x=Qm.update({path:"/services",getParentRoute:()=>$s}),zx=Va.update({path:"/queries",getParentRoute:()=>$s}),Ox=Zt.update({path:"/patients",getParentRoute:()=>$s}),_x=Ka.update({path:"/file",getParentRoute:()=>$s}),Lx=Xt.update({path:"/dates",getParentRoute:()=>$s}),Vx=ux.update({path:"/users",getParentRoute:()=>gr}),Kx=hx.update({path:"/settings",getParentRoute:()=>gr}),Hx=Le.addChildren({IndexRoute:Sx,ForgotRoute:Cx,LoginRoute:wx,ResetRoute:Nx,RestrictedRoute:vx,VerifyRoute:bx,AdminRoute:ri.addChildren({AdminAdminRoute:gr.addChildren({AdminAdminSettingsRoute:Kx,AdminAdminUsersRoute:Vx})}),AssistantRoute:ai.addChildren({AssistantAssistantRoute:$s.addChildren({AssistantAssistantDatesRoute:Lx,AssistantAssistantFileRoute:_x,AssistantAssistantPatientsRoute:Ox,AssistantAssistantQueriesRoute:zx,AssistantAssistantServicesRoute:$x})}),DoctorRoute:si.addChildren({DoctorDoctorRoute:Qe.addChildren({DoctorDoctorDatesRoute:Tx,DoctorDoctorDrugsRoute:Mx,DoctorDoctorExpensesRoute:Rx,DoctorDoctorGeneralRoute:Fx,DoctorDoctorPatientsRoute:Ix,DoctorDoctorPediatricRoute:Dx,DoctorDoctorQueriesRoute:kx,DoctorDoctorServicesRoute:qx,DoctorDoctorUpcomingRoute:Ex,DoctorDoctorViewRoute:Ax})}),ProfileRoute:ei.addChildren({ProfileProfileRoute:ni.addChildren({ProfileProfileMeRoute:Px})})});function Gx(){return _e(),e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen  px-4",children:[e.jsx("img",{alt:"Page Not Found",className:"mb-8 w-64 h-64 object-contain",src:"/acces.svg",width:"256",height:"256"}),e.jsxs("div",{className:"flex flex-col items-center space-y-4 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tighter sm:text-4xl ",children:"Oops! Página no encontrada"}),e.jsx("p",{className:"max-w-[600px] text-lg ",children:"Lo sentimos, página no encontrada."})]})]})}const ti=new xi,Bx=new hi({getParentRoute:()=>Le,component:Gx}),Ux=ji({routeTree:Hx,notFoundRoute:Bx}),Qx={queryClient:ti};ii.createRoot(document.getElementById("root")).render(e.jsx(cs.StrictMode,{children:e.jsx(pi,{client:ti,children:e.jsxs(ao,{children:[e.jsx(fi,{router:Ux,context:Qx}),e.jsx(tl,{position:"top-right",richColors:!0})]})})}));
